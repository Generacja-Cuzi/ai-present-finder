<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="6238px" preserveAspectRatio="none" style="width:3222px;height:6238px;background:#FFFFFF;" version="1.1" viewBox="0 0 3222 6238" width="3222px" zoomAndPan="magnify"><title>AI Present Finder - Main Flow (Complete with Commands &amp; Events)</title><defs/><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="487.1904" x="1363.4067" y="28.5352">AI Present Finder - Main Flow (Complete with Commands &amp; Events)</text><rect fill="#ADD8E6" height="6189.0508" style="stroke:#181818;stroke-width:0.5;" width="256.3877" x="1830.3784" y="43.4883"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="131.9551" x="1892.5947" y="56.0566">Fetch Microservices</text><g><title>REST API</title><rect fill="#FFFFFF" height="111.5869" style="stroke:#181818;stroke-width:1;" width="10" x="574.5254" y="193.5977"/></g><g><title>REST API</title><rect fill="#FFFFFF" height="190.8633" style="stroke:#181818;stroke-width:1;" width="10" x="574.5254" y="419.082"/></g><g><title>REST API</title><rect fill="#FFFFFF" height="155.208" style="stroke:#181818;stroke-width:1;" width="10" x="574.5254" y="725.1875"/></g><g><title>REST API</title><rect fill="#FFFFFF" height="5168.7578" style="stroke:#181818;stroke-width:1;" width="10" x="574.5254" y="975.293"/></g><g><title>REST API</title><rect fill="#FFFFFF" height="5009.25" style="stroke:#181818;stroke-width:1;" width="10" x="579.5254" y="1134.8008"/></g><g><title>REST API</title><rect fill="#FFFFFF" height="4842.7422" style="stroke:#181818;stroke-width:1;" width="10" x="584.5254" y="1301.3086"/></g><g><title>REST API</title><rect fill="#FFFFFF" height="155.208" style="stroke:#181818;stroke-width:1;" width="10" x="589.5254" y="2669.5254"/></g><g><title>REST API</title><rect fill="#FFFFFF" height="158.208" style="stroke:#181818;stroke-width:1;" width="10" x="589.5254" y="5959.8428"/></g><g><title>Google OAuth</title><rect fill="#FFFFFF" height="29.3105" style="stroke:#181818;stroke-width:1;" width="10" x="874.1812" y="345.1504"/></g><g><title>Google OAuth</title><rect fill="#FFFFFF" height="29.3105" style="stroke:#181818;stroke-width:1;" width="10" x="874.1812" y="490.7031"/></g><g><title>Chat Service</title><rect fill="#FFFFFF" height="1486.1035" style="stroke:#181818;stroke-width:1;" width="10" x="987.4688" y="1566.1035"/></g><g><title>Stalking Service</title><rect fill="#FFFFFF" height="1670.2773" style="stroke:#181818;stroke-width:1;" width="10" x="1242.5449" y="1461.8613"/></g><g><title>Gift Ideas Service</title><rect fill="#FFFFFF" height="1412.9922" style="stroke:#181818;stroke-width:1;" width="10" x="1479.9937" y="2374.7988"/></g><g><title>Gift Ideas Service</title><rect fill="#FFFFFF" height="463.4443" style="stroke:#181818;stroke-width:1;" width="10" x="1479.9937" y="4909.3779"/></g><g><title>OLX</title><rect fill="#FFFFFF" height="952.957" style="stroke:#181818;stroke-width:1;" width="10" x="1849.9307" y="3447.5547"/></g><g><title>OLX</title><rect fill="#FFFFFF" height="726.1621" style="stroke:#181818;stroke-width:1;" width="10" x="1849.9307" y="5090.207"/></g><g><title>Allegro</title><rect fill="#FFFFFF" height="804.4941" style="stroke:#181818;stroke-width:1;" width="10" x="1911.7881" y="3596.0176"/></g><g><title>Allegro</title><rect fill="#FFFFFF" height="577.6992" style="stroke:#181818;stroke-width:1;" width="10" x="1911.7881" y="5238.6699"/></g><g><title>eBay</title><rect fill="#FFFFFF" height="744.918" style="stroke:#181818;stroke-width:1;" width="10" x="1975.5425" y="3655.5938"/></g><g><title>eBay</title><rect fill="#FFFFFF" height="518.123" style="stroke:#181818;stroke-width:1;" width="10" x="1975.5425" y="5298.2461"/></g><g><title>Amazon</title><rect fill="#FFFFFF" height="685.3418" style="stroke:#181818;stroke-width:1;" width="10" x="2042.8789" y="3715.1699"/></g><g><title>Amazon</title><rect fill="#FFFFFF" height="458.5469" style="stroke:#181818;stroke-width:1;" width="10" x="2042.8789" y="5357.8223"/></g><g><title>Reranking Service</title><rect fill="#FFFFFF" height="1514.4443" style="stroke:#181818;stroke-width:1;" width="10" x="2513.9595" y="3394.9336"/></g><g><title>Reranking Service</title><rect fill="#FFFFFF" height="165.8633" style="stroke:#181818;stroke-width:1;" width="10" x="2518.9595" y="3906.9883"/></g><g><title>Reranking Service</title><rect fill="#FFFFFF" height="35.3105" style="stroke:#181818;stroke-width:1;" width="10" x="2518.9595" y="4139.4277"/></g><g><title>Reranking Service</title><rect fill="#FFFFFF" height="35.3105" style="stroke:#181818;stroke-width:1;" width="10" x="2518.9595" y="4241.3145"/></g><g><title>Reranking Service</title><rect fill="#FFFFFF" height="35.3105" style="stroke:#181818;stroke-width:1;" width="10" x="2518.9595" y="4343.2012"/></g><g><title>Reranking Service</title><rect fill="#FFFFFF" height="65.9316" style="stroke:#181818;stroke-width:1;" width="10" x="2513.9595" y="5022.2754"/></g><g><title>Reranking Service</title><rect fill="#FFFFFF" height="35.3105" style="stroke:#181818;stroke-width:1;" width="10" x="2513.9595" y="5499.3301"/></g><g><title>Reranking Service</title><rect fill="#FFFFFF" height="35.3105" style="stroke:#181818;stroke-width:1;" width="10" x="2513.9595" y="5585.9063"/></g><g><title>Reranking Service</title><rect fill="#FFFFFF" height="35.3105" style="stroke:#181818;stroke-width:1;" width="10" x="2513.9595" y="5672.4824"/></g><g><title>Reranking Service</title><rect fill="#FFFFFF" height="35.3105" style="stroke:#181818;stroke-width:1;" width="10" x="2513.9595" y="5759.0586"/></g><rect fill="none" height="722.6738" style="stroke:#000000;stroke-width:1.5;" width="1142.4082" x="106" y="671.2559"/><rect fill="none" height="321.3711" style="stroke:#000000;stroke-width:1.5;" width="963.4082" x="275" y="906.0508"/><rect fill="none" height="223.7949" style="stroke:#000000;stroke-width:1.5;" width="925.7388" x="533.1787" y="1407.9297"/><rect fill="none" height="509.5898" style="stroke:#000000;stroke-width:1.5;" width="969.4663" x="275" y="1754.9668"/><rect fill="none" height="766.6504" style="stroke:#000000;stroke-width:1.5;" width="1731.6753" x="103" y="2278.5566"/><rect fill="none" height="243.1055" style="stroke:#000000;stroke-width:1.5;" width="758.0381" x="113" y="2600.2832"/><rect fill="none" height="497.4102" style="stroke:#000000;stroke-width:1.5;" width="1667.2334" x="1399.8677" y="3283.3809"/><rect fill="none" height="306.2363" style="stroke:#000000;stroke-width:1.5;" width="828.1465" x="1409.8677" y="3467.5547"/><rect fill="none" height="555.4102" style="stroke:#000000;stroke-width:1.5;" width="1085.7217" x="1824.3784" y="3838.1016"/><rect fill="none" height="1647.2969" style="stroke:#000000;stroke-width:1.5;" width="3196.0039" x="9" y="4488.7539"/><rect fill="none" height="1284.2598" style="stroke:#000000;stroke-width:1.5;" width="3086.7202" x="19" y="4844.791"/><rect fill="none" height="255.6152" style="stroke:#000000;stroke-width:1.5;" width="682.8984" x="1409.8677" y="5110.207"/><rect fill="none" height="363.6152" style="stroke:#000000;stroke-width:1.5;" width="1075.7217" x="1824.3784" y="5445.7539"/><g><title>User</title><rect fill="#000000" fill-opacity="0.00000" height="6034.0742" width="8" x="299.1826" y="118.9766"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="303" x2="303" y1="118.9766" y2="6153.0508"/></g><g><title>REST API</title><rect fill="#000000" fill-opacity="0.00000" height="6034.0742" width="8" x="575.5254" y="118.9766"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="579.1787" x2="579.1787" y1="118.9766" y2="6153.0508"/></g><g><title>Google OAuth</title><rect fill="#000000" fill-opacity="0.00000" height="6034.0742" width="8" x="875.1812" y="118.9766"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="878.4458" x2="878.4458" y1="118.9766" y2="6153.0508"/></g><g><title>Chat Service</title><rect fill="#000000" fill-opacity="0.00000" height="6034.0742" width="8" x="988.4688" y="118.9766"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="991.9165" x2="991.9165" y1="118.9766" y2="6153.0508"/></g><g><title>Stalking Service</title><rect fill="#000000" fill-opacity="0.00000" height="6034.0742" width="8" x="1243.5449" y="118.9766"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="1246.563" x2="1246.563" y1="118.9766" y2="6153.0508"/></g><g><title>Gift Ideas Service</title><rect fill="#000000" fill-opacity="0.00000" height="6034.0742" width="8" x="1480.9937" y="118.9766"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="1484.8677" x2="1484.8677" y1="118.9766" y2="6153.0508"/></g><g><title>OLX</title><rect fill="#000000" fill-opacity="0.00000" height="6034.0742" width="8" x="1850.9307" y="118.9766"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="1854.3784" x2="1854.3784" y1="118.9766" y2="6153.0508"/></g><g><title>Allegro</title><rect fill="#000000" fill-opacity="0.00000" height="6034.0742" width="8" x="1912.7881" y="118.9766"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="1916.4829" x2="1916.4829" y1="118.9766" y2="6153.0508"/></g><g><title>eBay</title><rect fill="#000000" fill-opacity="0.00000" height="6034.0742" width="8" x="1976.5425" y="118.9766"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="1980.0933" x2="1980.0933" y1="118.9766" y2="6153.0508"/></g><g><title>Amazon</title><rect fill="#000000" fill-opacity="0.00000" height="6034.0742" width="8" x="2043.8789" y="118.9766"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="2046.9917" x2="2046.9917" y1="118.9766" y2="6153.0508"/></g><g><title>Reranking Service</title><rect fill="#000000" fill-opacity="0.00000" height="6034.0742" width="8" x="2514.9595" y="118.9766"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="2518.8545" x2="2518.8545" y1="118.9766" y2="6153.0508"/></g><g class="participant participant-head" data-participant="U"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="30.3652" x="285" y="116.0234">User</text><ellipse cx="303.1826" cy="50.9883" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M303.1826,58.9883 L303.1826,85.9883 M290.1826,66.9883 L316.1826,66.9883 M303.1826,85.9883 L290.1826,100.9883 M303.1826,85.9883 L316.1826,100.9883" fill="none" style="stroke:#181818;stroke-width:0.5;"/></g><g class="participant participant-tail" data-participant="U"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="30.3652" x="285" y="6165.5859">User</text><ellipse cx="303.1826" cy="6177.0391" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M303.1826,6185.0391 L303.1826,6212.0391 M290.1826,6193.0391 L316.1826,6193.0391 M303.1826,6212.0391 L290.1826,6227.0391 M303.1826,6212.0391 L316.1826,6227.0391" fill="none" style="stroke:#181818;stroke-width:0.5;"/></g><g class="participant participant-head" data-participant="REST"><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="72.6934" x="543.1787" y="87.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="58.6934" x="550.1787" y="108.0234">REST API</text></g><g class="participant participant-tail" data-participant="REST"><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="72.6934" x="543.1787" y="6152.0508"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="58.6934" x="550.1787" y="6172.5859">REST API</text></g><g class="participant participant-head" data-participant="GOOGLE"><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="109.4707" x="824.4458" y="87.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="95.4707" x="831.4458" y="108.0234">Google OAuth</text></g><g class="participant participant-tail" data-participant="GOOGLE"><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="109.4707" x="824.4458" y="6152.0508"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="95.4707" x="831.4458" y="6172.5859">Google OAuth</text></g><g class="participant participant-head" data-participant="CHAT"><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="97.1045" x="943.9165" y="87.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="83.1045" x="950.9165" y="108.0234">Chat Service</text></g><g class="participant participant-tail" data-participant="CHAT"><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="97.1045" x="943.9165" y="6152.0508"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="83.1045" x="950.9165" y="6172.5859">Chat Service</text></g><g class="participant participant-head" data-participant="STALK"><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="119.9639" x="1187.563" y="87.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="105.9639" x="1194.563" y="108.0234">Stalking Service</text></g><g class="participant participant-tail" data-participant="STALK"><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="119.9639" x="1187.563" y="6152.0508"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="105.9639" x="1194.563" y="6172.5859">Stalking Service</text></g><g class="participant participant-head" data-participant="GIFT"><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="130.252" x="1419.8677" y="87.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="116.252" x="1426.8677" y="108.0234">Gift Ideas Service</text></g><g class="participant participant-tail" data-participant="GIFT"><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="130.252" x="1419.8677" y="6152.0508"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="116.252" x="1426.8677" y="6172.5859">Gift Ideas Service</text></g><g class="participant participant-head" data-participant="FETCH_OLX"><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="41.1045" x="1834.3784" y="87.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="27.1045" x="1841.3784" y="108.0234">OLX</text></g><g class="participant participant-tail" data-participant="FETCH_OLX"><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="41.1045" x="1834.3784" y="6152.0508"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="27.1045" x="1841.3784" y="6172.5859">OLX</text></g><g class="participant participant-head" data-participant="FETCH_ALLEGRO"><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="62.6104" x="1885.4829" y="87.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="48.6104" x="1892.4829" y="108.0234">Allegro</text></g><g class="participant participant-tail" data-participant="FETCH_ALLEGRO"><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="62.6104" x="1885.4829" y="6152.0508"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="48.6104" x="1892.4829" y="6172.5859">Allegro</text></g><g class="participant participant-head" data-participant="FETCH_EBAY"><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="44.8984" x="1958.0933" y="87.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="30.8984" x="1965.0933" y="108.0234">eBay</text></g><g class="participant participant-tail" data-participant="FETCH_EBAY"><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="44.8984" x="1958.0933" y="6152.0508"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="30.8984" x="1965.0933" y="6172.5859">eBay</text></g><g class="participant participant-head" data-participant="FETCH_AMAZON"><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="69.7744" x="2012.9917" y="87.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="55.7744" x="2019.9917" y="108.0234">Amazon</text></g><g class="participant participant-tail" data-participant="FETCH_AMAZON"><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="69.7744" x="2012.9917" y="6152.0508"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="55.7744" x="2019.9917" y="6172.5859">Amazon</text></g><g class="participant participant-head" data-participant="RERANK"><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="134.21" x="2451.8545" y="87.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="120.21" x="2458.8545" y="108.0234">Reranking Service</text></g><g class="participant participant-tail" data-participant="RERANK"><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="134.21" x="2451.8545" y="6152.0508"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="120.21" x="2458.8545" y="6172.5859">Reranking Service</text></g><g><title>REST API</title><rect fill="#FFFFFF" height="111.5869" style="stroke:#181818;stroke-width:1;" width="10" x="574.5254" y="193.5977"/></g><g><title>REST API</title><rect fill="#FFFFFF" height="190.8633" style="stroke:#181818;stroke-width:1;" width="10" x="574.5254" y="419.082"/></g><g><title>REST API</title><rect fill="#FFFFFF" height="155.208" style="stroke:#181818;stroke-width:1;" width="10" x="574.5254" y="725.1875"/></g><g><title>REST API</title><rect fill="#FFFFFF" height="5168.7578" style="stroke:#181818;stroke-width:1;" width="10" x="574.5254" y="975.293"/></g><g><title>REST API</title><rect fill="#FFFFFF" height="5009.25" style="stroke:#181818;stroke-width:1;" width="10" x="579.5254" y="1134.8008"/></g><g><title>REST API</title><rect fill="#FFFFFF" height="4842.7422" style="stroke:#181818;stroke-width:1;" width="10" x="584.5254" y="1301.3086"/></g><g><title>REST API</title><rect fill="#FFFFFF" height="155.208" style="stroke:#181818;stroke-width:1;" width="10" x="589.5254" y="2669.5254"/></g><g><title>REST API</title><rect fill="#FFFFFF" height="158.208" style="stroke:#181818;stroke-width:1;" width="10" x="589.5254" y="5959.8428"/></g><g><title>Google OAuth</title><rect fill="#FFFFFF" height="29.3105" style="stroke:#181818;stroke-width:1;" width="10" x="874.1812" y="345.1504"/></g><g><title>Google OAuth</title><rect fill="#FFFFFF" height="29.3105" style="stroke:#181818;stroke-width:1;" width="10" x="874.1812" y="490.7031"/></g><g><title>Chat Service</title><rect fill="#FFFFFF" height="1486.1035" style="stroke:#181818;stroke-width:1;" width="10" x="987.4688" y="1566.1035"/></g><g><title>Stalking Service</title><rect fill="#FFFFFF" height="1670.2773" style="stroke:#181818;stroke-width:1;" width="10" x="1242.5449" y="1461.8613"/></g><g><title>Gift Ideas Service</title><rect fill="#FFFFFF" height="1412.9922" style="stroke:#181818;stroke-width:1;" width="10" x="1479.9937" y="2374.7988"/></g><g><title>Gift Ideas Service</title><rect fill="#FFFFFF" height="463.4443" style="stroke:#181818;stroke-width:1;" width="10" x="1479.9937" y="4909.3779"/></g><g><title>OLX</title><rect fill="#FFFFFF" height="952.957" style="stroke:#181818;stroke-width:1;" width="10" x="1849.9307" y="3447.5547"/></g><g><title>OLX</title><rect fill="#FFFFFF" height="726.1621" style="stroke:#181818;stroke-width:1;" width="10" x="1849.9307" y="5090.207"/></g><g><title>Allegro</title><rect fill="#FFFFFF" height="804.4941" style="stroke:#181818;stroke-width:1;" width="10" x="1911.7881" y="3596.0176"/></g><g><title>Allegro</title><rect fill="#FFFFFF" height="577.6992" style="stroke:#181818;stroke-width:1;" width="10" x="1911.7881" y="5238.6699"/></g><g><title>eBay</title><rect fill="#FFFFFF" height="744.918" style="stroke:#181818;stroke-width:1;" width="10" x="1975.5425" y="3655.5938"/></g><g><title>eBay</title><rect fill="#FFFFFF" height="518.123" style="stroke:#181818;stroke-width:1;" width="10" x="1975.5425" y="5298.2461"/></g><g><title>Amazon</title><rect fill="#FFFFFF" height="685.3418" style="stroke:#181818;stroke-width:1;" width="10" x="2042.8789" y="3715.1699"/></g><g><title>Amazon</title><rect fill="#FFFFFF" height="458.5469" style="stroke:#181818;stroke-width:1;" width="10" x="2042.8789" y="5357.8223"/></g><g><title>Reranking Service</title><rect fill="#FFFFFF" height="1514.4443" style="stroke:#181818;stroke-width:1;" width="10" x="2513.9595" y="3394.9336"/></g><g><title>Reranking Service</title><rect fill="#FFFFFF" height="165.8633" style="stroke:#181818;stroke-width:1;" width="10" x="2518.9595" y="3906.9883"/></g><g><title>Reranking Service</title><rect fill="#FFFFFF" height="35.3105" style="stroke:#181818;stroke-width:1;" width="10" x="2518.9595" y="4139.4277"/></g><g><title>Reranking Service</title><rect fill="#FFFFFF" height="35.3105" style="stroke:#181818;stroke-width:1;" width="10" x="2518.9595" y="4241.3145"/></g><g><title>Reranking Service</title><rect fill="#FFFFFF" height="35.3105" style="stroke:#181818;stroke-width:1;" width="10" x="2518.9595" y="4343.2012"/></g><g><title>Reranking Service</title><rect fill="#FFFFFF" height="65.9316" style="stroke:#181818;stroke-width:1;" width="10" x="2513.9595" y="5022.2754"/></g><g><title>Reranking Service</title><rect fill="#FFFFFF" height="35.3105" style="stroke:#181818;stroke-width:1;" width="10" x="2513.9595" y="5499.3301"/></g><g><title>Reranking Service</title><rect fill="#FFFFFF" height="35.3105" style="stroke:#181818;stroke-width:1;" width="10" x="2513.9595" y="5585.9063"/></g><g><title>Reranking Service</title><rect fill="#FFFFFF" height="35.3105" style="stroke:#181818;stroke-width:1;" width="10" x="2513.9595" y="5672.4824"/></g><g><title>Reranking Service</title><rect fill="#FFFFFF" height="35.3105" style="stroke:#181818;stroke-width:1;" width="10" x="2513.9595" y="5759.0586"/></g><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="3215.0039" x="0" y="149.6318"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="3215.0039" y1="149.6318" y2="149.6318"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="3215.0039" y1="152.6318" y2="152.6318"/><rect fill="#EEEEEE" height="23.3105" style="stroke:#000000;stroke-width:2;" width="187.3989" x="1513.8025" y="138.9766"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="169.1143" x="1519.8025" y="155.5449">Autoryzacja u&#380;ytkownika</text><g class="message" data-participant-1="U" data-participant-2="REST"><polygon fill="#181818" points="562.5254,189.5977,572.5254,193.5977,562.5254,197.5977,566.5254,193.5977" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="303.1826" x2="568.5254" y1="193.5977" y2="193.5977"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="137.7314" x="310.1826" y="188.8555">GET /auth/google/url</text></g><g class="message" data-participant-1="REST" data-participant-2="REST"><line style="stroke:#181818;stroke-width:1;" x1="584.5254" x2="626.5254" y1="222.9082" y2="222.9082"/><line style="stroke:#181818;stroke-width:1;" x1="626.5254" x2="626.5254" y1="222.9082" y2="235.9082"/><line style="stroke:#181818;stroke-width:1;" x1="585.5254" x2="626.5254" y1="235.9082" y2="235.9082"/><polygon fill="#181818" points="595.5254,231.9082,585.5254,235.9082,595.5254,239.9082,591.5254,235.9082" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="209.3013" x="591.5254" y="218.166">GenerateGoogleOAuthUrlQuery</text></g><g class="message" data-participant-1="REST" data-participant-2="GOOGLE"><polygon fill="#181818" points="867.1812,261.2188,877.1812,265.2188,867.1812,269.2188,871.1812,265.2188" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="584.5254" x2="873.1812" y1="265.2188" y2="265.2188"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="93.9517" x="591.5254" y="260.4766">Get OAuth URL</text></g><g class="message" data-participant-1="REST" data-participant-2="U"><polygon fill="#181818" points="314.1826,301.1846,304.1826,305.1846,314.1826,309.1846,310.1826,305.1846" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="308.1826" x2="578.5254" y1="305.1846" y2="305.1846"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="247.3428" x="320.1826" y="300.4424">{url: "https://accounts.google.com/..."}</text></g><path d="M110,278.2188 L110,318.2188 L297,318.2188 L297,288.2188 L287,278.2188 L110,278.2188" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M287,278.2188 L287,288.2188 L297,288.2188 L287,278.2188" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="166.6323" x="116" y="295.7871">U&#380;ytkownik przekierowuje</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="108.9321" x="116" y="311.0977">do Google OAuth</text><g class="message" data-participant-1="U" data-participant-2="GOOGLE"><polygon fill="#181818" points="862.1812,341.1504,872.1812,345.1504,862.1812,349.1504,866.1812,345.1504" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="303.1826" x2="868.1812" y1="345.1504" y2="345.1504"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="137.1348" x="310.1826" y="340.4082">Autoryzacja w Google</text></g><g class="message" data-participant-1="GOOGLE" data-participant-2="U"><polygon fill="#181818" points="314.1826,370.4609,304.1826,374.4609,314.1826,378.4609,310.1826,374.4609" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="308.1826" x2="878.1812" y1="374.4609" y2="374.4609"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="213.6621" x="320.1826" y="369.7188">Redirect z kodem autoryzacyjnym</text></g><g class="message" data-participant-1="U" data-participant-2="REST"><polygon fill="#181818" points="562.5254,415.082,572.5254,419.082,562.5254,423.082,566.5254,419.082" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="303.1826" x2="568.5254" y1="419.082" y2="419.082"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="179.4038" x="310.1826" y="399.0293">POST /auth/google/callback</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="38.5239" x="310.1826" y="414.3398">{code}</text></g><g class="message" data-participant-1="REST" data-participant-2="REST"><line style="stroke:#181818;stroke-width:1;" x1="584.5254" x2="626.5254" y1="448.3926" y2="448.3926"/><line style="stroke:#181818;stroke-width:1;" x1="626.5254" x2="626.5254" y1="448.3926" y2="461.3926"/><line style="stroke:#181818;stroke-width:1;" x1="585.5254" x2="626.5254" y1="461.3926" y2="461.3926"/><polygon fill="#181818" points="595.5254,457.3926,585.5254,461.3926,595.5254,465.3926,591.5254,461.3926" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="210.2661" x="591.5254" y="443.6504">ValidateGoogleTokenCommand</text></g><g class="message" data-participant-1="REST" data-participant-2="GOOGLE"><polygon fill="#181818" points="862.1812,486.7031,872.1812,490.7031,862.1812,494.7031,866.1812,490.7031" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="584.5254" x2="868.1812" y1="490.7031" y2="490.7031"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="151.4106" x="591.5254" y="485.9609">Wymiana kodu na token</text></g><g class="message" data-participant-1="GOOGLE" data-participant-2="REST"><polygon fill="#181818" points="595.5254,516.0137,585.5254,520.0137,595.5254,524.0137,591.5254,520.0137" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="589.5254" x2="878.1812" y1="520.0137" y2="520.0137"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="265.6558" x="601.5254" y="515.2715">{accessToken, refreshToken, email, name}</text></g><g class="message" data-participant-1="REST" data-participant-2="REST"><line style="stroke:#181818;stroke-width:1;" x1="584.5254" x2="626.5254" y1="549.3242" y2="549.3242"/><line style="stroke:#181818;stroke-width:1;" x1="626.5254" x2="626.5254" y1="549.3242" y2="562.3242"/><line style="stroke:#181818;stroke-width:1;" x1="585.5254" x2="626.5254" y1="562.3242" y2="562.3242"/><polygon fill="#181818" points="595.5254,558.3242,585.5254,562.3242,595.5254,566.3242,591.5254,562.3242" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123.9189" x="591.5254" y="544.582">Generate JWT token</text></g><g class="message" data-participant-1="REST" data-participant-2="U"><polygon fill="#181818" points="314.1826,605.9453,304.1826,609.9453,314.1826,613.9453,310.1826,609.9453" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="308.1826" x2="578.5254" y1="609.9453" y2="609.9453"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="228.9282" x="320.1826" y="589.8926">Set-Cookie: access_token (httpOnly)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="149.4873" x="320.1826" y="605.2031">{user: {id, email, name}}</text></g><path d="M52,575.3242 L52,615.3242 L297,615.3242 L297,585.3242 L287,575.3242 L52,575.3242" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M287,575.3242 L287,585.3242 L297,585.3242 L287,575.3242" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="201.0112" x="58" y="592.8926">JWT zapisany w httpOnly cookie</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="224.9229" x="58" y="608.2031">Dost&#281;p do chronionych endpoint&#243;w</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="3215.0039" x="0" y="641.6006"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="3215.0039" y1="641.6006" y2="641.6006"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="3215.0039" y1="644.6006" y2="644.6006"/><rect fill="#EEEEEE" height="23.3105" style="stroke:#000000;stroke-width:2;" width="260.6763" x="1477.1638" y="630.9453"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="242.3916" x="1483.1638" y="647.5137">Start sesji (u&#380;ytkownik zalogowany)</text><path d="M106,671.2559 L168.1387,671.2559 L168.1387,678.5664 L158.1387,688.5664 L106,688.5664 L106,671.2559" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="722.6738" style="stroke:#000000;stroke-width:1.5;" width="1142.4082" x="106" y="671.2559"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17.1387" x="121" y="684.8242">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="190.5342" x="183.1387" y="683.8906">[U&#380;ytkownik ma zapisane profile]</text><g class="message" data-participant-1="U" data-participant-2="REST"><polygon fill="#181818" points="562.5254,721.1875,572.5254,725.1875,562.5254,729.1875,566.5254,725.1875" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="303.1826" x2="568.5254" y1="725.1875" y2="725.1875"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="168.0098" x="310.1826" y="705.1348">GET /restapi/user-profiles</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="83.1733" x="310.1826" y="720.4453">+ JWT cookie</text></g><g class="message" data-participant-1="REST" data-participant-2="REST"><line style="stroke:#181818;stroke-width:1;" x1="584.5254" x2="626.5254" y1="754.498" y2="754.498"/><line style="stroke:#181818;stroke-width:1;" x1="626.5254" x2="626.5254" y1="754.498" y2="767.498"/><line style="stroke:#181818;stroke-width:1;" x1="585.5254" x2="626.5254" y1="767.498" y2="767.498"/><polygon fill="#181818" points="595.5254,763.498,585.5254,767.498,595.5254,771.498,591.5254,767.498" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="94.2373" x="591.5254" y="749.7559">JwtAuthGuard</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="129.1621" x="689.876" y="749.7559">- weryfikacja tokena</text></g><g class="message" data-participant-1="REST" data-participant-2="REST"><line style="stroke:#181818;stroke-width:1;" x1="584.5254" x2="626.5254" y1="812.1191" y2="812.1191"/><line style="stroke:#181818;stroke-width:1;" x1="626.5254" x2="626.5254" y1="812.1191" y2="825.1191"/><line style="stroke:#181818;stroke-width:1;" x1="585.5254" x2="626.5254" y1="825.1191" y2="825.1191"/><polygon fill="#181818" points="595.5254,821.1191,585.5254,825.1191,595.5254,829.1191,591.5254,825.1191" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="144.3774" x="591.5254" y="792.0664">GetUserProfilesQuery</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="47.6392" x="591.5254" y="807.377">{userId}</text></g><g class="message" data-participant-1="REST" data-participant-2="U"><polygon fill="#181818" points="314.1826,876.3955,304.1826,880.3955,314.1826,884.3955,310.1826,880.3955" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="308.1826" x2="578.5254" y1="880.3955" y2="880.3955"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="47.3599" x="320.1826" y="860.3428">200 OK</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="85.1284" x="320.1826" y="875.6533">{profiles: [...]}</text></g><path d="M116,838.1191 L116,893.1191 L297,893.1191 L297,848.1191 L287,838.1191 L116,838.1191" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M287,838.1191 L287,848.1191 L297,848.1191 L287,838.1191" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="160.3291" x="122" y="855.6875">U&#380;ytkownik mo&#380;e wybra&#263;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="153.0928" x="122" y="870.998">z listy zapisanych profili</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="160.7798" x="122" y="886.3086">lub nie wybiera&#263; &#380;adnego</text><path d="M275,906.0508 L337.1387,906.0508 L337.1387,913.3613 L327.1387,923.3613 L275,923.3613 L275,906.0508" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="321.3711" style="stroke:#000000;stroke-width:1.5;" width="963.4082" x="275" y="906.0508"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17.1387" x="290" y="919.6191">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="211.605" x="352.1387" y="918.6855">[U&#380;ytkownik wybiera zapisany profil]</text><g class="message" data-participant-1="U" data-participant-2="REST"><polygon fill="#181818" points="562.5254,971.293,572.5254,975.293,562.5254,979.293,566.5254,975.293" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="303.1826" x2="568.5254" y1="975.293" y2="975.293"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="198.4468" x="310.1826" y="939.9297">POST /restapi/stalking-request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="250.5674" x="310.1826" y="955.2402">{chatId, profileId, social URLs, occasion}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="83.1733" x="310.1826" y="970.5508">+ JWT cookie</text></g><g class="message" data-participant-1="REST" data-participant-2="REST"><line style="stroke:#181818;stroke-width:1;" x1="584.5254" x2="626.5254" y1="1004.6035" y2="1004.6035"/><line style="stroke:#181818;stroke-width:1;" x1="626.5254" x2="626.5254" y1="1004.6035" y2="1017.6035"/><line style="stroke:#181818;stroke-width:1;" x1="585.5254" x2="626.5254" y1="1017.6035" y2="1017.6035"/><polygon fill="#181818" points="595.5254,1013.6035,585.5254,1017.6035,595.5254,1021.6035,591.5254,1017.6035" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="94.2373" x="591.5254" y="999.8613">JwtAuthGuard</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="129.1621" x="689.876" y="999.8613">- weryfikacja tokena</text></g><g class="message" data-participant-1="REST" data-participant-2="REST"><line style="stroke:#181818;stroke-width:1;" x1="584.5254" x2="626.5254" y1="1046.9141" y2="1046.9141"/><line style="stroke:#181818;stroke-width:1;" x1="626.5254" x2="626.5254" y1="1046.9141" y2="1059.9141"/><line style="stroke:#181818;stroke-width:1;" x1="585.5254" x2="626.5254" y1="1059.9141" y2="1059.9141"/><polygon fill="#181818" points="595.5254,1055.9141,585.5254,1059.9141,595.5254,1063.9141,591.5254,1059.9141" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="245.2798" x="591.5254" y="1042.1719">StartProcessingWithProfileCommand</text></g><path d="M858.2798,1034.1035 L858.2798,1059.1035 L1217.2798,1059.1035 L1217.2798,1044.1035 L1207.2798,1034.1035 L858.2798,1034.1035" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1207.2798,1034.1035 L1207.2798,1044.1035 L1217.2798,1044.1035 L1207.2798,1034.1035" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="338.603" x="864.2798" y="1051.6719">Profil za&#322;adowany z bazy i uwzgl&#281;dniony w wywiadzie</text><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="275" x2="1238.4082" y1="1068.9141" y2="1068.9141"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="237.7515" x="280" y="1079.5488">[U&#380;ytkownik nie wybiera &#380;adnego profilu]</text><g class="message" data-participant-1="U" data-participant-2="REST"><polygon fill="#181818" points="567.5254,1130.8008,577.5254,1134.8008,567.5254,1138.8008,571.5254,1134.8008" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="303.1826" x2="573.5254" y1="1134.8008" y2="1134.8008"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="198.4468" x="310.1826" y="1099.4375">POST /restapi/stalking-request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="189.3887" x="310.1826" y="1114.748">{chatId, social URLs, occasion}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="83.1733" x="310.1826" y="1130.0586">+ JWT cookie</text></g><g class="message" data-participant-1="REST" data-participant-2="REST"><line style="stroke:#181818;stroke-width:1;" x1="589.5254" x2="631.5254" y1="1164.1113" y2="1164.1113"/><line style="stroke:#181818;stroke-width:1;" x1="631.5254" x2="631.5254" y1="1164.1113" y2="1177.1113"/><line style="stroke:#181818;stroke-width:1;" x1="590.5254" x2="631.5254" y1="1177.1113" y2="1177.1113"/><polygon fill="#181818" points="600.5254,1173.1113,590.5254,1177.1113,600.5254,1181.1113,596.5254,1177.1113" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="94.2373" x="596.5254" y="1159.3691">JwtAuthGuard</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="129.1621" x="694.876" y="1159.3691">- weryfikacja tokena</text></g><g class="message" data-participant-1="REST" data-participant-2="REST"><line style="stroke:#181818;stroke-width:1;" x1="589.5254" x2="631.5254" y1="1206.4219" y2="1206.4219"/><line style="stroke:#181818;stroke-width:1;" x1="631.5254" x2="631.5254" y1="1206.4219" y2="1219.4219"/><line style="stroke:#181818;stroke-width:1;" x1="590.5254" x2="631.5254" y1="1219.4219" y2="1219.4219"/><polygon fill="#181818" points="600.5254,1215.4219,590.5254,1219.4219,600.5254,1223.4219,596.5254,1219.4219" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="171.8501" x="596.5254" y="1201.6797">StartProcessingCommand</text></g><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="106" x2="1248.4082" y1="1235.4219" y2="1235.4219"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="221.5845" x="111" y="1246.0566">[U&#380;ytkownik nie ma zapisanych profili]</text><g class="message" data-participant-1="U" data-participant-2="REST"><polygon fill="#181818" points="572.5254,1297.3086,582.5254,1301.3086,572.5254,1305.3086,576.5254,1301.3086" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="303.1826" x2="578.5254" y1="1301.3086" y2="1301.3086"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="198.4468" x="310.1826" y="1265.9453">POST /restapi/stalking-request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="189.3887" x="310.1826" y="1281.2559">{chatId, social URLs, occasion}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="83.1733" x="310.1826" y="1296.5664">+ JWT cookie</text></g><g class="message" data-participant-1="REST" data-participant-2="REST"><line style="stroke:#181818;stroke-width:1;" x1="594.5254" x2="636.5254" y1="1330.6191" y2="1330.6191"/><line style="stroke:#181818;stroke-width:1;" x1="636.5254" x2="636.5254" y1="1330.6191" y2="1343.6191"/><line style="stroke:#181818;stroke-width:1;" x1="595.5254" x2="636.5254" y1="1343.6191" y2="1343.6191"/><polygon fill="#181818" points="605.5254,1339.6191,595.5254,1343.6191,605.5254,1347.6191,601.5254,1343.6191" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="94.2373" x="601.5254" y="1325.877">JwtAuthGuard</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="129.1621" x="699.876" y="1325.877">- weryfikacja tokena</text></g><g class="message" data-participant-1="REST" data-participant-2="REST"><line style="stroke:#181818;stroke-width:1;" x1="594.5254" x2="636.5254" y1="1372.9297" y2="1372.9297"/><line style="stroke:#181818;stroke-width:1;" x1="636.5254" x2="636.5254" y1="1372.9297" y2="1385.9297"/><line style="stroke:#181818;stroke-width:1;" x1="595.5254" x2="636.5254" y1="1385.9297" y2="1385.9297"/><polygon fill="#181818" points="605.5254,1381.9297,595.5254,1385.9297,605.5254,1389.9297,601.5254,1385.9297" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="171.8501" x="601.5254" y="1368.1875">StartProcessingCommand</text></g><path d="M533.1787,1407.9297 L600.3447,1407.9297 L600.3447,1415.2402 L590.3447,1425.2402 L533.1787,1425.2402 L533.1787,1407.9297" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="223.7949" style="stroke:#000000;stroke-width:1.5;" width="925.7388" x="533.1787" y="1407.9297"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="22.166" x="548.1787" y="1421.498">par</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="158.0874" x="615.3447" y="1420.5645">[Przetwarzanie R&#243;wnoleg&#322;e]</text><g class="message" data-participant-1="REST" data-participant-2="STALK"><polygon fill="#181818" points="1230.5449,1457.8613,1240.5449,1461.8613,1230.5449,1465.8613,1234.5449,1461.8613" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="594.5254" x2="1236.5449" y1="1461.8613" y2="1461.8613"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="214.1382" x="601.5254" y="1441.8086">StalkingAnalyzeRequestedEvent</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="86.1631" x="601.5254" y="1457.1191">{chatId, URLs}</text></g><g class="message" data-participant-1="STALK" data-participant-2="STALK"><line style="stroke:#181818;stroke-width:1;" x1="1252.5449" x2="1294.5449" y1="1506.4824" y2="1506.4824"/><line style="stroke:#181818;stroke-width:1;" x1="1294.5449" x2="1294.5449" y1="1506.4824" y2="1519.4824"/><line style="stroke:#181818;stroke-width:1;" x1="1253.5449" x2="1294.5449" y1="1519.4824" y2="1519.4824"/><polygon fill="#181818" points="1263.5449,1515.4824,1253.5449,1519.4824,1263.5449,1523.4824,1259.5449,1519.4824" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="174.5605" x="1259.5449" y="1486.4297">StalkingAnalyzeCommand</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="177.3726" x="1259.5449" y="1501.7402">(analiza profili social media)</text></g><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="533.1787" x2="1458.9175" y1="1528.4824" y2="1528.4824"/><g class="message" data-participant-1="REST" data-participant-2="CHAT"><polygon fill="#181818" points="975.4688,1562.1035,985.4688,1566.1035,975.4688,1570.1035,979.4688,1566.1035" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="594.5254" x2="981.4688" y1="1566.1035" y2="1566.1035"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="161.5859" x="601.5254" y="1546.0508">ChatStartInterviewEvent</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="110.2969" x="601.5254" y="1561.3613">{chatId, occasion}</text></g><g class="message" data-participant-1="CHAT" data-participant-2="CHAT"><line style="stroke:#181818;stroke-width:1;" x1="997.4688" x2="1039.4688" y1="1610.7246" y2="1610.7246"/><line style="stroke:#181818;stroke-width:1;" x1="1039.4688" x2="1039.4688" y1="1610.7246" y2="1623.7246"/><line style="stroke:#181818;stroke-width:1;" x1="998.4688" x2="1039.4688" y1="1623.7246" y2="1623.7246"/><polygon fill="#181818" points="1008.4688,1619.7246,998.4688,1623.7246,1008.4688,1627.7246,1004.4688,1623.7246" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="148.4844" x="1004.4688" y="1590.6719">SetOccasionCommand</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="110.2969" x="1004.4688" y="1605.9824">{chatId, occasion}</text></g><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="3215.0039" x="0" y="1659.3799"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="3215.0039" y1="1659.3799" y2="1659.3799"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="3215.0039" y1="1662.3799" y2="1662.3799"/><rect fill="#EEEEEE" height="23.3105" style="stroke:#000000;stroke-width:2;" width="114.4326" x="1550.2856" y="1648.7246"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="96.1479" x="1556.2856" y="1665.293">Interview loop</text><path d="M882,1687.0352 L882,1742.0352 L1102,1742.0352 L1102,1697.0352 L1092,1687.0352 L882,1687.0352" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1092,1687.0352 L1092,1697.0352 L1102,1697.0352 L1092,1687.0352" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="175.4365" x="888" y="1704.6035">Wywiad zawsze si&#281; odbywa.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="169.2031" x="888" y="1719.9141">Je&#347;li profil by&#322; za&#322;adowany,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="199.5703" x="888" y="1735.2246">pierwsze pytanie jest pomijane.</text><path d="M275,1754.9668 L349.4468,1754.9668 L349.4468,1762.2773 L339.4468,1772.2773 L275,1772.2773 L275,1754.9668" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="509.5898" style="stroke:#000000;stroke-width:1.5;" width="969.4663" x="275" y="1754.9668"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29.4468" x="290" y="1768.5352">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="407.0913" x="364.4468" y="1767.6016">[Dop&#243;ki AI nie zdecyduje zako&#324;czy&#263; lub niew&#322;a&#347;ciwe zachowanie usera]</text><g class="message" data-participant-1="CHAT" data-participant-2="CHAT"><line style="stroke:#181818;stroke-width:1;" x1="997.4688" x2="1039.4688" y1="1808.8984" y2="1808.8984"/><line style="stroke:#181818;stroke-width:1;" x1="1039.4688" x2="1039.4688" y1="1808.8984" y2="1821.8984"/><line style="stroke:#181818;stroke-width:1;" x1="998.4688" x2="1039.4688" y1="1821.8984" y2="1821.8984"/><polygon fill="#181818" points="1008.4688,1817.8984,998.4688,1821.8984,1008.4688,1825.8984,1004.4688,1821.8984" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="188.0239" x="1004.4688" y="1788.8457">GenerateQuestionCommand</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="217.9976" x="1004.4688" y="1804.1563">(AI decyduje o nast&#281;pnym pytaniu)</text></g><g class="message" data-participant-1="CHAT" data-participant-2="REST"><polygon fill="#181818" points="605.5254,1862.5195,595.5254,1866.5195,605.5254,1870.5195,601.5254,1866.5195" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="599.5254" x2="986.4688" y1="1866.5195" y2="1866.5195"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="169.584" x="611.5254" y="1846.4668">ChatQuestionAskedEvent</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="227.1636" x="611.5254" y="1861.7773">{chatId, question, potentialAnswers}</text></g><g class="message" data-participant-1="REST" data-participant-2="REST"><line style="stroke:#181818;stroke-width:1;" x1="594.5254" x2="636.5254" y1="1895.8301" y2="1895.8301"/><line style="stroke:#181818;stroke-width:1;" x1="636.5254" x2="636.5254" y1="1895.8301" y2="1908.8301"/><line style="stroke:#181818;stroke-width:1;" x1="595.5254" x2="636.5254" y1="1908.8301" y2="1908.8301"/><polygon fill="#181818" points="605.5254,1904.8301,595.5254,1908.8301,605.5254,1912.8301,601.5254,1908.8301" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="161.1733" x="601.5254" y="1891.0879">NotifyUserSseCommand</text></g><g class="message" data-participant-1="REST" data-participant-2="U"><polygon fill="#181818" points="314.1826,1934.1406,304.1826,1938.1406,314.1826,1942.1406,310.1826,1938.1406" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="308.1826" x2="583.5254" y1="1938.1406" y2="1938.1406"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="139.7563" x="320.1826" y="1933.3984">SSE: chatbot-message</text></g><g class="message" data-participant-1="U" data-participant-2="REST"><polygon fill="#181818" points="572.5254,1978.7617,582.5254,1982.7617,572.5254,1986.7617,576.5254,1982.7617" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="303.1826" x2="578.5254" y1="1982.7617" y2="1982.7617"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="186.2275" x="310.1826" y="1962.709">POST /restapi/send-message</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="117.165" x="310.1826" y="1978.0195">{chatId, messages}</text></g><g class="message" data-participant-1="REST" data-participant-2="REST"><line style="stroke:#181818;stroke-width:1;" x1="594.5254" x2="636.5254" y1="2012.0723" y2="2012.0723"/><line style="stroke:#181818;stroke-width:1;" x1="636.5254" x2="636.5254" y1="2012.0723" y2="2025.0723"/><line style="stroke:#181818;stroke-width:1;" x1="595.5254" x2="636.5254" y1="2025.0723" y2="2025.0723"/><polygon fill="#181818" points="605.5254,2021.0723,595.5254,2025.0723,605.5254,2029.0723,601.5254,2025.0723" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="94.2373" x="601.5254" y="2007.3301">JwtAuthGuard</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="129.1621" x="699.876" y="2007.3301">- weryfikacja tokena</text></g><g class="message" data-participant-1="REST" data-participant-2="REST"><line style="stroke:#181818;stroke-width:1;" x1="594.5254" x2="636.5254" y1="2054.3828" y2="2054.3828"/><line style="stroke:#181818;stroke-width:1;" x1="636.5254" x2="636.5254" y1="2054.3828" y2="2067.3828"/><line style="stroke:#181818;stroke-width:1;" x1="595.5254" x2="636.5254" y1="2067.3828" y2="2067.3828"/><polygon fill="#181818" points="605.5254,2063.3828,595.5254,2067.3828,605.5254,2071.3828,601.5254,2067.3828" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="188.1699" x="601.5254" y="2049.6406">SendUserMessageCommand</text></g><g class="message" data-participant-1="REST" data-participant-2="REST"><line style="stroke:#181818;stroke-width:1;" x1="594.5254" x2="636.5254" y1="2096.6934" y2="2096.6934"/><line style="stroke:#181818;stroke-width:1;" x1="636.5254" x2="636.5254" y1="2096.6934" y2="2109.6934"/><line style="stroke:#181818;stroke-width:1;" x1="595.5254" x2="636.5254" y1="2109.6934" y2="2109.6934"/><polygon fill="#181818" points="605.5254,2105.6934,595.5254,2109.6934,605.5254,2113.6934,601.5254,2109.6934" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="161.1733" x="601.5254" y="2091.9512">NotifyUserSseCommand</text></g><g class="message" data-participant-1="REST" data-participant-2="U"><polygon fill="#181818" points="314.1826,2150.3145,304.1826,2154.3145,314.1826,2158.3145,310.1826,2154.3145" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="308.1826" x2="583.5254" y1="2154.3145" y2="2154.3145"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="139.7563" x="320.1826" y="2134.2617">SSE: chatbot-message</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="200.3003" x="320.1826" y="2149.5723">(echo wiadomo&#347;ci u&#380;ytkownika)</text></g><g class="message" data-participant-1="REST" data-participant-2="CHAT"><polygon fill="#181818" points="975.4688,2194.9355,985.4688,2198.9355,975.4688,2202.9355,979.4688,2198.9355" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="594.5254" x2="981.4688" y1="2198.9355" y2="2198.9355"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="164.5376" x="601.5254" y="2178.8828">ChatUserAnsweredEvent</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="117.165" x="601.5254" y="2194.1934">{chatId, messages}</text></g><g class="message" data-participant-1="CHAT" data-participant-2="CHAT"><line style="stroke:#181818;stroke-width:1;" x1="997.4688" x2="1039.4688" y1="2243.5566" y2="2243.5566"/><line style="stroke:#181818;stroke-width:1;" x1="1039.4688" x2="1039.4688" y1="2243.5566" y2="2256.5566"/><line style="stroke:#181818;stroke-width:1;" x1="998.4688" x2="1039.4688" y1="2256.5566" y2="2256.5566"/><polygon fill="#181818" points="1008.4688,2252.5566,998.4688,2256.5566,1008.4688,2260.5566,1004.4688,2256.5566" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="123.5317" x="1004.4688" y="2223.5039">GetOccasionQuery</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="47.1504" x="1004.4688" y="2238.8145">{chatId}</text></g><path d="M103,2278.5566 L165.1387,2278.5566 L165.1387,2285.8672 L155.1387,2295.8672 L103,2295.8672 L103,2278.5566" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="766.6504" style="stroke:#000000;stroke-width:1.5;" width="1731.6753" x="103" y="2278.5566"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17.1387" x="118" y="2292.125">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="184.2124" x="180.1387" y="2291.1914">[Wywiad zako&#324;czony pomy&#347;lnie]</text><g class="message" data-participant-1="CHAT" data-participant-2="CHAT"><line style="stroke:#181818;stroke-width:1;" x1="997.4688" x2="1039.4688" y1="2317.1777" y2="2317.1777"/><line style="stroke:#181818;stroke-width:1;" x1="1039.4688" x2="1039.4688" y1="2317.1777" y2="2330.1777"/><line style="stroke:#181818;stroke-width:1;" x1="998.4688" x2="1039.4688" y1="2330.1777" y2="2330.1777"/><polygon fill="#181818" points="1008.4688,2326.1777,998.4688,2330.1777,1008.4688,2334.1777,1004.4688,2330.1777" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="96.8335" x="1004.4688" y="2312.4355">closeInterview</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="45.9443" x="1105.4155" y="2312.4355">toolcall</text></g><g class="message" data-participant-1="CHAT" data-participant-2="GIFT"><polygon fill="#181818" points="1467.9937,2370.7988,1477.9937,2374.7988,1467.9937,2378.7988,1471.9937,2374.7988" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="997.4688" x2="1473.9937" y1="2374.7988" y2="2374.7988"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="202.1982" x="1004.4688" y="2354.7461">ChatInterviewCompletedEvent</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="96.4019" x="1004.4688" y="2370.0566">{chatId, profile}</text></g><g class="message" data-participant-1="GIFT" data-participant-2="GIFT"><line style="stroke:#181818;stroke-width:1;" x1="1489.9937" x2="1531.9937" y1="2419.4199" y2="2419.4199"/><line style="stroke:#181818;stroke-width:1;" x1="1531.9937" x2="1531.9937" y1="2419.4199" y2="2432.4199"/><line style="stroke:#181818;stroke-width:1;" x1="1490.9937" x2="1531.9937" y1="2432.4199" y2="2432.4199"/><polygon fill="#181818" points="1500.9937,2428.4199,1490.9937,2432.4199,1500.9937,2436.4199,1496.9937,2432.4199" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="218.8101" x="1496.9937" y="2399.3672">UpdateInterviewStatusCommand</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="315.6816" x="1496.9937" y="2414.6777">(zapisz profil usera, sprawd&#378; czy stalking gotowy)</text></g><g class="message" data-participant-1="CHAT" data-participant-2="REST"><polygon fill="#181818" points="605.5254,2473.041,595.5254,2477.041,605.5254,2481.041,601.5254,2477.041" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="599.5254" x2="986.4688" y1="2477.041" y2="2477.041"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="210.9897" x="611.5254" y="2456.9883">ChatCompletedNotifyUserEvent</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="96.4019" x="611.5254" y="2472.2988">{chatId, profile}</text></g><g class="message" data-participant-1="REST" data-participant-2="REST"><line style="stroke:#181818;stroke-width:1;" x1="594.5254" x2="636.5254" y1="2506.3516" y2="2506.3516"/><line style="stroke:#181818;stroke-width:1;" x1="636.5254" x2="636.5254" y1="2506.3516" y2="2519.3516"/><line style="stroke:#181818;stroke-width:1;" x1="595.5254" x2="636.5254" y1="2519.3516" y2="2519.3516"/><polygon fill="#181818" points="605.5254,2515.3516,595.5254,2519.3516,605.5254,2523.3516,601.5254,2519.3516" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="161.1733" x="601.5254" y="2501.6094">NotifyUserSseCommand</text></g><g class="message" data-participant-1="REST" data-participant-2="U"><polygon fill="#181818" points="314.1826,2570.6279,304.1826,2574.6279,314.1826,2578.6279,310.1826,2574.6279" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="308.1826" x2="583.5254" y1="2574.6279" y2="2574.6279"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="194.3335" x="320.1826" y="2554.5752">SSE: chat-interview-completed</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="49.48" x="320.1826" y="2569.8857">{profile}</text></g><path d="M137,2532.3516 L137,2587.3516 L297,2587.3516 L297,2542.3516 L287,2532.3516 L137,2532.3516" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M287,2532.3516 L287,2542.3516 L297,2542.3516 L287,2532.3516" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="130.5142" x="143" y="2549.9199">Wywiad zako&#324;czony,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="103.3335" x="143" y="2565.2305">ekran &#322;adowania</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="139.75" x="143" y="2580.541">+ opcja zapisu profilu</text><path d="M113,2600.2832 L180.1851,2600.2832 L180.1851,2607.5938 L170.1851,2617.5938 L113,2617.5938 L113,2600.2832" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="243.1055" style="stroke:#000000;stroke-width:1.5;" width="758.0381" x="113" y="2600.2832"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="22.1851" x="128" y="2613.8516">opt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="320.9121" x="195.1851" y="2612.918">[U&#380;ytkownik chce zapisa&#263; profil do p&#243;&#378;niejszego u&#380;ycia]</text><g class="message" data-participant-1="U" data-participant-2="REST"><polygon fill="#181818" points="577.5254,2665.5254,587.5254,2669.5254,577.5254,2673.5254,581.5254,2669.5254" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="303.1826" x2="583.5254" y1="2669.5254" y2="2669.5254"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="169.749" x="310.1826" y="2634.1621">POST /restapi/save-profile</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="146.6309" x="310.1826" y="2649.4727">{chatId, recipientName}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="83.1733" x="310.1826" y="2664.7832">+ JWT cookie</text></g><g class="message" data-participant-1="REST" data-participant-2="REST"><line style="stroke:#181818;stroke-width:1;" x1="599.5254" x2="641.5254" y1="2698.8359" y2="2698.8359"/><line style="stroke:#181818;stroke-width:1;" x1="641.5254" x2="641.5254" y1="2698.8359" y2="2711.8359"/><line style="stroke:#181818;stroke-width:1;" x1="600.5254" x2="641.5254" y1="2711.8359" y2="2711.8359"/><polygon fill="#181818" points="610.5254,2707.8359,600.5254,2711.8359,610.5254,2715.8359,606.5254,2711.8359" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="94.2373" x="606.5254" y="2694.0938">JwtAuthGuard</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="129.1621" x="704.876" y="2694.0938">- weryfikacja tokena</text></g><g class="message" data-participant-1="REST" data-participant-2="REST"><line style="stroke:#181818;stroke-width:1;" x1="599.5254" x2="641.5254" y1="2756.457" y2="2756.457"/><line style="stroke:#181818;stroke-width:1;" x1="641.5254" x2="641.5254" y1="2756.457" y2="2769.457"/><line style="stroke:#181818;stroke-width:1;" x1="600.5254" x2="641.5254" y1="2769.457" y2="2769.457"/><polygon fill="#181818" points="610.5254,2765.457,600.5254,2769.457,610.5254,2773.457,606.5254,2769.457" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="172.0659" x="606.5254" y="2736.4043">SaveUserProfileCommand</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="194.0415" x="606.5254" y="2751.7148">{userId, chatId, recipientName}</text></g><g class="message" data-participant-1="REST" data-participant-2="U"><polygon fill="#181818" points="314.1826,2820.7334,304.1826,2824.7334,314.1826,2828.7334,310.1826,2824.7334" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="308.1826" x2="583.5254" y1="2824.7334" y2="2824.7334"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="77.7969" x="320.1826" y="2804.6807">201 Created</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="160.8877" x="320.1826" y="2819.9912">{profileId, recipientName}</text></g><path d="M123,2782.457 L123,2837.457 L298,2837.457 L298,2792.457 L288,2782.457 L123,2782.457" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M288,2782.457 L288,2792.457 L298,2792.457 L288,2782.457" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="96.2495" x="129" y="2800.0254">Profil zapisany,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="154.0386" x="129" y="2815.3359">dost&#281;pny przy kolejnych</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="118.8345" x="129" y="2830.6465">sesji wyszukiwania</text><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="103" x2="1834.6753" y1="2851.3887" y2="2851.3887"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="196.5928" x="108" y="2862.0234">[Wykryto niew&#322;a&#347;ciwe zachowanie]</text><g class="message" data-participant-1="CHAT" data-participant-2="CHAT"><line style="stroke:#181818;stroke-width:1;" x1="997.4688" x2="1039.4688" y1="2886.6543" y2="2886.6543"/><line style="stroke:#181818;stroke-width:1;" x1="1039.4688" x2="1039.4688" y1="2886.6543" y2="2899.6543"/><line style="stroke:#181818;stroke-width:1;" x1="998.4688" x2="1039.4688" y1="2899.6543" y2="2899.6543"/><polygon fill="#181818" points="1008.4688,2895.6543,998.4688,2899.6543,1008.4688,2903.6543,1004.4688,2899.6543" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="171.0186" x="1004.4688" y="2881.9121">flagInappropriateRequest</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="45.9443" x="1179.6006" y="2881.9121">toolcall</text></g><g class="message" data-participant-1="CHAT" data-participant-2="REST"><polygon fill="#181818" points="605.5254,2940.2754,595.5254,2944.2754,605.5254,2948.2754,601.5254,2944.2754" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="599.5254" x2="986.4688" y1="2944.2754" y2="2944.2754"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="212.8369" x="611.5254" y="2924.2227">ChatInappropriateRequestEvent</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="97.7983" x="611.5254" y="2939.5332">{chatId, reason}</text></g><g class="message" data-participant-1="REST" data-participant-2="REST"><line style="stroke:#181818;stroke-width:1;" x1="594.5254" x2="636.5254" y1="2973.5859" y2="2973.5859"/><line style="stroke:#181818;stroke-width:1;" x1="636.5254" x2="636.5254" y1="2973.5859" y2="2986.5859"/><line style="stroke:#181818;stroke-width:1;" x1="595.5254" x2="636.5254" y1="2986.5859" y2="2986.5859"/><polygon fill="#181818" points="605.5254,2982.5859,595.5254,2986.5859,605.5254,2990.5859,601.5254,2986.5859" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="161.1733" x="601.5254" y="2968.8438">NotifyUserSseCommand</text></g><g class="message" data-participant-1="REST" data-participant-2="U"><polygon fill="#181818" points="314.1826,3022.5518,304.1826,3026.5518,314.1826,3030.5518,310.1826,3026.5518" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="308.1826" x2="583.5254" y1="3026.5518" y2="3026.5518"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="203.8486" x="320.1826" y="3021.8096">SSE: chat-inappropriate-request</text></g><path d="M124,2999.5859 L124,3039.5859 L297,3039.5859 L297,3009.5859 L287,2999.5859 L124,2999.5859" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M287,2999.5859 L287,3009.5859 L297,3009.5859 L287,2999.5859" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="130.5142" x="130" y="3017.1543">Wywiad zako&#324;czony,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="152.5024" x="130" y="3032.4648">nagana dla u&#380;ytkownika</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="3215.0039" x="0" y="3072.8623"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="3215.0039" y1="3072.8623" y2="3072.8623"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="3215.0039" y1="3075.8623" y2="3075.8623"/><rect fill="#EEEEEE" height="23.3105" style="stroke:#000000;stroke-width:2;" width="168.9272" x="1523.0383" y="3062.207"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="150.6426" x="1529.0383" y="3078.7754">Zako&#324;czenie Stalkingu</text><g class="message" data-participant-1="STALK" data-participant-2="GIFT"><polygon fill="#181818" points="1467.9937,3128.1387,1477.9937,3132.1387,1467.9937,3136.1387,1471.9937,3132.1387" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1247.5449" x2="1473.9937" y1="3132.1387" y2="3132.1387"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="163.2046" x="1254.5449" y="3112.0859">StalkingCompletedEvent</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="203.4487" x="1254.5449" y="3127.3965">{keywords, chatId, completedAt}</text></g><g class="message" data-participant-1="GIFT" data-participant-2="GIFT"><line style="stroke:#181818;stroke-width:1;" x1="1489.9937" x2="1531.9937" y1="3176.7598" y2="3176.7598"/><line style="stroke:#181818;stroke-width:1;" x1="1531.9937" x2="1531.9937" y1="3176.7598" y2="3189.7598"/><line style="stroke:#181818;stroke-width:1;" x1="1490.9937" x2="1531.9937" y1="3189.7598" y2="3189.7598"/><polygon fill="#181818" points="1500.9937,3185.7598,1490.9937,3189.7598,1500.9937,3193.7598,1496.9937,3189.7598" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="210.5264" x="1496.9937" y="3156.707">UpdateStalkingStatusCommand</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="299.1016" x="1496.9937" y="3172.0176">(zapisz keywords, sprawd&#378; czy wywiad gotowy)</text></g><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="3215.0039" x="0" y="3218.415"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="3215.0039" y1="3218.415" y2="3218.415"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="3215.0039" y1="3221.415" y2="3221.415"/><rect fill="#EEEEEE" height="23.3105" style="stroke:#000000;stroke-width:2;" width="266.9287" x="1474.0376" y="3207.7598"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="248.644" x="1480.0376" y="3224.3281">Koordynacja Generowania Prezent&#243;w</text><path d="M1390,3246.0703 L1390,3271.0703 L1579,3271.0703 L1579,3256.0703 L1569,3246.0703 L1390,3246.0703" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1569,3246.0703 L1569,3256.0703 L1579,3256.0703 L1569,3246.0703" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="168.0288" x="1396" y="3263.6387">Gdy oba eventy otrzymane</text><path d="M1399.8677,3283.3809 L1462.0063,3283.3809 L1462.0063,3290.6914 L1452.0063,3300.6914 L1399.8677,3300.6914 L1399.8677,3283.3809" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="497.4102" style="stroke:#000000;stroke-width:1.5;" width="1667.2334" x="1399.8677" y="3283.3809"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17.1387" x="1414.8677" y="3296.9492">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="251.9634" x="1477.0063" y="3296.0156">[Zar&#243;wno stalking jak i wywiad zako&#324;czone]</text><g class="message" data-participant-1="GIFT" data-participant-2="GIFT"><line style="stroke:#181818;stroke-width:1;" x1="1489.9937" x2="1531.9937" y1="3337.3125" y2="3337.3125"/><line style="stroke:#181818;stroke-width:1;" x1="1531.9937" x2="1531.9937" y1="3337.3125" y2="3350.3125"/><line style="stroke:#181818;stroke-width:1;" x1="1490.9937" x2="1531.9937" y1="3350.3125" y2="3350.3125"/><polygon fill="#181818" points="1500.9937,3346.3125,1490.9937,3350.3125,1500.9937,3354.3125,1496.9937,3350.3125" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="187.5859" x="1496.9937" y="3317.2598">GenerateGiftIdeasCommand</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="190.6519" x="1496.9937" y="3332.5703">{userProfile, keywords, chatId}</text></g><path d="M1708.6519,3309.1914 L1708.6519,3349.1914 L1956.6519,3349.1914 L1956.6519,3319.1914 L1946.6519,3309.1914 L1708.6519,3309.1914" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1946.6519,3309.1914 L1946.6519,3319.1914 L1956.6519,3319.1914 L1946.6519,3309.1914" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="227.4619" x="1714.6519" y="3326.7598">AI generuje zapytania wyszukiwania</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="117.7808" x="1714.6519" y="3342.0703">dla wielu serwis&#243;w</text><g class="message" data-participant-1="GIFT" data-participant-2="RERANK"><polygon fill="#181818" points="2501.9595,3390.9336,2511.9595,3394.9336,2501.9595,3398.9336,2505.9595,3394.9336" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1489.9937" x2="2507.9595" y1="3394.9336" y2="3394.9336"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="180.0386" x="1496.9937" y="3374.8809">GiftContextInitializedEvent</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="322.3975" x="1496.9937" y="3390.1914">{userProfile, keywords, chatId, eventId, totalEvents}</text></g><g class="message" data-participant-1="RERANK" data-participant-2="RERANK"><line style="stroke:#181818;stroke-width:1;" x1="2523.9595" x2="2565.9595" y1="3439.5547" y2="3439.5547"/><line style="stroke:#181818;stroke-width:1;" x1="2565.9595" x2="2565.9595" y1="3439.5547" y2="3452.5547"/><line style="stroke:#181818;stroke-width:1;" x1="2524.9595" x2="2565.9595" y1="3452.5547" y2="3452.5547"/><polygon fill="#181818" points="2534.9595,3448.5547,2524.9595,3452.5547,2534.9595,3456.5547,2530.9595,3452.5547" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="202.0522" x="2530.9595" y="3419.502">InitializeGiftContextCommand</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="231.1245" x="2530.9595" y="3434.8125">(create/update session with context)</text></g><path d="M2783.1245,3411.4336 L2783.1245,3451.4336 L3046.1245,3451.4336 L3046.1245,3421.4336 L3036.1245,3411.4336 L2783.1245,3411.4336" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M3036.1245,3411.4336 L3036.1245,3421.4336 L3046.1245,3421.4336 L3036.1245,3411.4336" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="242.0171" x="2789.1245" y="3429.002">Session created with totalEvents count</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="148.4971" x="2789.1245" y="3444.3125">for completion tracking</text><path d="M1409.8677,3467.5547 L1477.0337,3467.5547 L1477.0337,3474.8652 L1467.0337,3484.8652 L1409.8677,3484.8652 L1409.8677,3467.5547" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="306.2363" style="stroke:#000000;stroke-width:1.5;" width="828.1465" x="1409.8677" y="3467.5547"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="22.166" x="1424.8677" y="3481.123">par</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="394.8237" x="1492.0337" y="3480.1895">[R&#243;wnoleg&#322;e &#379;&#261;dania FETCH (sent AFTER GiftContextInitializedEvent)]</text><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="1409.8677" x2="2238.0142" y1="3485.8652" y2="3485.8652"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="30.9429" x="1414.8677" y="3496.5">[OLX]</text><g class="message" data-participant-1="GIFT" data-participant-2="FETCH_OLX"><polygon fill="#181818" points="1837.9307,3532.4414,1847.9307,3536.4414,1837.9307,3540.4414,1841.9307,3536.4414" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1489.9937" x2="1843.9307" y1="3536.4414" y2="3536.4414"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="95.3608" x="1496.9937" y="3516.3887">FetchOlxEvent</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="222.7266" x="1496.9937" y="3531.6992">{query, chatId, eventId, totalEvents}</text></g><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="1409.8677" x2="2238.0142" y1="3545.4414" y2="3545.4414"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="49.1348" x="1414.8677" y="3556.0762">[Allegro]</text><g class="message" data-participant-1="GIFT" data-participant-2="FETCH_ALLEGRO"><polygon fill="#181818" points="1899.7881,3592.0176,1909.7881,3596.0176,1899.7881,3600.0176,1903.7881,3596.0176" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1489.9937" x2="1905.7881" y1="3596.0176" y2="3596.0176"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="121.1831" x="1496.9937" y="3575.9648">FetchAllegroEvent</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="222.7266" x="1496.9937" y="3591.2754">{query, chatId, eventId, totalEvents}</text></g><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="1409.8677" x2="2238.0142" y1="3605.0176" y2="3605.0176"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="34.4072" x="1414.8677" y="3615.6523">[eBay]</text><g class="message" data-participant-1="GIFT" data-participant-2="FETCH_EBAY"><polygon fill="#181818" points="1963.5425,3651.5938,1973.5425,3655.5938,1963.5425,3659.5938,1967.5425,3655.5938" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1489.9937" x2="1969.5425" y1="3655.5938" y2="3655.5938"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="104.3936" x="1496.9937" y="3635.541">FetchEbayEvent</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="222.7266" x="1496.9937" y="3650.8516">{query, chatId, eventId, totalEvents}</text></g><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="1409.8677" x2="2238.0142" y1="3664.5938" y2="3664.5938"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="54.1353" x="1414.8677" y="3675.2285">[Amazon]</text><g class="message" data-participant-1="GIFT" data-participant-2="FETCH_AMAZON"><polygon fill="#181818" points="2030.8789,3711.1699,2040.8789,3715.1699,2030.8789,3719.1699,2034.8789,3715.1699" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1489.9937" x2="2036.8789" y1="3715.1699" y2="3715.1699"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="127.0928" x="1496.9937" y="3695.1172">FetchAmazonEvent</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="222.7266" x="1496.9937" y="3710.4277">{query, chatId, eventId, totalEvents}</text></g><path d="M2057,3728.1699 L2057,3768.1699 L2228,3768.1699 L2228,3738.1699 L2218,3728.1699 L2057,3728.1699" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M2218,3728.1699 L2218,3738.1699 L2228,3738.1699 L2218,3728.1699" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="150.0142" x="2063" y="3745.7383">Wiele zapyta&#324; na serwis</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="148.3765" x="2063" y="3761.0488">na podstawie decyzji AI</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="3215.0039" x="0" y="3808.4463"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="3215.0039" y1="3808.4463" y2="3808.4463"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="3215.0039" y1="3811.4463" y2="3811.4463"/><rect fill="#EEEEEE" height="23.3105" style="stroke:#000000;stroke-width:2;" width="264.9355" x="1475.0342" y="3797.791"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="246.6509" x="1481.0342" y="3814.3594">Zbieranie Produkt&#243;w i Rerankowanie</text><path d="M1824.3784,3838.1016 L1891.5444,3838.1016 L1891.5444,3845.4121 L1881.5444,3855.4121 L1824.3784,3855.4121 L1824.3784,3838.1016" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="555.4102" style="stroke:#000000;stroke-width:1.5;" width="1085.7217" x="1824.3784" y="3838.1016"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="22.166" x="1839.3784" y="3851.6699">par</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="217.2661" x="1906.5444" y="3850.7363">[Odpowiedzi od wszystkich serwis&#243;w]</text><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="1824.3784" x2="2910.1001" y1="3856.4121" y2="3856.4121"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="30.9429" x="1829.3784" y="3867.0469">[OLX]</text><g class="message" data-participant-1="FETCH_OLX" data-participant-2="RERANK"><polygon fill="#181818" points="2506.9595,3902.9883,2516.9595,3906.9883,2506.9595,3910.9883,2510.9595,3906.9883" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1859.9307" x2="2512.9595" y1="3906.9883" y2="3906.9883"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="140.5054" x="1866.9307" y="3886.9355">ProductFetchedEvent</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="406.7959" x="1866.9307" y="3902.2461">{products[], chatId, provider: "olx", success, eventId, totalEvents}</text></g><g class="message" data-participant-1="RERANK" data-participant-2="RERANK"><line style="stroke:#181818;stroke-width:1;" x1="2528.9595" x2="2570.9595" y1="3951.6094" y2="3951.6094"/><line style="stroke:#181818;stroke-width:1;" x1="2570.9595" x2="2570.9595" y1="3951.6094" y2="3964.6094"/><line style="stroke:#181818;stroke-width:1;" x1="2529.9595" x2="2570.9595" y1="3964.6094" y2="3964.6094"/><polygon fill="#181818" points="2539.9595,3960.6094,2529.9595,3964.6094,2539.9595,3968.6094,2535.9595,3964.6094" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="161.7002" x="2535.9595" y="3931.5566">CreateSessionCommand</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="143.2729" x="2535.9595" y="3946.8672">(ensure session exists)</text></g><g class="message" data-participant-1="RERANK" data-participant-2="RERANK"><line style="stroke:#181818;stroke-width:1;" x1="2528.9595" x2="2570.9595" y1="4009.2305" y2="4009.2305"/><line style="stroke:#181818;stroke-width:1;" x1="2570.9595" x2="2570.9595" y1="4009.2305" y2="4022.2305"/><line style="stroke:#181818;stroke-width:1;" x1="2529.9595" x2="2570.9595" y1="4022.2305" y2="4022.2305"/><polygon fill="#181818" points="2539.9595,4018.2305,2529.9595,4022.2305,2539.9595,4026.2305,2535.9595,4022.2305" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="221.3301" x="2535.9595" y="3989.1777">AddProductsToSessionCommand</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="194.2446" x="2535.9595" y="4004.4883">(store products with metadata)</text></g><g class="message" data-participant-1="RERANK" data-participant-2="RERANK"><line style="stroke:#181818;stroke-width:1;" x1="2528.9595" x2="2570.9595" y1="4071.8516" y2="4071.8516"/><line style="stroke:#181818;stroke-width:1;" x1="2570.9595" x2="2570.9595" y1="4071.8516" y2="4084.8516"/><line style="stroke:#181818;stroke-width:1;" x1="2523.9595" x2="2570.9595" y1="4084.8516" y2="4084.8516"/><polygon fill="#181818" points="2533.9595,4080.8516,2523.9595,4084.8516,2533.9595,4088.8516,2529.9595,4084.8516" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="262.6724" x="2535.9595" y="4051.7988">IncrementSessionCompletionCommand</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="182.749" x="2535.9595" y="4067.1094">(increment completedEvents)</text></g><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="1824.3784" x2="2910.1001" y1="4088.8516" y2="4088.8516"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="49.1348" x="1829.3784" y="4099.4863">[Allegro]</text><g class="message" data-participant-1="FETCH_ALLEGRO" data-participant-2="RERANK"><polygon fill="#181818" points="2506.9595,4135.4277,2516.9595,4139.4277,2506.9595,4143.4277,2510.9595,4139.4277" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1921.7881" x2="2512.9595" y1="4139.4277" y2="4139.4277"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="140.5054" x="1928.7881" y="4119.375">ProductFetchedEvent</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="430.4282" x="1928.7881" y="4134.6855">{products[], chatId, provider: "allegro", success, eventId, totalEvents}</text></g><g class="message" data-participant-1="RERANK" data-participant-2="RERANK"><line style="stroke:#181818;stroke-width:1;" x1="2528.9595" x2="2570.9595" y1="4173.7383" y2="4173.7383"/><line style="stroke:#181818;stroke-width:1;" x1="2570.9595" x2="2570.9595" y1="4173.7383" y2="4186.7383"/><line style="stroke:#181818;stroke-width:1;" x1="2523.9595" x2="2570.9595" y1="4186.7383" y2="4186.7383"/><polygon fill="#181818" points="2533.9595,4182.7383,2523.9595,4186.7383,2533.9595,4190.7383,2529.9595,4186.7383" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="347.1406" x="2535.9595" y="4168.9961">CreateSession &#8594; AddProducts &#8594; IncrementCompletion</text></g><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="1824.3784" x2="2910.1001" y1="4190.7383" y2="4190.7383"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="34.4072" x="1829.3784" y="4201.373">[eBay]</text><g class="message" data-participant-1="FETCH_EBAY" data-participant-2="RERANK"><polygon fill="#181818" points="2506.9595,4237.3145,2516.9595,4241.3145,2506.9595,4245.3145,2510.9595,4241.3145" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1985.5425" x2="2512.9595" y1="4241.3145" y2="4241.3145"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="140.5054" x="1992.5425" y="4221.2617">ProductFetchedEvent</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="416.4761" x="1992.5425" y="4236.5723">{products[], chatId, provider: "ebay", success, eventId, totalEvents}</text></g><g class="message" data-participant-1="RERANK" data-participant-2="RERANK"><line style="stroke:#181818;stroke-width:1;" x1="2528.9595" x2="2570.9595" y1="4275.625" y2="4275.625"/><line style="stroke:#181818;stroke-width:1;" x1="2570.9595" x2="2570.9595" y1="4275.625" y2="4288.625"/><line style="stroke:#181818;stroke-width:1;" x1="2523.9595" x2="2570.9595" y1="4288.625" y2="4288.625"/><polygon fill="#181818" points="2533.9595,4284.625,2523.9595,4288.625,2533.9595,4292.625,2529.9595,4288.625" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="347.1406" x="2535.9595" y="4270.8828">CreateSession &#8594; AddProducts &#8594; IncrementCompletion</text></g><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="1824.3784" x2="2910.1001" y1="4292.625" y2="4292.625"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="54.1353" x="1829.3784" y="4303.2598">[Amazon]</text><g class="message" data-participant-1="FETCH_AMAZON" data-participant-2="RERANK"><polygon fill="#181818" points="2506.9595,4339.2012,2516.9595,4343.2012,2506.9595,4347.2012,2510.9595,4343.2012" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="2052.8789" x2="2512.9595" y1="4343.2012" y2="4343.2012"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="140.5054" x="2059.8789" y="4323.1484">ProductFetchedEvent</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="437.0806" x="2059.8789" y="4338.459">{products[], chatId, provider: "amazon", success, eventId, totalEvents}</text></g><g class="message" data-participant-1="RERANK" data-participant-2="RERANK"><line style="stroke:#181818;stroke-width:1;" x1="2528.9595" x2="2570.9595" y1="4377.5117" y2="4377.5117"/><line style="stroke:#181818;stroke-width:1;" x1="2570.9595" x2="2570.9595" y1="4377.5117" y2="4390.5117"/><line style="stroke:#181818;stroke-width:1;" x1="2523.9595" x2="2570.9595" y1="4390.5117" y2="4390.5117"/><polygon fill="#181818" points="2533.9595,4386.5117,2523.9595,4390.5117,2533.9595,4394.5117,2529.9595,4390.5117" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="347.1406" x="2535.9595" y="4372.7695">CreateSession &#8594; AddProducts &#8594; IncrementCompletion</text></g><path d="M2195,4405.5117 L2195,4476.5117 L2842,4476.5117 L2842,4415.5117 L2832,4405.5117 L2195,4405.5117" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M2832,4405.5117 L2832,4415.5117 L2842,4415.5117 L2832,4405.5117" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="399.0835" x="2201" y="4423.0801">Reranking Service &#347;ledzi completedEvents dla ka&#380;dego eventId.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="626.3169" x="2201" y="4438.3906">Gdy completedEvents &gt;= totalEvents, automatycznie wywo&#322;uje RerankAndEmitGiftReadyCommand.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="522.2725" x="2201" y="4453.7012">Dodatkowy scheduler (@Cron EVERY_30_SECONDS) oznacza sesje jako TIMED_OUT</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="487.7983" x="2201" y="4469.0117">je&#347;li nie otrzyma&#322;y wszystkich event&#243;w w EVENT_TIMEOUT_MS (default 120s).</text><path d="M9,4488.7539 L71.1387,4488.7539 L71.1387,4496.0645 L61.1387,4506.0645 L9,4506.0645 L9,4488.7539" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="1647.2969" style="stroke:#000000;stroke-width:1.5;" width="3196.0039" x="9" y="4488.7539"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17.1387" x="24" y="4502.3223">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="365.6909" x="86.1387" y="4501.3887">[Wszystkie produkty zebrane (completedEvents &gt;= totalEvents)]</text><path d="M2353,4511.0645 L2353,4536.0645 L2684,4536.0645 L2684,4521.0645 L2674,4511.0645 L2353,4511.0645" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M2674,4511.0645 L2674,4521.0645 L2684,4521.0645 L2674,4511.0645" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="310.8066" x="2359" y="4528.6328">ProductFetchedHandler wykrywa completed=true</text><g class="message" data-participant-1="RERANK" data-participant-2="RERANK"><line style="stroke:#181818;stroke-width:1;" x1="2523.9595" x2="2565.9595" y1="4577.9961" y2="4577.9961"/><line style="stroke:#181818;stroke-width:1;" x1="2565.9595" x2="2565.9595" y1="4577.9961" y2="4590.9961"/><line style="stroke:#181818;stroke-width:1;" x1="2524.9595" x2="2565.9595" y1="4590.9961" y2="4590.9961"/><polygon fill="#181818" points="2534.9595,4586.9961,2524.9595,4590.9961,2534.9595,4594.9961,2530.9595,4590.9961" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="236.1074" x="2530.9595" y="4557.9434">RerankAndEmitGiftReadyCommand</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="54.5264" x="2530.9595" y="4573.2539">{eventId}</text></g><g class="message" data-participant-1="RERANK" data-participant-2="RERANK"><line style="stroke:#181818;stroke-width:1;" x1="2523.9595" x2="2565.9595" y1="4635.6172" y2="4635.6172"/><line style="stroke:#181818;stroke-width:1;" x1="2565.9595" x2="2565.9595" y1="4635.6172" y2="4648.6172"/><line style="stroke:#181818;stroke-width:1;" x1="2524.9595" x2="2565.9595" y1="4648.6172" y2="4648.6172"/><polygon fill="#181818" points="2534.9595,4644.6172,2524.9595,4648.6172,2534.9595,4652.6172,2530.9595,4648.6172" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="172.6182" x="2530.9595" y="4615.5645">GetSessionProductsQuery</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="54.5264" x="2530.9595" y="4630.875">{eventId}</text></g><path d="M2724.6182,4615.1514 L2724.6182,4640.1514 L3096.6182,4640.1514 L3096.6182,4625.1514 L3086.6182,4615.1514 L2724.6182,4615.1514" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M3086.6182,4615.1514 L3086.6182,4625.1514 L3096.6182,4625.1514 L3086.6182,4615.1514" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="351.9712" x="2730.6182" y="4632.7197">Pobiera wszystkie produkty (w&#322;&#261;cznie z ju&#380; ocenionymi)</text><g class="message" data-participant-1="RERANK" data-participant-2="RERANK"><line style="stroke:#181818;stroke-width:1;" x1="2523.9595" x2="2565.9595" y1="4693.2383" y2="4693.2383"/><line style="stroke:#181818;stroke-width:1;" x1="2565.9595" x2="2565.9595" y1="4693.2383" y2="4706.2383"/><line style="stroke:#181818;stroke-width:1;" x1="2524.9595" x2="2565.9595" y1="4706.2383" y2="4706.2383"/><polygon fill="#181818" points="2534.9595,4702.2383,2524.9595,4706.2383,2534.9595,4710.2383,2530.9595,4706.2383" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="135.4019" x="2530.9595" y="4673.1855">ScoreProductsQuery</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="264.9956" x="2530.9595" y="4688.4961">{unscoredProducts, userProfile, keywords}</text></g><path d="M2816.9956,4672.7725 L2816.9956,4697.7725 L3140.9956,4697.7725 L3140.9956,4682.7725 L3130.9956,4672.7725 L2816.9956,4672.7725" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M3130.9956,4672.7725 L3130.9956,4682.7725 L3140.9956,4682.7725 L3130.9956,4672.7725" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="303.1577" x="2822.9956" y="4690.3408">Tylko nieocenione produkty s&#261; przesy&#322;ane do AI</text><g class="message" data-participant-1="RERANK" data-participant-2="RERANK"><line style="stroke:#181818;stroke-width:1;" x1="2523.9595" x2="2565.9595" y1="4750.8594" y2="4750.8594"/><line style="stroke:#181818;stroke-width:1;" x1="2565.9595" x2="2565.9595" y1="4750.8594" y2="4763.8594"/><line style="stroke:#181818;stroke-width:1;" x1="2524.9595" x2="2565.9595" y1="4763.8594" y2="4763.8594"/><polygon fill="#181818" points="2534.9595,4759.8594,2524.9595,4763.8594,2534.9595,4767.8594,2530.9595,4763.8594" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="216.9946" x="2530.9595" y="4730.8066">UpdateProductRatingsCommand</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="187.5605" x="2530.9595" y="4746.1172">(update products with scores)</text></g><path d="M2768.9946,4722.7383 L2768.9946,4762.7383 L3065.9946,4762.7383 L3065.9946,4732.7383 L3055.9946,4722.7383 L2768.9946,4722.7383" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M3055.9946,4722.7383 L3055.9946,4732.7383 L3065.9946,4732.7383 L3055.9946,4722.7383" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="276.3579" x="2774.9946" y="4740.3066">Filtruje produkty z score &lt; MINIMAL_SCORE</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="143.5649" x="2774.9946" y="4755.6172">sortuje po score (desc)</text><g class="message" data-participant-1="RERANK" data-participant-2="RERANK"><line style="stroke:#181818;stroke-width:1;" x1="2523.9595" x2="2565.9595" y1="4804.9805" y2="4804.9805"/><line style="stroke:#181818;stroke-width:1;" x1="2565.9595" x2="2565.9595" y1="4804.9805" y2="4817.9805"/><line style="stroke:#181818;stroke-width:1;" x1="2524.9595" x2="2565.9595" y1="4817.9805" y2="4817.9805"/><polygon fill="#181818" points="2534.9595,4813.9805,2524.9595,4817.9805,2534.9595,4821.9805,2530.9595,4817.9805" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="329.8242" x="2530.9595" y="4800.2383">CheckAndPrepareRegenerateIdeasLoopCommand</text></g><path d="M2881.8242,4776.8594 L2881.8242,4831.8594 L3183.8242,4831.8594 L3183.8242,4786.8594 L3173.8242,4776.8594 L2881.8242,4776.8594" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M3173.8242,4776.8594 L3173.8242,4786.8594 L3183.8242,4786.8594 L3173.8242,4776.8594" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="64.6255" x="2887.8242" y="4794.4277">Sprawdza:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="281.2202" x="2887.8242" y="4809.7383">- goodProducts.length &lt; TOP_BEST_COUNT?</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="213.6875" x="2887.8242" y="4825.0488">- loopCount &lt; MAX_IDEAS_LOOP?</text><path d="M19,4844.791 L81.1387,4844.791 L81.1387,4852.1016 L71.1387,4862.1016 L19,4862.1016 L19,4844.791" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="1284.2598" style="stroke:#000000;stroke-width:1.5;" width="3086.7202" x="19" y="4844.791"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17.1387" x="34" y="4858.3594">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="334.9575" x="96.1387" y="4857.4258">[Insufficient products AND loopCount &lt; MAX_IDEAS_LOOP]</text><g class="message" data-participant-1="RERANK" data-participant-2="GIFT"><polygon fill="#181818" points="1500.9937,4905.3779,1490.9937,4909.3779,1500.9937,4913.3779,1496.9937,4909.3779" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1494.9937" x2="2517.9595" y1="4909.3779" y2="4909.3779"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="180.6289" x="1506.9937" y="4889.3252">RegenerateIdeasLoopEvent</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="454.0669" x="1506.9937" y="4904.6357">{chatId, eventId, badProducts[], providerCounts[], userProfile, keywords}</text></g><path d="M2528,4867.1016 L2528,4922.1016 L2839,4922.1016 L2839,4877.1016 L2829,4867.1016 L2528,4867.1016" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M2829,4867.1016 L2829,4877.1016 L2839,4877.1016 L2829,4867.1016" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="176.4077" x="2534" y="4884.6699">Regeneracja z feedbackiem:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="290.5894" x="2534" y="4899.9805">- Lista z&#322;ych produkt&#243;w + scores + reasoning</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="153.6577" x="2534" y="4915.291">- Statystyki per provider</text><g class="message" data-participant-1="GIFT" data-participant-2="GIFT"><line style="stroke:#181818;stroke-width:1;" x1="1489.9937" x2="1531.9937" y1="4964.6543" y2="4964.6543"/><line style="stroke:#181818;stroke-width:1;" x1="1531.9937" x2="1531.9937" y1="4964.6543" y2="4977.6543"/><line style="stroke:#181818;stroke-width:1;" x1="1490.9937" x2="1531.9937" y1="4977.6543" y2="4977.6543"/><polygon fill="#181818" points="1500.9937,4973.6543,1490.9937,4977.6543,1500.9937,4981.6543,1496.9937,4977.6543" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="90.2065" x="1496.9937" y="4944.6016">giftIdeasFlow</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="100.2231" x="1591.3135" y="4944.6016">(z feedbackiem)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="335.937" x="1496.9937" y="4959.9121">{userProfile, keywords, badProducts, providerCounts}</text></g><path d="M1853.937,4936.5332 L1853.937,4976.5332 L2123.937,4976.5332 L2123.937,4946.5332 L2113.937,4936.5332 L1853.937,4936.5332" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M2113.937,4936.5332 L2113.937,4946.5332 L2123.937,4946.5332 L2113.937,4936.5332" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="249.7041" x="1859.937" y="4954.1016">AI dostaje feedback o z&#322;ych produktach</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="203.4678" x="1859.937" y="4969.4121">aby generowa&#263; lepsze zapytania</text><g class="message" data-participant-1="GIFT" data-participant-2="RERANK"><polygon fill="#181818" points="2501.9595,5018.2754,2511.9595,5022.2754,2501.9595,5026.2754,2505.9595,5022.2754" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1489.9937" x2="2507.9595" y1="5022.2754" y2="5022.2754"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="180.0386" x="1496.9937" y="5002.2227">GiftContextInitializedEvent</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="244.7656" x="1496.9937" y="5017.5332">{eventId (ten sam!), totalEvents (nowe)}</text></g><g class="message" data-participant-1="RERANK" data-participant-2="RERANK"><line style="stroke:#181818;stroke-width:1;" x1="2523.9595" x2="2565.9595" y1="5087.207" y2="5087.207"/><line style="stroke:#181818;stroke-width:1;" x1="2565.9595" x2="2565.9595" y1="5087.207" y2="5100.207"/><line style="stroke:#181818;stroke-width:1;" x1="2518.9595" x2="2565.9595" y1="5100.207" y2="5100.207"/><polygon fill="#181818" points="2528.9595,5096.207,2518.9595,5100.207,2528.9595,5104.207,2524.9595,5100.207" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="187.1733" x="2530.9595" y="5051.8438">InitializeGiftContextHandler</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="255.1694" x="2530.9595" y="5067.1543">UPDATE: totalEvents += new totalEvents</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="102.2607" x="2530.9595" y="5082.4648">status = ACTIVE</text></g><path d="M2807.1694,5038.7754 L2807.1694,5093.7754 L3084.1694,5093.7754 L3084.1694,5048.7754 L3074.1694,5038.7754 L2807.1694,5038.7754" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M3074.1694,5038.7754 L3074.1694,5048.7754 L3084.1694,5048.7754 L3074.1694,5038.7754" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="256.5913" x="2813.1694" y="5056.3438">Dla regeneracji: dodaje nowe totalEvents</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="194.0225" x="2813.1694" y="5071.6543">do istniej&#261;cych (kumulatywnie)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="164.7471" x="2813.1694" y="5086.9648">Resetuje status na ACTIVE</text><path d="M1409.8677,5110.207 L1477.0337,5110.207 L1477.0337,5117.5176 L1467.0337,5127.5176 L1409.8677,5127.5176 L1409.8677,5110.207" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="255.6152" style="stroke:#000000;stroke-width:1.5;" width="682.8984" x="1409.8677" y="5110.207"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="22.166" x="1424.8677" y="5123.7754">par</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="296.0332" x="1492.0337" y="5122.8418">[Druga Fala FETCH (nowe zapytania z feedbackiem)]</text><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="1409.8677" x2="2092.7661" y1="5128.5176" y2="5128.5176"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="30.9429" x="1414.8677" y="5139.1523">[OLX]</text><g class="message" data-participant-1="GIFT" data-participant-2="FETCH_OLX"><polygon fill="#181818" points="1837.9307,5175.0938,1847.9307,5179.0938,1837.9307,5183.0938,1841.9307,5179.0938" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1489.9937" x2="1843.9307" y1="5179.0938" y2="5179.0938"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="95.3608" x="1496.9937" y="5159.041">FetchOlxEvent</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106.5327" x="1496.9937" y="5174.3516">(nowe zapytania)</text></g><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="1409.8677" x2="2092.7661" y1="5188.0938" y2="5188.0938"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="49.1348" x="1414.8677" y="5198.7285">[Allegro]</text><g class="message" data-participant-1="GIFT" data-participant-2="FETCH_ALLEGRO"><polygon fill="#181818" points="1899.7881,5234.6699,1909.7881,5238.6699,1899.7881,5242.6699,1903.7881,5238.6699" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1489.9937" x2="1905.7881" y1="5238.6699" y2="5238.6699"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="121.1831" x="1496.9937" y="5218.6172">FetchAllegroEvent</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106.5327" x="1496.9937" y="5233.9277">(nowe zapytania)</text></g><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="1409.8677" x2="2092.7661" y1="5247.6699" y2="5247.6699"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="34.4072" x="1414.8677" y="5258.3047">[eBay]</text><g class="message" data-participant-1="GIFT" data-participant-2="FETCH_EBAY"><polygon fill="#181818" points="1963.5425,5294.2461,1973.5425,5298.2461,1963.5425,5302.2461,1967.5425,5298.2461" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1489.9937" x2="1969.5425" y1="5298.2461" y2="5298.2461"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="104.3936" x="1496.9937" y="5278.1934">FetchEbayEvent</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106.5327" x="1496.9937" y="5293.5039">(nowe zapytania)</text></g><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="1409.8677" x2="2092.7661" y1="5307.2461" y2="5307.2461"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="54.1353" x="1414.8677" y="5317.8809">[Amazon]</text><g class="message" data-participant-1="GIFT" data-participant-2="FETCH_AMAZON"><polygon fill="#181818" points="2030.8789,5353.8223,2040.8789,5357.8223,2030.8789,5361.8223,2034.8789,5357.8223" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1489.9937" x2="2036.8789" y1="5357.8223" y2="5357.8223"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="127.0928" x="1496.9937" y="5337.7695">FetchAmazonEvent</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106.5327" x="1496.9937" y="5353.0801">(nowe zapytania)</text></g><path d="M2321,5377.8223 L2321,5432.8223 L2716,5432.8223 L2716,5387.8223 L2706,5377.8223 L2321,5377.8223" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M2706,5377.8223 L2706,5387.8223 L2716,5387.8223 L2706,5377.8223" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="185.6753" x="2327" y="5395.3906">Nowe produkty przychodz&#261;...</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="232.9272" x="2327" y="5410.7012">IncrementSessionCompletionHandler</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="374.2959" x="2327" y="5426.0117">czeka a&#380; completedEvents &gt;= totalEvents (zaktualizowane)</text><path d="M1824.3784,5445.7539 L1891.5444,5445.7539 L1891.5444,5453.0645 L1881.5444,5463.0645 L1824.3784,5463.0645 L1824.3784,5445.7539" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="363.6152" style="stroke:#000000;stroke-width:1.5;" width="1075.7217" x="1824.3784" y="5445.7539"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="22.166" x="1839.3784" y="5459.3223">par</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="94.311" x="1906.5444" y="5458.3887">[Nowe Produkty]</text><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="1824.3784" x2="2900.1001" y1="5464.0645" y2="5464.0645"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="30.9429" x="1829.3784" y="5474.6992">[OLX]</text><g class="message" data-participant-1="FETCH_OLX" data-participant-2="RERANK"><polygon fill="#181818" points="2501.9595,5495.3301,2511.9595,5499.3301,2501.9595,5503.3301,2505.9595,5499.3301" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1859.9307" x2="2507.9595" y1="5499.3301" y2="5499.3301"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="140.5054" x="1866.9307" y="5494.5879">ProductFetchedEvent</text></g><g class="message" data-participant-1="RERANK" data-participant-2="RERANK"><line style="stroke:#181818;stroke-width:1;" x1="2523.9595" x2="2565.9595" y1="5533.6406" y2="5533.6406"/><line style="stroke:#181818;stroke-width:1;" x1="2565.9595" x2="2565.9595" y1="5533.6406" y2="5546.6406"/><line style="stroke:#181818;stroke-width:1;" x1="2518.9595" x2="2565.9595" y1="5546.6406" y2="5546.6406"/><polygon fill="#181818" points="2528.9595,5542.6406,2518.9595,5546.6406,2528.9595,5550.6406,2524.9595,5546.6406" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="347.1406" x="2530.9595" y="5528.8984">CreateSession &#8594; AddProducts &#8594; IncrementCompletion</text></g><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="1824.3784" x2="2900.1001" y1="5550.6406" y2="5550.6406"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="49.1348" x="1829.3784" y="5561.2754">[Allegro]</text><g class="message" data-participant-1="FETCH_ALLEGRO" data-participant-2="RERANK"><polygon fill="#181818" points="2501.9595,5581.9063,2511.9595,5585.9063,2501.9595,5589.9063,2505.9595,5585.9063" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1921.7881" x2="2507.9595" y1="5585.9063" y2="5585.9063"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="140.5054" x="1928.7881" y="5581.1641">ProductFetchedEvent</text></g><g class="message" data-participant-1="RERANK" data-participant-2="RERANK"><line style="stroke:#181818;stroke-width:1;" x1="2523.9595" x2="2565.9595" y1="5620.2168" y2="5620.2168"/><line style="stroke:#181818;stroke-width:1;" x1="2565.9595" x2="2565.9595" y1="5620.2168" y2="5633.2168"/><line style="stroke:#181818;stroke-width:1;" x1="2518.9595" x2="2565.9595" y1="5633.2168" y2="5633.2168"/><polygon fill="#181818" points="2528.9595,5629.2168,2518.9595,5633.2168,2528.9595,5637.2168,2524.9595,5633.2168" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="347.1406" x="2530.9595" y="5615.4746">CreateSession &#8594; AddProducts &#8594; IncrementCompletion</text></g><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="1824.3784" x2="2900.1001" y1="5637.2168" y2="5637.2168"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="34.4072" x="1829.3784" y="5647.8516">[eBay]</text><g class="message" data-participant-1="FETCH_EBAY" data-participant-2="RERANK"><polygon fill="#181818" points="2501.9595,5668.4824,2511.9595,5672.4824,2501.9595,5676.4824,2505.9595,5672.4824" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1985.5425" x2="2507.9595" y1="5672.4824" y2="5672.4824"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="140.5054" x="1992.5425" y="5667.7402">ProductFetchedEvent</text></g><g class="message" data-participant-1="RERANK" data-participant-2="RERANK"><line style="stroke:#181818;stroke-width:1;" x1="2523.9595" x2="2565.9595" y1="5706.793" y2="5706.793"/><line style="stroke:#181818;stroke-width:1;" x1="2565.9595" x2="2565.9595" y1="5706.793" y2="5719.793"/><line style="stroke:#181818;stroke-width:1;" x1="2518.9595" x2="2565.9595" y1="5719.793" y2="5719.793"/><polygon fill="#181818" points="2528.9595,5715.793,2518.9595,5719.793,2528.9595,5723.793,2524.9595,5719.793" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="347.1406" x="2530.9595" y="5702.0508">CreateSession &#8594; AddProducts &#8594; IncrementCompletion</text></g><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="1824.3784" x2="2900.1001" y1="5723.793" y2="5723.793"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="54.1353" x="1829.3784" y="5734.4277">[Amazon]</text><g class="message" data-participant-1="FETCH_AMAZON" data-participant-2="RERANK"><polygon fill="#181818" points="2501.9595,5755.0586,2511.9595,5759.0586,2501.9595,5763.0586,2505.9595,5759.0586" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="2052.8789" x2="2507.9595" y1="5759.0586" y2="5759.0586"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="140.5054" x="2059.8789" y="5754.3164">ProductFetchedEvent</text></g><g class="message" data-participant-1="RERANK" data-participant-2="RERANK"><line style="stroke:#181818;stroke-width:1;" x1="2523.9595" x2="2565.9595" y1="5793.3691" y2="5793.3691"/><line style="stroke:#181818;stroke-width:1;" x1="2565.9595" x2="2565.9595" y1="5793.3691" y2="5806.3691"/><line style="stroke:#181818;stroke-width:1;" x1="2518.9595" x2="2565.9595" y1="5806.3691" y2="5806.3691"/><polygon fill="#181818" points="2528.9595,5802.3691,2518.9595,5806.3691,2528.9595,5810.3691,2524.9595,5806.3691" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="347.1406" x="2530.9595" y="5788.627">CreateSession &#8594; AddProducts &#8594; IncrementCompletion</text></g><path d="M2318,5821.3691 L2318,5892.3691 L2718,5892.3691 L2718,5831.3691 L2708,5821.3691 L2318,5821.3691" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M2708,5821.3691 L2708,5831.3691 L2718,5831.3691 L2708,5821.3691" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="334.4897" x="2324" y="5838.9375">Gdy completedEvents &gt;= totalEvents (po drugiej fali)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="379.4502" x="2324" y="5854.248">RerankAndEmitGiftReadyCommand uruchamia si&#281; ponownie</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="316.6021" x="2324" y="5869.5586">Z WSZYSTKIMI produktami (pierwsza + druga fala)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="291.7065" x="2324" y="5884.8691">Ale ocenia TYLKO nowe (stare maj&#261; ju&#380; rating)</text><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="19" x2="3105.7202" y1="5898.6113" y2="5898.6113"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="313.0649" x="24" y="5909.2461">[Enough products OR loopCount &gt;= MAX_IDEAS_LOOP]</text><g class="message" data-participant-1="RERANK" data-participant-2="REST"><polygon fill="#181818" points="610.5254,5955.8428,600.5254,5959.8428,610.5254,5963.8428,606.5254,5959.8428" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="604.5254" x2="2517.9595" y1="5959.8428" y2="5959.8428"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="101.9434" x="616.5254" y="5939.79">GiftReadyEvent</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="162.3096" x="616.5254" y="5955.1006">{chatId, rankedProducts[]}</text></g><path d="M2523,5917.5664 L2523,5972.5664 L2879,5972.5664 L2879,5927.5664 L2869,5917.5664 L2523,5917.5664" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M2869,5917.5664 L2869,5927.5664 L2879,5927.5664 L2869,5917.5664" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="140.1816" x="2529" y="5935.1348">RERANK emituje event</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="335.5181" x="2529" y="5950.4453">z WSZYSTKIMI produktami score &gt;= MINIMAL_SCORE</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="138.5313" x="2529" y="5965.7559">(sorted desc by score)</text><g class="message" data-participant-1="REST" data-participant-2="REST"><line style="stroke:#181818;stroke-width:1;" x1="599.5254" x2="641.5254" y1="6015.1191" y2="6015.1191"/><line style="stroke:#181818;stroke-width:1;" x1="641.5254" x2="641.5254" y1="6015.1191" y2="6028.1191"/><line style="stroke:#181818;stroke-width:1;" x1="600.5254" x2="641.5254" y1="6028.1191" y2="6028.1191"/><polygon fill="#181818" points="610.5254,6024.1191,600.5254,6028.1191,610.5254,6032.1191,606.5254,6028.1191" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="151.0679" x="606.5254" y="5995.0664">SaveListingsCommand</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109.3955" x="606.5254" y="6010.377">{chatId, listings[]}</text></g><g class="message" data-participant-1="REST" data-participant-2="REST"><line style="stroke:#181818;stroke-width:1;" x1="599.5254" x2="641.5254" y1="6057.4297" y2="6057.4297"/><line style="stroke:#181818;stroke-width:1;" x1="641.5254" x2="641.5254" y1="6057.4297" y2="6070.4297"/><line style="stroke:#181818;stroke-width:1;" x1="600.5254" x2="641.5254" y1="6070.4297" y2="6070.4297"/><polygon fill="#181818" points="610.5254,6066.4297,600.5254,6070.4297,610.5254,6074.4297,606.5254,6070.4297" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="161.1733" x="606.5254" y="6052.6875">NotifyUserSseCommand</text></g><g class="message" data-participant-1="REST" data-participant-2="U"><polygon fill="#181818" points="314.1826,6114.0508,304.1826,6118.0508,314.1826,6122.0508,310.1826,6118.0508" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="308.1826" x2="583.5254" y1="6118.0508" y2="6118.0508"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="93.0186" x="320.1826" y="6097.998">SSE: gift-ready</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109.0591" x="320.1826" y="6113.3086">{listings with IDs}</text></g><path d="M29,6083.4297 L29,6123.4297 L297,6123.4297 L297,6093.4297 L287,6083.4297 L29,6083.4297" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M287,6083.4297 L287,6093.4297 L297,6093.4297 L287,6083.4297" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="210.0186" x="35" y="6100.998">Produkty gotowe do wy&#347;wietlenia</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="247.2285" x="35" y="6116.3086">u&#380;ytkownik mo&#380;e doda&#263; do ulubionych</text><!--SRC=[tLfRSzl65NxdhpXLPpgaeukJl6cYfBH4AumbqI6fE7QOqIo19RKYY6LmCGnczEA9s_U-PV8pyfRwBU8VwI_fERiBO062iXoxhQSpSIGHYtE_VESi8n5v7DfTU1pmaFiHF1I-omFOWLCcV7ZeoGIQXtA-y7Z48H7H9U1VS-Qx8Vm5Ei_nbR3LQ30daW6SX_Wc2-6yiM1191onO4XngzyP3A7zkBj5p-YFykDZAQSeGwyTHvVgo76lTtpIAHywl6GH37ZmN3XS7JhyibsXCuYODnF-j7HiC6oVFAhm4vC8kYwdfzR9u-x3OMCiNy3MGnuvbt0gd426-a2u1Ny-4TFBw84NymP0YLxlv5j5u65dUFZb1VvLFT3sF3uDf7MeVNBIEUxtgWVv0vPQfpeFsa_NQCtPKlesgTFsizvPW_ikeF0Lm_E0-MicwNVwxRD7ZSR10Q39PP0kcNF585wzJgEPJ7mnOt1mq3Y7dS-Lj_RXk3E4FORksPigN-t5WKSk5yyP1eNogF9n_iAzUyVSH-OHryvLlZqFlAzZ7gJtxkMdjQUH0O-q_-6yVsAUukFpVVWHMUt3rcKKBSBzlJtcE3B6aDlLWkmwShwtkxkxTTr0VvO4yYN-vl59j0_dXMQm29Py9dWWa_YAZtnNWXr-3Qrr9fPjdiGSBFGsOQf_PFBskIi2xaImX9bq-HnOHYEzyjEvBQPvtpRquzwWOcc7UTwOEREH_wE3zAxVOFPlc2VStEn3EUE-ITSQgpz9vuBvZ0ID0Nz6TFms_JIN7z49F0mLyMq8-0GhnwNvYy-PyBQHs9nVr-XQ5ZUB4VZgoT0mjrq_uD7EePJehNtGB2_K8MXIDFHyBssXLM9CKPH9k6NcjmO4yLkoXGYPdw9ZCtBWA6uZ_qY6qStF2y3eS2u3wGlffrWHCCSMKlZHxxycAdkmu0GHX3oy4j2qqWTfUt8g4wJUeangC2yg1U6SPUmv1gIS28-AIZNXqAmHdjeZ3NVCiN3aVwJ4rwBYMsKb0QeHyLKIKMGVnop06C2wdc0AJZ37AQYLFLdDMvYGLCmV6wucRusvk-vr_efsrIVtxqFl4JxEnDo7xp0jlwTpLJy0R4ZDkLoznXQJZWDsy_UHlmHFX56QEmeTeAcBaU_5O_25EeovZCTXzPgvFfzA94z6gHZSd2kShYdXoPBPTVfbTWzDFza9-0ynVaOfY5seYv5crAHVG-a8vb7T2hT1EWuBCLgkrzoqxgW_wghrzrGSegieHL3U9zYaZUEAtAVtbDq3QcEegZg01bczPAuALQnOOxPCGK2SBAVUpS-kYdlCZoHD17ENIW_kXRnaMiiDkHECVUB67xFk7KtwdudyYZ5j2sB-DshrB_BPYjB_A-L9TS8M63TB7YKiM39Il8-bq9U8RbOlkKLEWIv3J-dPzfcNBdbVQyjTXHjLFSdK9dslRRqqS0FzypQYkP0ZludTp1DBbhaWC-OScp9hAT-L4eWm954aSAbKx_eH0IMUh0kOkwASp0g6qYVqYqqJkrVFl699M4DEcHQxISuRF2aNr3TKlihdYAarqISg3p7Kad398HGtFuDqnsd2TaV-Ltpr2ogi5OTnkdffv_Rso5zWXght5ccaV7U5de25d8ihR4Ex3SNqI2v-_tKcQ1wW8qkNEwcBG0bfpUJg9sUPOgarnJT1wgjV797GK-UI-E0hr1yeighco7hzrnG0PPiqaLlEI6BxLiqNmP8HDMxbzAnG9PzbnDhXh2wcVZ2FiLwZ9Vq8Gw7jXvW8uNLDx9_9I4nIwdg3i5GuiuC4IGO8cuZyM4OxSqmIDkMtvZawDpjd2MO-gHNZ3oOkCYBHJpNbEl7VLKzq54St0yMWn5wDhY_D3Ar6VM8H9stsEX_PfbYFcJo52W2YNpHfGtq-pmeTeTIoCAfJJ0TVLSegLSV3gIvFDZHn9AL7CDiwIxDW9dz-D9k2QxGmUA1KmDGy2Ug7JV9yGVWy9ufb9uf3EnjK9rbccQpo2Rl28c29k_eDC0KXwnumbP5CqfObk9qTkRo5ns-L_9q2PKTa6kqu6Ty23rwNKT-wox10yHaEgv2LBC6evSa5HRsoI6o12lnFBie8pxbqk6d2MAACyH2_OprR_OQ1S8Mb3u491IosX3S0F_QSPu3RCXMETGAhg1-TqO3ntqLuA965n-s6eW7vDjHBQL7BaFh7S1XmLdBFXlVMaNl9Ypc4rCXdcwPfKxffp4vnhlJu5K6YaQ-7f2GDb_5CAFVQUEf9EWlII6xiAZLPFF7OjEkp1Mgm20IAQB15VJxRQL7trdfUe8b2tUpVDIqiRXdSkqCs-6nAexdhbHSpkknPZb7uW-33C_CwfowSGQIOO4IEeB8Ib3sjAMWpdYOoSCCYdl9iRaUbcLhZi_hgbZ7OMDmADgN2fWUDlAoHMeyadajzbI0AG-ZYGEjAL9L6yJ9Iqe8Skod8CGDEYk6l4OOZoi1rntZ60eLRYq9wnMOWClQ58tXD_SuNMs8IgILYDHbDZcv3rPPv4JGZ6CAUAH7J-4fZ7LRA4Smez7yYk1S3Kav4IAi7LVyoiVGoJmc60XrAhC8lCCG5WHsnj5rxgspRsbJqIoJHAdgnUrqUDDJQ4CmlPUO5HqiCs_6EgZbxiOeFsfbGLzVxP4UVRbNCCp1dz9kkFci91seJEF8dCiY2b8v70NF8fmtGgzFIZ0AhVzwySfMTrVOKcchdtNuuxFJX5WEsiibNRtSjgzXBty8h-QTa6xLExdal2bVyG6ZcpQPN7Ctok8QyMIBdBCp9jsQpfasndLOIq5QwXZrjftFUdJ5BtvsnMNXhlTMYkqvjjV0kj5RdteFIUezUtfE0d5IuFi5apD9rzHDjJNLYKiL6tEbYIS5yLVFCyee6gQpFuJzx7qhWK9LjjJcXcesvwSOpLT44wCszcQcmm54Wzzo5HDhkKk3O1pZBfM4q4ywbLHgi6Cr3i9oeYeiJATFPrM6XFm-_-xwm7NxsNBYqNjsIteijBDQnMiE-Qx7G-CFajrqak1_6GL4T-0iHqkrIFPMswnfbmg6i8HP6Cb3hLNL4buyvZnWM8DRQMCQmsinHcuAUgIisPP6TAffZTX5M0KtA29KqBkNOUt4EC_TBxyb19VV0l_xs3x1ChVxEpLJOPxFcfdmK6VvUTEPOS3vGXVFAPLUEz-DeVVdtuQbTBcv5JrpxC6ijQmzKwLy_hekoXUyAVQftcu0JlogEbQHK67h6LgzT6W2DmNO9GhdfsjdF3snBRglRkpcBKcUfzzo9NBqalAQvjtstCnSH0OS-PsvgYWGHFv9OPx20uxHEBeuzbBtvryC0BTtvfjD_Ul7f_Oj1vx1tTZHeWLmYm5qoTPN42OnA67PFEqSNlNEQkgxqReyaC4XszJAr6u1IYXf7GiJFXXVqDhvxSJg0fiidB4RK-_4dzyFMhhee9dEQvOaXOWhbZEvR-3YWYwdcxRR9uPhbbdqe1_QNQ0nIFA7vBc65jG-Y8EPtxXUt6blbZV7gzGO2npmhw5bu5_iawzNI_OZKLnh9ke6QEAFUlD8HiOGh7Cz0EbnTbip5fiuoSB0RhNEF_P0Uv6ct3RKmlIhTCFLcQbmsZ2tfmfjNwf8xJ76InWUkr22aJYWzhHdUVHPXDfMcDOFMoprK2HnMqVf3uKLgaYdYI9-4p-2qUzOzRPzS30vx_Sx83sKGgPFIdC0G3PrDXZkyv0xv7WS-144ui4_D0AQ6hnCf5_OCNXeWr6YvPFiZVmTdIfaRUTVZ_XGr-Go6lSSN3t1ilpZidPyDlw23dgA8amK9tlxsedlKQGykJdgznryKTujT12gJYN1eNrAOftrsTClhPXMJQPZDapKAhMyZyZ8_PhaMr2Eotg0ugaysXa_PDXbNjLw32USkVSb0yBaorWdYBlmSguo-pifmwKV6-VYBtezWmD1vclCnIzAPW0McUoRL-XB99FdwbdHzpfvcypLz1UdUFMYMn6nj7cWj4rKDj6u7kdgGg2o6OqOTP4LpHWiiDaxrj8wOdEv0-8BkKlAnlQJ2tMTourTeHjo7aCt_r2frScZwCk6jw-fsCJVZdKTnKuc9wVdZe_Qmir_Yyz41-3onFy8qLSiRE83suR3xJMVDT4VOLeCyZCG-6j8bEvB8PKfOWZ2WQ0cBPPCCsvp5yzZ3c4dmGtHbduTSbGJ34qSfYsbz1Ad_qLXq5CHJ7EUPby_qIe9Yer8E7FLUQPRVECtVTPwlCBHOsCFxsuxljLHlcTMhq_hTv_MxSJB3-Vfu_dO3-XtLAgPn0fULCCYBHX6K9HHoHYpoHaIxQETIkikRLxkxkoD_yv1dicJaEqi-Ou2OyGq04QiIcqKnPHlDwhnL3aqbXvdhqxh0UviXlMeeAnVU9xhVd74r4Vssi-o7eOEL8cyrbNuW7h0pxor7pF-z1kl9NAwv6oV6seTvJTeqETvI9Duy_a4J8QgBxGKx5qmmoLMhkcKMWJY84RBDiUceRsSif4_NDdpaFuCdWsTF1yD7tTDkZYlc0ZdehsKmX5IkQcJ8Xo6VjiVrLC5W-FJaKK-trIOso82-RuITL4yUWKBjUTrH4TBnPJozB71fhs_1KbJnLboQVmCmqwtcRWmjm2qSMWClDJcEDgAshc0EVQEltWXw2Y31oeD2aoO5xWAD1p1EzRdMNL3bnWjOkaWbT5kPT7BLFFCiK-hEbt_hrty4O7S2iY3Ip-Zg4Qfx5DxrXbMtC7KZfcQv95tzaWWUULpT3yLhtvya58O05O_6NZpMtrorTj3_1W00]--></g></svg>