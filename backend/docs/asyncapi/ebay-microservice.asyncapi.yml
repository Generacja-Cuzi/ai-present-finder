asyncapi: 3.0.0
info:
  title: eBay Microservice API
  version: 1.0.0
  description: |
    This microservice provides endpoints for searching eBay listings.
    It handles product searches and returns listing data from eBay platform.

servers:
  production:
    host: localhost:3023
    protocol: http
    description: eBay Microservice Production Server

channels:
  http/ebay:
    address: '/ebay'
    messages:
      searchListings:
        $ref: '#/components/messages/searchListings'
      listingResults:
        $ref: '#/components/messages/listingResults'

operations:
  searchEbayListings:
    action: receive
    channel:
      $ref: '#/channels/http~1ebay'
    summary: Search eBay listings
    description: Searches for products on eBay platform based on query parameters
    messages:
      - $ref: '#/channels/http~1ebay/messages/searchListings'

components:
  messages:
    searchListings:
      name: SearchListings
      title: Search eBay listings
      summary: Request to search eBay listings
      contentType: application/json
      payload:
        $ref: '#/components/schemas/SearchRequest'

    listingResults:
      name: ListingResults
      title: eBay listing results
      summary: Results from eBay search
      contentType: application/json
      payload:
        $ref: '#/components/schemas/ListingResults'

  schemas:
    SearchRequest:
      type: object
      properties:
        query:
          type: string
          description: Search query
          example: "smartphone"
        limit:
          type: integer
          description: Maximum number of results
          default: 20
          minimum: 1
          maximum: 100
        offset:
          type: integer
          description: Number of results to skip
          default: 0
          minimum: 0
      required:
        - query

    ListingResults:
      type: array
      items:
        $ref: '#/components/schemas/Listing'

    Listing:
      type: object
      properties:
        title:
          type: string
          description: Product title
        url:
          type: string
          description: Product URL
        price:
          type: string
          description: Product price
        image:
          type: string
          description: Product image URL
        description:
          type: string
          description: Product description
        location:
          type: string
          description: Product location