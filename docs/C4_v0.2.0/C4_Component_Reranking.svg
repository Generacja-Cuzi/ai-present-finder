<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="DESCRIPTION" height="1532px" preserveAspectRatio="none" style="width:3249px;height:1532px;background:#FFFFFF;" version="1.1" viewBox="0 0 3249 1532" width="3249px" zoomAndPan="magnify"><defs/><g><!--cluster reranking--><g class="cluster" data-entity="reranking" data-source-line="1660" data-uid="ent0002" id="cluster_reranking"><rect fill="none" height="1246.51" style="stroke:#444444;stroke-width:1;stroke-dasharray:7,7;" width="2576" x="224.73" y="168.95"/><text fill="#444444" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacing" textLength="263.4531" x="1381.0034" y="186.4188">Reranking Microservice (NestJS)</text><text fill="#444444" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="67.0137" x="1479.2232" y="201.3953">[container]</text></g><!--entity context_handler--><g class="entity" data-entity="context_handler" data-source-line="68" data-uid="ent0003" id="entity_context_handler"><rect fill="#85BBF0" height="135.418" style="stroke:#78A8D8;stroke-width:0.5;" width="260.9688" x="240.24" y="484.1"/><text fill="#000000" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacing" textLength="240.9688" x="250.24" y="509.5688">GiftContextInitializedHandler</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="35.2383" x="326.5007" y="524.5453">[Event</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="3.7969" x="361.739" y="524.5453">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="49.4121" x="365.5359" y="524.5453">Handler]</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="368.5095" y="540.6117">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="70.8066" x="335.3211" y="557.1">Consumes</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="185.8828" x="277.783" y="573.5883">GiftContextInitializedEvent,</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="65.0918" x="329.0457" y="590.0766">delegates</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="394.1375" y="590.0766">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="13.8359" x="398.5671" y="590.0766">to</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="205.7412" x="267.8538" y="606.5648">InitializeGiftContextCommand</text></g><!--entity product_handler--><g class="entity" data-entity="product_handler" data-source-line="68" data-uid="ent0004" id="entity_product_handler"><rect fill="#85BBF0" height="151.9063" style="stroke:#78A8D8;stroke-width:0.5;" width="212.3125" x="1460.57" y="219.95"/><text fill="#000000" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacing" textLength="192.3125" x="1470.57" y="245.4188">ProductFetchedHandler</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="35.2383" x="1522.5026" y="260.3953">[Event</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="3.7969" x="1557.7409" y="260.3953">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="49.4121" x="1561.5378" y="260.3953">Handler]</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="1564.5114" y="276.4617">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="70.8066" x="1531.3229" y="292.95">Consumes</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="145.9746" x="1493.7389" y="309.4383">ProductFetchedEvent,</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="83.9932" x="1497.2424" y="325.9266">orchestrates</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="1581.2355" y="325.9266">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="50.5449" x="1585.6652" y="325.9266">session</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="59.4316" x="1478.3615" y="342.4148">creation,</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="1537.7931" y="342.4148">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="53.0469" x="1542.2228" y="342.4148">product</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="1595.2697" y="342.4148">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="55.3916" x="1599.6994" y="342.4148">storage,</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="25.2314" x="1483.8884" y="358.9031">and</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="1509.1198" y="358.9031">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="76.0703" x="1513.5495" y="358.9031">completion</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="1589.6198" y="358.9031">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="55.5146" x="1594.0495" y="358.9031">tracking</text></g><!--entity create_session--><g class="entity" data-entity="create_session" data-source-line="68" data-uid="ent0005" id="entity_create_session"><rect fill="#85BBF0" height="102.4414" style="stroke:#78A8D8;stroke-width:0.5;" width="202.2598" x="1388.6" y="666.01"/><text fill="#000000" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacing" textLength="180.7031" x="1399.3783" y="691.4788">CreateSessionHandler</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="63.6094" x="1431.3207" y="706.4553">[Command</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="3.7969" x="1494.9301" y="706.4553">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="49.4121" x="1498.727" y="706.4553">Handler]</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="1487.515" y="722.5217">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="51.1191" x="1398.6" y="739.01">Creates</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="1449.7191" y="739.01">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="14.3281" x="1454.1488" y="739.01">or</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="1468.477" y="739.01">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="52.9785" x="1472.9066" y="739.01">ensures</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="1525.8852" y="739.01">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="50.5449" x="1530.3148" y="739.01">session</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39.9424" x="1430.7836" y="755.4983">exists</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="1470.726" y="755.4983">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="19.4756" x="1475.1557" y="755.4983">for</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="1494.6313" y="755.4983">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="49.6152" x="1499.0609" y="755.4983">eventId</text></g><!--entity init_context--><g class="entity" data-entity="init_context" data-source-line="68" data-uid="ent0006" id="entity_init_context"><rect fill="#85BBF0" height="135.418" style="stroke:#78A8D8;stroke-width:0.5;" width="250.3672" x="240.54" y="814.94"/><text fill="#000000" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacing" textLength="230.3672" x="250.54" y="840.4088">InitializeGiftContextHandler</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="63.6094" x="307.3144" y="855.3853">[Command</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="3.7969" x="370.9238" y="855.3853">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="49.4121" x="374.7207" y="855.3853">Handler]</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="363.5087" y="871.4517">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="64.8389" x="277.4238" y="887.94">Initializes</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="342.2627" y="887.94">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="23.1602" x="346.6923" y="887.94">gift</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="369.8525" y="887.94">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="55.7471" x="374.2822" y="887.94">context.</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="430.0293" y="887.94">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="19.5645" x="434.4589" y="887.94">On</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="91.0068" x="285.9072" y="904.4283">regeneration:</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="376.914" y="904.4283">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="32.4912" x="381.3437" y="904.4283">adds</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="413.8349" y="904.4283">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="27.2754" x="418.2646" y="904.4283">new</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="74.5459" x="287.7529" y="920.9166">totalEvents</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="362.2988" y="920.9166">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="13.8359" x="366.7285" y="920.9166">to</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="380.5644" y="920.9166">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="58.7002" x="384.9941" y="920.9166">existing,</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="40.8379" x="286.6728" y="937.4048">resets</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="327.5107" y="937.4048">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="41.166" x="331.9404" y="937.4048">status</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="373.1064" y="937.4048">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="13.8359" x="377.5361" y="937.4048">to</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="391.372" y="937.4048">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="48.9727" x="395.8017" y="937.4048">ACTIVE</text></g><!--entity add_products--><g class="entity" data-entity="add_products" data-source-line="68" data-uid="ent0007" id="entity_add_products"><rect fill="#85BBF0" height="102.4414" style="stroke:#78A8D8;stroke-width:0.5;" width="274.0938" x="1952.68" y="831.43"/><text fill="#000000" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacing" textLength="254.0938" x="1962.68" y="856.8988">AddProductsToSessionHandler</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="63.6094" x="2031.3177" y="871.8753">[Command</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="3.7969" x="2094.9271" y="871.8753">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="49.4121" x="2098.7239" y="871.8753">Handler]</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="2087.512" y="887.9417">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="42.041" x="2000.3299" y="904.43">Stores</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="2042.3709" y="904.43">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="60.1836" x="2046.8006" y="904.43">products</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="2106.9842" y="904.43">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="12.7354" x="2111.4139" y="904.43">in</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="2124.1492" y="904.43">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="50.5449" x="2128.5789" y="904.43">session</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="28.7588" x="1996.0814" y="920.9183">with</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="2024.8402" y="920.9183">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="45.124" x="2029.2698" y="920.9183">source</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="2074.3939" y="920.9183">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="36.7705" x="2078.8236" y="920.9183">event</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="2115.5941" y="920.9183">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.3486" x="2120.0238" y="920.9183">metadata</text></g><!--entity increment_completion--><g class="entity" data-entity="increment_completion" data-source-line="68" data-uid="ent0008" id="entity_increment_completion"><rect fill="#85BBF0" height="118.9297" style="stroke:#78A8D8;stroke-width:0.5;" width="324.9766" x="859.24" y="657.76"/><text fill="#000000" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacing" textLength="304.9766" x="869.24" y="683.2288">IncrementSessionCompletionHandler</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="63.6094" x="963.3191" y="698.2053">[Command</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="3.7969" x="1026.9285" y="698.2053">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="49.4121" x="1030.7254" y="698.2053">Handler]</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="1019.5134" y="714.2717">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="75.3525" x="921.9954" y="730.76">Increments</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="997.3479" y="730.76">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="71.3467" x="1001.7776" y="730.76">completed</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="1073.1243" y="730.76">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="43.9072" x="1077.554" y="730.76">events</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="56.3418" x="933.2815" y="747.2483">counter,</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="989.6233" y="747.2483">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="41.8496" x="994.053" y="747.2483">marks</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="1035.9026" y="747.2483">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="50.5449" x="1040.3323" y="747.2483">session</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="1090.8772" y="747.2483">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="14.8682" x="1095.3069" y="747.2483">as</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="62.5352" x="951.0994" y="763.7366">complete</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="1013.6345" y="763.7366">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="35.9639" x="1018.0642" y="763.7366">when</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="1054.0281" y="763.7366">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="33.8994" x="1058.4578" y="763.7366">done</text></g><!--entity emit_ready--><g class="entity" data-entity="emit_ready" data-source-line="68" data-uid="ent0009" id="entity_emit_ready"><rect fill="#85BBF0" height="151.9063" style="stroke:#78A8D8;stroke-width:0.5;" width="292.2813" x="2249.59" y="475.86"/><text fill="#000000" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacing" textLength="272.2813" x="2259.59" y="501.3288">RerankAndEmitGiftReadyHandler</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="63.6094" x="2337.3214" y="516.3053">[Command</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="3.7969" x="2400.9308" y="516.3053">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="49.4121" x="2404.7277" y="516.3053">Handler]</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="2393.5158" y="532.3717">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="43.9756" x="2323.6764" y="548.86">Scores</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="2367.652" y="548.86">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="28.6494" x="2372.0817" y="548.86">only</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="2400.7311" y="548.86">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="62.624" x="2405.1608" y="548.86">unscored</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="64.6133" x="2331.36" y="565.3483">products,</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="2395.9733" y="565.3483">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39.1426" x="2400.403" y="565.3483">filters</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="2439.5456" y="565.3483">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="16.126" x="2443.9753" y="565.3483">by</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="111.1934" x="2321.5607" y="581.8366">MINIMAL_SCORE</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="2432.7541" y="581.8366">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="32.7168" x="2437.1838" y="581.8366">(env:</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47.4619" x="2328.7658" y="598.3248">default</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="2376.2277" y="598.3248">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="17.835" x="2380.6574" y="598.3248">7),</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="2398.4923" y="598.3248">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="46.1494" x="2402.922" y="598.3248">checks</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="2449.0714" y="598.3248">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="9.1943" x="2453.5011" y="598.3248">if</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="86.5771" x="2325.3717" y="614.8131">regeneration</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="2411.9489" y="614.8131">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="49.7109" x="2416.3786" y="614.8131">needed</text></g><!--entity check_regenerate--><g class="entity" data-entity="check_regenerate" data-source-line="68" data-uid="ent0010" id="entity_check_regenerate"><rect fill="#85BBF0" height="151.9063" style="stroke:#78A8D8;stroke-width:0.5;" width="407.625" x="925.91" y="806.69"/><text fill="#000000" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacing" textLength="387.625" x="935.91" y="832.1588">CheckAndPrepareRegenerateIdeasLoopHandler</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="63.6094" x="1071.3133" y="847.1353">[Command</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="3.7969" x="1134.9227" y="847.1353">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="49.4121" x="1138.7196" y="847.1353">Handler]</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="1127.5077" y="863.2017">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="48.665" x="1038.9071" y="879.69">Checks</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="1087.5721" y="879.69">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="9.1943" x="1092.0018" y="879.69">if</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="1101.1961" y="879.69">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="34.7402" x="1105.6258" y="879.69">good</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="1140.3661" y="879.69">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="60.1836" x="1144.7957" y="879.69">products</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="1204.9793" y="879.69">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="11.1289" x="1209.409" y="879.69">&lt;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="122.958" x="1053.4129" y="896.1783">TOP_BEST_COUNT</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="1176.3709" y="896.1783">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="25.2314" x="1180.8006" y="896.1783">and</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="70.957" x="1086.4647" y="912.6666">loopCount</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="1157.4217" y="912.6666">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="11.1289" x="1161.8514" y="912.6666">&lt;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="125.1729" x="1035.1473" y="929.1548">MAX_IDEAS_LOOP,</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="1160.3202" y="929.1548">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="59.5479" x="1164.7498" y="929.1548">prepares</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="181.7129" x="1038.8661" y="945.6431">RegenerateIdeasLoopEvent</text></g><!--entity mark_timeout--><g class="entity" data-entity="mark_timeout" data-source-line="68" data-uid="ent0011" id="entity_mark_timeout"><rect fill="#85BBF0" height="118.9297" style="stroke:#78A8D8;stroke-width:0.5;" width="266.1094" x="1368.67" y="823.18"/><text fill="#000000" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacing" textLength="246.1094" x="1378.67" y="848.6488">MarkTimeoutSessionsHandler</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="63.6094" x="1443.3155" y="863.6253">[Command</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="3.7969" x="1506.9249" y="863.6253">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="49.4121" x="1510.7218" y="863.6253">Handler]</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="1499.5098" y="879.6917">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="40.8379" x="1412.4029" y="896.18">Marks</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="1453.2408" y="896.18">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="51.9668" x="1457.6705" y="896.18">inactive</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="1509.6373" y="896.18">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="57.6816" x="1514.067" y="896.18">sessions</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="1571.7486" y="896.18">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="14.8682" x="1576.1783" y="896.18">as</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="38.9648" x="1435.546" y="912.6683">timed</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="1474.5108" y="912.6683">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="22.5244" x="1478.9405" y="912.6683">out</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="1501.4649" y="912.6683">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="40.291" x="1505.8946" y="912.6683">based</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="1546.1856" y="912.6683">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="17.2881" x="1550.6153" y="912.6683">on</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="139.084" x="1432.1827" y="929.1566">EVENT_TIMEOUT_MS</text></g><!--entity get_session_products--><g class="entity" data-entity="get_session_products" data-source-line="68" data-uid="ent0012" id="entity_get_session_products"><rect fill="#85BBF0" height="135.418" style="stroke:#78A8D8;stroke-width:0.5;" width="247.6406" x="1669.91" y="814.94"/><text fill="#000000" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacing" textLength="227.6406" x="1679.91" y="840.4088">GetSessionProductsHandler</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="38.5371" x="1747.8573" y="855.3853">[Query</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="3.7969" x="1786.3944" y="855.3853">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="49.4121" x="1790.1913" y="855.3853">Handler]</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="1791.5155" y="871.4517">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="54.5029" x="1766.4788" y="887.94">Handles</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="178.0488" x="1704.7059" y="904.4283">GetSessionProductsQuery,</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="58.5225" x="1712.0238" y="920.9166">retrieves</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="1770.5462" y="920.9166">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="50.5449" x="1774.9759" y="920.9166">session</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="1825.5208" y="920.9166">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="25.2314" x="1829.9505" y="920.9166">and</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="1855.182" y="920.9166">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="15.8252" x="1859.6117" y="920.9166">all</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="60.1836" x="1763.6385" y="937.4048">products</text></g><!--entity score_products--><g class="entity" data-entity="score_products" data-source-line="68" data-uid="ent0013" id="entity_score_products"><rect fill="#85BBF0" height="135.418" style="stroke:#78A8D8;stroke-width:0.5;" width="219.7188" x="2564.87" y="814.94"/><text fill="#000000" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacing" textLength="181.8359" x="2583.8114" y="840.4088">ScoreProductsHandler</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="38.5371" x="2628.8563" y="855.3853">[Query</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="3.7969" x="2667.3934" y="855.3853">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="49.4121" x="2671.1903" y="855.3853">Handler]</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="2672.5145" y="871.4517">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="54.5029" x="2574.87" y="887.94">Handles</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="2629.3729" y="887.94">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="140.7861" x="2633.8026" y="887.94">ScoreProductsQuery,</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="52.5752" x="2589.4066" y="904.4283">batches</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="2641.9818" y="904.4283">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="60.1836" x="2646.4115" y="904.4283">products</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="2706.5951" y="904.4283">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="22.2578" x="2711.0248" y="904.4283">(50</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="2733.2826" y="904.4283">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="22.3398" x="2737.7123" y="904.4283">per</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="46.6211" x="2619.307" y="920.9166">batch),</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="2665.9281" y="920.9166">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="25.2314" x="2670.3578" y="920.9166">and</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="2695.5892" y="920.9166">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="30.1328" x="2700.0189" y="920.9166">calls</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="126.4854" x="2611.4867" y="937.4048">scoreProductsFlow</text></g><!--entity update_ratings--><g class="entity" data-entity="update_ratings" data-source-line="68" data-uid="ent0014" id="entity_update_ratings"><rect fill="#85BBF0" height="135.418" style="stroke:#78A8D8;stroke-width:0.5;" width="268.7578" x="2261.35" y="814.94"/><text fill="#000000" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacing" textLength="248.7578" x="2271.35" y="840.4088">UpdateProductRatingsHandler</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="63.6094" x="2337.3197" y="855.3853">[Command</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="3.7969" x="2400.9291" y="855.3853">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="49.4121" x="2404.726" y="855.3853">Handler]</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="2393.5141" y="871.4517">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="54.5029" x="2368.4774" y="887.94">Handles</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="224.5742" x="2283.4418" y="904.4283">UpdateProductRatingsCommand,</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="54.2158" x="2319.7201" y="920.9166">updates</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="2373.9359" y="920.9166">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="60.1836" x="2378.3656" y="920.9166">products</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="2438.5492" y="920.9166">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="28.7588" x="2442.9789" y="920.9166">with</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="43.5723" x="2323.3227" y="937.4048">scores</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="2366.8949" y="937.4048">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="25.2314" x="2371.3246" y="937.4048">and</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="2396.5561" y="937.4048">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="67.1494" x="2400.9857" y="937.4048">reasoning</text></g><!--entity ranking_service--><g class="entity" data-entity="ranking_service" data-source-line="68" data-uid="ent0015" id="entity_ranking_service"><rect fill="#85BBF0" height="151.9063" style="stroke:#78A8D8;stroke-width:0.5;" width="199.2588" x="2551.1" y="1062.6"/><text fill="#000000" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacing" textLength="155.3047" x="2573.0771" y="1088.0688">scoreProductsFlow</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="15.6387" x="2618.7753" y="1103.0453">[AI</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="3.7969" x="2634.414" y="1103.0453">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="44.4727" x="2638.2108" y="1103.0453">Service]</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="2648.5146" y="1119.1117">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="31.7734" x="2582.5819" y="1135.6">Uses</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="2614.3554" y="1135.6">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47.8926" x="2618.7851" y="1135.6">Google</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="2666.6776" y="1135.6">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47.7695" x="2671.1073" y="1135.6">Gemini</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="155.8047" x="2561.1" y="1152.0883">(gemini-2.5-flash-lite)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="2716.9047" y="1152.0883">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="19.0244" x="2721.3344" y="1152.0883">via</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="44.0098" x="2566.8524" y="1168.5766">ai-sdk</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="2610.8622" y="1168.5766">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="13.8359" x="2615.2919" y="1168.5766">to</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="2629.1278" y="1168.5766">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="36.4355" x="2633.5575" y="1168.5766">score</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="2669.9931" y="1168.5766">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="60.1836" x="2674.4228" y="1168.5766">products</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="40.291" x="2563.6977" y="1185.0648">based</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="2603.9887" y="1185.0648">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="17.2881" x="2608.4184" y="1185.0648">on</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="2625.7064" y="1185.0648">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="29.3535" x="2630.1361" y="1185.0648">user</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="2659.4896" y="1185.0648">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="44.1807" x="2663.9193" y="1185.0648">profile</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="2708.1" y="1185.0648">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="25.2314" x="2712.5297" y="1185.0648">and</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="64.3604" x="2618.5492" y="1201.5531">keywords</text></g><!--entity gift_session_repo--><g class="entity" data-entity="gift_session_repo" data-source-line="68" data-uid="ent0016" id="entity_gift_session_repo"><rect fill="#85BBF0" height="151.9063" style="stroke:#78A8D8;stroke-width:0.5;" width="209.0547" x="1025.2" y="1062.6"/><text fill="#000000" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacing" textLength="181.5781" x="1038.9383" y="1088.0688">GiftSessionRepository</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="59.2441" x="1065.3445" y="1103.0453">[TypeORM</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="3.7969" x="1124.5887" y="1103.0453">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="65.7246" x="1128.3855" y="1103.0453">Repository]</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="1127.5125" y="1119.1117">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="38.7256" x="1060.0076" y="1135.6">CRUD</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="1098.7332" y="1135.6">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="72.3789" x="1103.1629" y="1135.6">operations</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="1175.5418" y="1135.6">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="19.4756" x="1179.9715" y="1135.6">for</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="75.4961" x="1035.2" y="1152.0883">GiftSession</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="1110.6961" y="1152.0883">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="58.5977" x="1115.1258" y="1152.0883">(eventId,</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="1173.7234" y="1152.0883">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="46.1016" x="1178.1531" y="1152.0883">chatId,</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="45.5957" x="1044.9788" y="1168.5766">status,</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="1090.5745" y="1168.5766">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="119.4717" x="1095.0042" y="1168.5766">completedEvents,</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="78.9756" x="1050.3313" y="1185.0648">totalEvents,</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="1129.3069" y="1185.0648">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="75.3867" x="1133.7366" y="1185.0648">loopCount,</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="81.5459" x="1088.9544" y="1201.5531">giftContext)</text></g><!--entity session_product_repo--><g class="entity" data-entity="session_product_repo" data-source-line="68" data-uid="ent0017" id="entity_session_product_repo"><rect fill="#85BBF0" height="135.418" style="stroke:#78A8D8;stroke-width:0.5;" width="264.9922" x="1693.23" y="1070.84"/><text fill="#000000" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacing" textLength="244.9922" x="1703.23" y="1096.3088">GiftSessionProductRepository</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="59.2441" x="1761.3433" y="1111.2853">[TypeORM</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="3.7969" x="1820.5874" y="1111.2853">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="65.7246" x="1824.3843" y="1111.2853">Repository]</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="1823.5113" y="1127.3517">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="38.7256" x="1756.0064" y="1143.84">CRUD</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="1794.732" y="1143.84">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="72.3789" x="1799.1616" y="1143.84">operations</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="1871.5405" y="1143.84">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="19.4756" x="1875.9702" y="1143.84">for</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="127.4697" x="1744.7031" y="1160.3283">GiftSessionProduct</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="1872.1729" y="1160.3283">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="30.1465" x="1876.6026" y="1160.3283">(join</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="33.626" x="1746.9419" y="1176.8166">table</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="1780.5679" y="1176.8166">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="28.7588" x="1784.9976" y="1176.8166">with</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="1813.7564" y="1176.8166">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="45.124" x="1818.1861" y="1176.8166">source</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="1863.3101" y="1176.8166">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="36.7705" x="1867.7398" y="1176.8166">event</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="67.9014" x="1791.7754" y="1193.3048">metadata)</text></g><!--entity product_repo--><g class="entity" data-entity="product_repo" data-source-line="68" data-uid="ent0018" id="entity_product_repo"><rect fill="#85BBF0" height="118.9297" style="stroke:#78A8D8;stroke-width:0.5;" width="215.8428" x="2025.81" y="1079.09"/><text fill="#000000" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacing" textLength="152.2031" x="2057.6298" y="1104.5588">ProductRepository</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="59.2441" x="2069.3486" y="1119.5353">[TypeORM</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="3.7969" x="2128.5927" y="1119.5353">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="65.7246" x="2132.3896" y="1119.5353">Repository]</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="2131.5165" y="1135.6017">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="38.7256" x="2035.81" y="1152.09">CRUD</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="2074.5356" y="1152.09">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="72.3789" x="2078.9653" y="1152.09">operations</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="2151.3442" y="1152.09">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="19.4756" x="2155.7739" y="1152.09">for</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="2175.2495" y="1152.09">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="51.9736" x="2179.6791" y="1152.09">Product</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="50.3604" x="2048.4702" y="1168.5783">(image,</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="2098.8305" y="1168.5783">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="30.7959" x="2103.2602" y="1168.5783">title,</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="2134.0561" y="1168.5783">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="80.5068" x="2138.4858" y="1168.5783">description,</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="37.9873" x="2052.1616" y="1185.0666">price,</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="2090.1489" y="1185.0666">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="44.5908" x="2094.5786" y="1185.0666">rating,</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="2139.1694" y="1185.0666">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="71.7021" x="2143.5991" y="1185.0666">reasoning)</text></g><!--entity database--><g class="entity" data-entity="database" data-source-line="72" data-uid="ent0019" id="entity_database"><path d="M1724.03,1314.51 C1724.03,1304.51 1825.7307,1304.51 1825.7307,1304.51 C1825.7307,1304.51 1927.4314,1304.51 1927.4314,1314.51 L1927.4314,1389.4631 C1927.4314,1399.4631 1825.7307,1399.4631 1825.7307,1399.4631 C1825.7307,1399.4631 1724.03,1399.4631 1724.03,1389.4631 L1724.03,1314.51" fill="#85BBF0" style="stroke:#78A8D8;stroke-width:0.5;"/><path d="M1724.03,1314.51 C1724.03,1324.51 1825.7307,1324.51 1825.7307,1324.51 C1825.7307,1324.51 1927.4314,1324.51 1927.4314,1314.51" fill="none" style="stroke:#78A8D8;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacing" textLength="94.3906" x="1778.5354" y="1343.9788">PostgreSQL</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="61.5176" x="1794.9719" y="1358.9553">[Database]</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="1823.5158" y="1375.0217">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="64.5654" x="1734.03" y="1391.51">TypeORM</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="1798.5954" y="1391.51">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="77.3555" x="1803.0251" y="1391.51">persistence</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="1880.3806" y="1391.51">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="32.6211" x="1884.8103" y="1391.51">layer</text></g><!--entity rabbitmq_in_context--><g class="entity" data-entity="rabbitmq_in_context" data-source-line="80" data-uid="ent0020" id="entity_rabbitmq_in_context"><rect fill="#CCCCCC" height="102.4414" style="stroke:#BFBFBF;stroke-width:0.5;" width="201.4531" x="7" y="244.68"/><text fill="#000000" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacing" textLength="81.0391" x="67.207" y="270.1488">RabbitMQ</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="53.9531" x="58.0039" y="285.1253">[Message</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="3.7969" x="111.957" y="285.1253">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="41.6953" x="115.7539" y="285.1253">Broker]</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="105.5117" y="301.1917">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="181.4531" x="17" y="317.68">GiftContextInitializedEvent</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="41.7881" x="86.8325" y="334.1683">queue</text></g><!--entity rabbitmq_in_product--><g class="entity" data-entity="rabbitmq_in_product" data-source-line="80" data-uid="ent0021" id="entity_rabbitmq_in_product"><rect fill="#CCCCCC" height="85.9531" style="stroke:#BFBFBF;stroke-width:0.5;" width="207.7627" x="1462.85" y="7"/><text fill="#000000" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacing" textLength="81.0391" x="1526.2118" y="32.4688">RabbitMQ</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="53.9531" x="1517.0087" y="47.4453">[Message</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="3.7969" x="1570.9618" y="47.4453">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="41.6953" x="1574.7587" y="47.4453">Broker]</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="1564.5165" y="63.5117">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="141.5449" x="1472.85" y="80">ProductFetchedEvent</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="1614.3949" y="80">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="41.7881" x="1618.8246" y="80">queue</text></g><!--entity rabbitmq_out_ready--><g class="entity" data-entity="rabbitmq_out_ready" data-source-line="80" data-uid="ent0022" id="entity_rabbitmq_out_ready"><rect fill="#CCCCCC" height="85.9531" style="stroke:#BFBFBF;stroke-width:0.5;" width="167.834" x="2819.81" y="839.67"/><text fill="#000000" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacing" textLength="81.0391" x="2863.2075" y="865.1388">RabbitMQ</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="53.9531" x="2854.0043" y="880.1153">[Message</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="3.7969" x="2907.9575" y="880.1153">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="41.6953" x="2911.7543" y="880.1153">Broker]</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="2901.5121" y="896.1817">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="101.6162" x="2829.81" y="912.67">GiftReadyEvent</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="2931.4262" y="912.67">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="41.7881" x="2935.8559" y="912.67">queue</text></g><!--entity rabbitmq_out_regenerate--><g class="entity" data-entity="rabbitmq_out_regenerate" data-source-line="80" data-uid="ent0023" id="entity_rabbitmq_out_regenerate"><rect fill="#CCCCCC" height="102.4414" style="stroke:#BFBFBF;stroke-width:0.5;" width="201.7129" x="3022.87" y="831.43"/><text fill="#000000" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacing" textLength="81.0391" x="3083.2069" y="856.8988">RabbitMQ</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="53.9531" x="3074.0038" y="871.8753">[Message</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="3.7969" x="3127.9569" y="871.8753">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="41.6953" x="3131.7538" y="871.8753">Broker]</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="3121.5116" y="887.9417">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="181.7129" x="3032.87" y="904.43">RegenerateIdeasLoopEvent</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="41.7881" x="3102.8324" y="920.9183">queue</text></g><!--link rabbitmq_in_context to context_handler--><g class="link" data-entity-1="rabbitmq_in_context" data-entity-2="context_handler" data-source-line="1773" data-uid="lnk24" id="link_rabbitmq_in_context_context_handler"><path d="M160,347.37 C200.6,386.57 251.4941,435.704 295.8441,478.514" fill="none" id="rabbitmq_in_context-to-context_handler" style="stroke:#666666;stroke-width:1;"/><polygon fill="#666666" points="301.6,484.07,297.9276,476.3555,293.7606,480.6724,301.6,484.07" style="stroke:#666666;stroke-width:1;"/><text fill="#666666" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="64.2129" x="288.4075" y="421.4616">Consumes</text><text fill="#666666" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="38.4727" x="255.97" y="435.5944">[AMQP</text><text fill="#666666" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="3.7969" x="294.4427" y="435.5944">&#160;</text><text fill="#666666" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="86.8184" x="298.2395" y="435.5944">@EventPattern]</text></g><!--link context_handler to init_context--><g class="link" data-entity-1="context_handler" data-entity-2="init_context" data-source-line="1773" data-uid="lnk25" id="link_context_handler_init_context"><path d="M369.71,619.75 C368.84,676.56 367.731,749.6609 366.871,806.5209" fill="none" id="context_handler-to-init_context" style="stroke:#666666;stroke-width:1;"/><polygon fill="#666666" points="366.75,814.52,369.8706,806.5663,363.8713,806.4755,366.75,814.52" style="stroke:#666666;stroke-width:1;"/><text fill="#666666" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="54.2754" x="386.9616" y="714.8316">Executes</text><text fill="#666666" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="87.9785" x="370.11" y="728.9644">[CommandBus]</text></g><!--link rabbitmq_in_product to product_handler--><g class="link" data-entity-1="rabbitmq_in_product" data-entity-2="product_handler" data-source-line="1773" data-uid="lnk26" id="link_rabbitmq_in_product_product_handler"><path d="M1566.73,93.19 C1566.73,127.96 1566.73,170.13 1566.73,211.74" fill="none" id="rabbitmq_in_product-to-product_handler" style="stroke:#666666;stroke-width:1;"/><polygon fill="#666666" points="1566.73,219.74,1569.73,211.74,1563.73,211.74,1566.73,219.74" style="stroke:#666666;stroke-width:1;"/><text fill="#666666" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="64.2129" x="1600.1675" y="135.5516">Consumes</text><text fill="#666666" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="38.4727" x="1567.73" y="149.6844">[AMQP</text><text fill="#666666" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="3.7969" x="1606.2027" y="149.6844">&#160;</text><text fill="#666666" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="86.8184" x="1609.9995" y="149.6844">@EventPattern]</text></g><!--link product_handler to create_session--><g class="link" data-entity-1="product_handler" data-entity-2="create_session" data-source-line="1773" data-uid="lnk27" id="link_product_handler_create_session"><path d="M1520.84,372.35 C1516.44,382.02 1512.57,392 1509.73,401.86 C1483.76,491.98 1483.2642,594.4475 1485.9942,657.5475" fill="none" id="product_handler-to-create_session" style="stroke:#666666;stroke-width:1;"/><polygon fill="#666666" points="1486.34,665.54,1488.9914,657.4178,1482.997,657.6771,1486.34,665.54" style="stroke:#666666;stroke-width:1;"/><text fill="#666666" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="10.8809" x="1510.73" y="421.4616">1.</text><text fill="#666666" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="3.9551" x="1521.6109" y="421.4616">&#160;</text><text fill="#666666" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="46.7695" x="1525.5659" y="421.4616">Creates</text><text fill="#666666" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="3.9551" x="1572.3355" y="421.4616">&#160;</text><text fill="#666666" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="46.834" x="1576.2905" y="421.4616">session</text><text fill="#666666" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="87.9785" x="1522.938" y="435.5944">[CommandBus]</text></g><!--link product_handler to add_products--><g class="link" data-entity-1="product_handler" data-entity-2="add_products" data-source-line="1773" data-uid="lnk28" id="link_product_handler_add_products"><path d="M1616.35,372.31 C1620.93,381.95 1624.91,391.92 1627.73,401.86 C1650.48,482.02 1581.03,715.63 1637.73,776.69 C1682.87,825.3 1870.89,788.65 1934.73,806.69 C1956.01,812.71 1970.6832,818.1427 1991.1132,827.6227" fill="none" id="product_handler-to-add_products" style="stroke:#666666;stroke-width:1;"/><polygon fill="#666666" points="1998.37,830.99,1992.3759,824.9014,1989.8505,830.344,1998.37,830.99" style="stroke:#666666;stroke-width:1;"/><text fill="#666666" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="10.8809" x="1632.37" y="549.4116">2.</text><text fill="#666666" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="3.9551" x="1643.2509" y="549.4116">&#160;</text><text fill="#666666" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="31.5234" x="1647.2059" y="549.4116">Adds</text><text fill="#666666" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="3.9551" x="1678.7294" y="549.4116">&#160;</text><text fill="#666666" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="54.9375" x="1682.6845" y="549.4116">products</text><text fill="#666666" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="87.9785" x="1641.0067" y="563.5444">[CommandBus]</text></g><!--link product_handler to increment_completion--><g class="link" data-entity-1="product_handler" data-entity-2="increment_completion" data-source-line="1773" data-uid="lnk29" id="link_product_handler_increment_completion"><path d="M1460.26,342.35 C1425.69,359.04 1387.96,379.41 1355.73,401.86 C1245.95,478.32 1141.8321,583.9277 1079.5021,651.5477" fill="none" id="product_handler-to-increment_completion" style="stroke:#666666;stroke-width:1;"/><polygon fill="#666666" points="1074.08,657.43,1081.7079,653.581,1077.2962,649.5145,1074.08,657.43" style="stroke:#666666;stroke-width:1;"/><text fill="#666666" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="10.8809" x="1356.73" y="421.4616">3.</text><text fill="#666666" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="3.9551" x="1367.6109" y="421.4616">&#160;</text><text fill="#666666" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="68.9297" x="1371.5659" y="421.4616">Increments</text><text fill="#666666" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="3.9551" x="1440.4956" y="421.4616">&#160;</text><text fill="#666666" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="47.1621" x="1444.4507" y="421.4616">counter</text><text fill="#666666" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="87.9785" x="1380.1821" y="435.5944">[CommandBus]</text></g><!--link product_handler to emit_ready--><g class="link" data-entity-1="product_handler" data-entity-2="emit_ready" data-source-line="1773" data-uid="lnk30" id="link_product_handler_emit_ready"><path d="M1672.98,329.45 C1819.46,374.31 2076.3307,452.9874 2241.5207,503.5774" fill="none" id="product_handler-to-emit_ready" style="stroke:#666666;stroke-width:1;"/><polygon fill="#666666" points="2249.17,505.92,2242.3992,500.7089,2240.6422,506.4459,2249.17,505.92" style="stroke:#666666;stroke-width:1;"/><text fill="#666666" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="10.8809" x="2031.86" y="414.4616">4.</text><text fill="#666666" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="3.9551" x="2042.7409" y="414.4616">&#160;</text><text fill="#666666" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="34.3945" x="2046.6959" y="414.4616">Emits</text><text fill="#666666" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="3.9551" x="2081.0905" y="414.4616">&#160;</text><text fill="#666666" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="33.1465" x="2085.0455" y="414.4616">when</text><text fill="#666666" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="3.9551" x="2118.192" y="414.4616">&#160;</text><text fill="#666666" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="56.4668" x="2122.1471" y="414.4616">complete</text><text fill="#666666" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="84.0762" x="2063.1989" y="428.5944">[CommandBus</text><text fill="#666666" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="76.5645" x="2066.9547" y="442.7272">(conditional)]</text></g><!--link create_session to gift_session_repo--><g class="link" data-entity-1="create_session" data-entity-2="gift_session_repo" data-source-line="1773" data-uid="lnk31" id="link_create_session_gift_session_repo"><path d="M1388.31,742.16 C1333.38,754.27 1264.16,768.18 1201.73,776.69 C1155.04,783.06 810.84,772.22 778.73,806.69 C732.71,856.09 743.46,901.03 778.73,958.6 C831.97,1045.51 934.446,1089.6786 1017.236,1113.2586" fill="none" id="create_session-to-gift_session_repo" style="stroke:#666666;stroke-width:1;"/><polygon fill="#666666" points="1024.93,1115.45,1018.0578,1110.3734,1016.4142,1116.1439,1024.93,1115.45" style="stroke:#666666;stroke-width:1;"/><text fill="#666666" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="87.832" x="800.1968" y="880.2516">Creates/reads</text><text fill="#666666" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="59.2441" x="779.73" y="894.3844">[TypeORM</text><text fill="#666666" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="3.7969" x="838.9741" y="894.3844">&#160;</text><text fill="#666666" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="65.7246" x="842.771" y="894.3844">Repository]</text></g><!--link gift_session_repo to database--><g class="link" data-entity-1="gift_session_repo" data-entity-2="database" data-source-line="1773" data-uid="lnk32" id="link_gift_session_repo_database"><path d="M1234.68,1171.44 C1366.93,1211.61 1585.0553,1277.8749 1715.9553,1317.6349" fill="none" id="gift_session_repo-to-database" style="stroke:#666666;stroke-width:1;"/><polygon fill="#666666" points="1723.61,1319.96,1716.8272,1314.7644,1715.0834,1320.5054,1723.61,1319.96" style="stroke:#666666;stroke-width:1;"/><text fill="#666666" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="48.9668" x="1568.6198" y="1257.1116">Persists</text><text fill="#666666" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="63.1465" x="1561.53" y="1271.2444">[TypeORM]</text></g><!--link init_context to gift_session_repo--><g class="link" data-entity-1="init_context" data-entity-2="gift_session_repo" data-source-line="1773" data-uid="lnk33" id="link_init_context_gift_session_repo"><path d="M375.28,950.51 C382.95,980 396.79,1012.47 421.73,1032.6 C512.49,1105.87 842.9459,1127.814 1016.9559,1134.474" fill="none" id="init_context-to-gift_session_repo" style="stroke:#666666;stroke-width:1;"/><polygon fill="#666666" points="1024.95,1134.78,1017.0706,1131.4762,1016.8411,1137.4718,1024.95,1134.78" style="stroke:#666666;stroke-width:1;"/><text fill="#666666" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="103.0723" x="435.5767" y="1001.2016">Creates/updates</text><text fill="#666666" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="45.7793" x="464.2232" y="1015.3344">context</text><text fill="#666666" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="59.2441" x="422.73" y="1029.4672">[TypeORM</text><text fill="#666666" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="3.7969" x="481.9741" y="1029.4672">&#160;</text><text fill="#666666" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="65.7246" x="485.771" y="1029.4672">Repository]</text></g><!--link add_products to session_product_repo--><g class="link" data-entity-1="add_products" data-entity-2="session_product_repo" data-source-line="1773" data-uid="lnk34" id="link_add_products_session_product_repo"><path d="M2030.52,934.29 C2011.18,951.25 1989.78,970.46 1970.73,988.6 C1943.28,1014.73 1919.5095,1038.7178 1894.4595,1064.7278" fill="none" id="add_products-to-session_product_repo" style="stroke:#666666;stroke-width:1;"/><polygon fill="#666666" points="1888.91,1070.49,1896.6203,1066.8089,1892.2987,1062.6467,1888.91,1070.49" style="stroke:#666666;stroke-width:1;"/><text fill="#666666" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="46.7695" x="2012.728" y="1008.2016">Creates</text><text fill="#666666" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="59.2441" x="1971.73" y="1022.3344">[TypeORM</text><text fill="#666666" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="3.7969" x="2030.9741" y="1022.3344">&#160;</text><text fill="#666666" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="65.7246" x="2034.771" y="1022.3344">Repository]</text></g><!--link add_products to product_repo--><g class="link" data-entity-1="add_products" data-entity-2="product_repo" data-source-line="1773" data-uid="lnk35" id="link_add_products_product_repo"><path d="M2098.47,934.11 C2105.69,975.77 2114.5738,1027.0475 2122.1638,1070.8375" fill="none" id="add_products-to-product_repo" style="stroke:#666666;stroke-width:1;"/><polygon fill="#666666" points="2123.53,1078.72,2125.1197,1070.3252,2119.2078,1071.3499,2123.53,1078.72" style="stroke:#666666;stroke-width:1;"/><text fill="#666666" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="46.7695" x="2156.358" y="1008.2016">Creates</text><text fill="#666666" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="59.2441" x="2115.36" y="1022.3344">[TypeORM</text><text fill="#666666" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="3.7969" x="2174.6041" y="1022.3344">&#160;</text><text fill="#666666" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="65.7246" x="2178.401" y="1022.3344">Repository]</text></g><!--link session_product_repo to database--><g class="link" data-entity-1="session_product_repo" data-entity-2="database" data-source-line="1773" data-uid="lnk36" id="link_session_product_repo_database"><path d="M1825.73,1206.74 C1825.73,1238.42 1825.73,1267.45 1825.73,1296.06" fill="none" id="session_product_repo-to-database" style="stroke:#666666;stroke-width:1;"/><polygon fill="#666666" points="1825.73,1304.06,1828.73,1296.06,1822.73,1296.06,1825.73,1304.06" style="stroke:#666666;stroke-width:1;"/><text fill="#666666" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="48.9668" x="1833.8198" y="1257.1116">Persists</text><text fill="#666666" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="63.1465" x="1826.73" y="1271.2444">[TypeORM]</text></g><!--link product_repo to database--><g class="link" data-entity-1="product_repo" data-entity-2="database" data-source-line="1773" data-uid="lnk37" id="link_product_repo_database"><path d="M2047.93,1198.45 C1999.34,1231.81 1945.9856,1268.4326 1900.6056,1299.5826" fill="none" id="product_repo-to-database" style="stroke:#666666;stroke-width:1;"/><polygon fill="#666666" points="1894.01,1304.11,1902.3034,1302.0559,1898.9079,1297.1092,1894.01,1304.11" style="stroke:#666666;stroke-width:1;"/><text fill="#666666" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="48.9668" x="1987.8198" y="1257.1116">Persists</text><text fill="#666666" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="63.1465" x="1980.73" y="1271.2444">[TypeORM]</text></g><!--link increment_completion to gift_session_repo--><g class="link" data-entity-1="increment_completion" data-entity-2="gift_session_repo" data-source-line="1773" data-uid="lnk38" id="link_increment_completion_gift_session_repo"><path d="M859.01,730.26 C750.65,742.05 622.08,764.63 587.73,806.69 C545.02,858.98 551.1,901.89 587.73,958.6 C635.81,1033.05 873.4685,1089.2959 1017.0285,1117.3459" fill="none" id="increment_completion-to-gift_session_repo" style="stroke:#666666;stroke-width:1;"/><polygon fill="#666666" points="1024.88,1118.88,1017.6038,1114.4016,1016.4532,1120.2902,1024.88,1118.88" style="stroke:#666666;stroke-width:1;"/><text fill="#666666" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="50.4727" x="591.4575" y="873.2516">Updates</text><text fill="#666666" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="3.9551" x="641.9302" y="873.2516">&#160;</text><text fill="#666666" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="68.8828" x="645.8853" y="873.2516">completion</text><text fill="#666666" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="34.6758" x="635.7749" y="887.3844">count</text><text fill="#666666" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="59.2441" x="588.73" y="901.5172">[TypeORM</text><text fill="#666666" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="3.7969" x="647.9741" y="901.5172">&#160;</text><text fill="#666666" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="65.7246" x="651.771" y="901.5172">Repository]</text></g><!--link emit_ready to get_session_products--><g class="link" data-entity-1="emit_ready" data-entity-2="get_session_products" data-source-line="1773" data-uid="lnk39" id="link_emit_ready_get_session_products"><path d="M2271.95,628.09 C2180.45,683.18 2063.31,752.38 2012.73,776.69 C1979.25,792.79 1968.52,791.28 1934.73,806.69 C1929.18,809.23 1930.748,808.3995 1925.078,811.1295" fill="none" id="emit_ready-to-get_session_products" style="stroke:#666666;stroke-width:1;"/><polygon fill="#666666" points="1917.87,814.6,1926.3795,813.8325,1923.7766,808.4265,1917.87,814.6" style="stroke:#666666;stroke-width:1;"/><text fill="#666666" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="54.2754" x="2270.5822" y="707.8316">Executes</text><text fill="#666666" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="159.3398" x="2218.05" y="721.9644">GetSessionProductsQuery</text><text fill="#666666" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="62.9063" x="2266.2668" y="736.0972">[QueryBus]</text></g><!--link get_session_products to gift_session_repo--><g class="link" data-entity-1="get_session_products" data-entity-2="gift_session_repo" data-source-line="1773" data-uid="lnk40" id="link_get_session_products_gift_session_repo"><path d="M1669.49,950.49 C1663.84,953.27 1658.24,955.99 1652.73,958.6 C1575.67,995.1 1555.96,1003.74 1475.73,1032.6 C1395.84,1061.33 1311.4829,1086.8047 1242.4129,1106.5147" fill="none" id="get_session_products-to-gift_session_repo" style="stroke:#666666;stroke-width:1;"/><polygon fill="#666666" points="1234.72,1108.71,1243.2361,1109.3996,1241.5897,1103.6299,1234.72,1108.71" style="stroke:#666666;stroke-width:1;"/><text fill="#666666" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="37.1016" x="1607.7375" y="1008.2016">Reads</text><text fill="#666666" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="3.9551" x="1644.8391" y="1008.2016">&#160;</text><text fill="#666666" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="46.834" x="1648.7941" y="1008.2016">session</text><text fill="#666666" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="59.2441" x="1587.3" y="1022.3344">[TypeORM</text><text fill="#666666" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="3.7969" x="1646.5441" y="1022.3344">&#160;</text><text fill="#666666" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="65.7246" x="1650.341" y="1022.3344">Repository]</text></g><!--link get_session_products to session_product_repo--><g class="link" data-entity-1="get_session_products" data-entity-2="session_product_repo" data-source-line="1773" data-uid="lnk41" id="link_get_session_products_session_product_repo"><path d="M1787.25,950.74 C1786.1,976.49 1786.42,1006.05 1790.73,1032.6 C1792.76,1045.11 1793.7419,1050.4962 1797.5319,1062.9562" fill="none" id="get_session_products-to-session_product_repo" style="stroke:#666666;stroke-width:1;"/><polygon fill="#666666" points="1799.86,1070.61,1800.4021,1062.0832,1794.6618,1063.8293,1799.86,1070.61" style="stroke:#666666;stroke-width:1;"/><text fill="#666666" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="37.1016" x="1792.6382" y="1008.2016">Reads</text><text fill="#666666" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="3.9551" x="1829.7398" y="1008.2016">&#160;</text><text fill="#666666" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="27" x="1833.6948" y="1008.2016">with</text><text fill="#666666" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="3.9551" x="1860.6948" y="1008.2016">&#160;</text><text fill="#666666" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="54.9375" x="1864.6499" y="1008.2016">products</text><text fill="#666666" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="59.2441" x="1791.73" y="1022.3344">[TypeORM</text><text fill="#666666" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="3.7969" x="1850.9741" y="1022.3344">&#160;</text><text fill="#666666" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="65.7246" x="1854.771" y="1022.3344">Repository]</text></g><!--link emit_ready to score_products--><g class="link" data-entity-1="emit_ready" data-entity-2="score_products" data-source-line="1773" data-uid="lnk42" id="link_emit_ready_score_products"><path d="M2542.3,606.52 C2565.95,620.33 2588.33,637.24 2605.73,657.76 C2643.14,701.9 2658.9995,758.2131 2666.8395,806.5631" fill="none" id="emit_ready-to-score_products" style="stroke:#666666;stroke-width:1;"/><polygon fill="#666666" points="2668.12,814.46,2669.8008,806.083,2663.8782,807.0433,2668.12,814.46" style="stroke:#666666;stroke-width:1;"/><text fill="#666666" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="54.2754" x="2695.4555" y="700.8316">Executes</text><text fill="#666666" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="124.9863" x="2660.1" y="714.9644">ScoreProductsQuery</text><text fill="#666666" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="30.8906" x="2674.4291" y="729.0972">(only</text><text fill="#666666" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="3.9551" x="2705.3197" y="729.0972">&#160;</text><text fill="#666666" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="61.4824" x="2709.2748" y="729.0972">unscored)</text><text fill="#666666" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="62.9063" x="2691.14" y="743.23">[QueryBus]</text></g><!--link score_products to ranking_service--><g class="link" data-entity-1="score_products" data-entity-2="ranking_service" data-source-line="1773" data-uid="lnk43" id="link_score_products_ranking_service"><path d="M2668.39,950.69 C2665.14,985.07 2661.9224,1019.0955 2658.5724,1054.5555" fill="none" id="score_products-to-ranking_service" style="stroke:#666666;stroke-width:1;"/><polygon fill="#666666" points="2657.82,1062.52,2661.5591,1054.8376,2655.5857,1054.2733,2657.82,1062.52" style="stroke:#666666;stroke-width:1;"/><text fill="#666666" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="40.1777" x="2673.9051" y="1001.2016">Scores</text><text fill="#666666" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="3.9551" x="2714.0829" y="1001.2016">&#160;</text><text fill="#666666" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="54.9375" x="2718.0379" y="1001.2016">products</text><text fill="#666666" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="3.9551" x="2772.9754" y="1001.2016">&#160;</text><text fill="#666666" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="11.7832" x="2776.9305" y="1001.2016">in</text><text fill="#666666" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="47.9531" x="2707.3329" y="1015.3344">batches</text><text fill="#666666" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="15.6387" x="2665.16" y="1029.4672">[AI</text><text fill="#666666" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="3.7969" x="2680.7987" y="1029.4672">&#160;</text><text fill="#666666" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="16.3066" x="2684.5955" y="1029.4672">via</text><text fill="#666666" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="3.7969" x="2700.9022" y="1029.4672">&#160;</text><text fill="#666666" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="92.7598" x="2704.6991" y="1029.4672">generateObject]</text></g><!--link emit_ready to update_ratings--><g class="link" data-entity-1="emit_ready" data-entity-2="update_ratings" data-source-line="1773" data-uid="lnk44" id="link_emit_ready_update_ratings"><path d="M2395.73,628.25 C2395.73,684.47 2395.73,752.56 2395.73,806.65" fill="none" id="emit_ready-to-update_ratings" style="stroke:#666666;stroke-width:1;"/><polygon fill="#666666" points="2395.73,814.65,2398.73,806.65,2392.73,806.65,2395.73,814.65" style="stroke:#666666;stroke-width:1;"/><text fill="#666666" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="54.2754" x="2469.7437" y="707.8316">Executes</text><text fill="#666666" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="200.3027" x="2396.73" y="721.9644">UpdateProductRatingsCommand</text><text fill="#666666" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="87.9785" x="2452.8921" y="736.0972">[CommandBus]</text></g><!--link update_ratings to product_repo--><g class="link" data-entity-1="update_ratings" data-entity-2="product_repo" data-source-line="1773" data-uid="lnk45" id="link_update_ratings_product_repo"><path d="M2333.52,950.79 C2308.84,976.81 2279.9,1006.55 2252.73,1032.6 C2236.72,1047.95 2225.0015,1058.7189 2208.2515,1073.5389" fill="none" id="update_ratings-to-product_repo" style="stroke:#666666;stroke-width:1;"/><polygon fill="#666666" points="2202.26,1078.84,2210.2394,1075.7857,2206.2636,1071.2921,2202.26,1078.84" style="stroke:#666666;stroke-width:1;"/><text fill="#666666" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="50.4727" x="2337.1965" y="1001.2016">Updates</text><text fill="#666666" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="108.4629" x="2308.2014" y="1015.3344">scores/reasoning</text><text fill="#666666" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="59.2441" x="2298.05" y="1029.4672">[TypeORM</text><text fill="#666666" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="3.7969" x="2357.2941" y="1029.4672">&#160;</text><text fill="#666666" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="65.7246" x="2361.091" y="1029.4672">Repository]</text></g><!--link emit_ready to check_regenerate--><g class="link" data-entity-1="emit_ready" data-entity-2="check_regenerate" data-source-line="1773" data-uid="lnk46" id="link_emit_ready_check_regenerate"><path d="M2249.45,561.9 C2073.15,575.06 1789.26,603.96 1698.73,657.76 C1641.74,691.63 1666.27,743.79 1608.73,776.69 C1508.51,833.99 1463.35,781.35 1350.73,806.69 C1345.19,807.94 1347.3595,807.3232 1341.7395,808.7332" fill="none" id="emit_ready-to-check_regenerate" style="stroke:#666666;stroke-width:1;"/><polygon fill="#666666" points="1333.98,810.68,1342.4696,811.643,1341.0095,805.8234,1333.98,810.68" style="stroke:#666666;stroke-width:1;"/><text fill="#666666" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="54.2754" x="1824.8189" y="707.8316">Executes</text><text fill="#666666" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="304.4531" x="1699.73" y="721.9644">CheckAndPrepareRegenerateIdeasLoopCommand</text><text fill="#666666" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="87.9785" x="1807.9673" y="736.0972">[CommandBus]</text></g><!--link check_regenerate to gift_session_repo--><g class="link" data-entity-1="check_regenerate" data-entity-2="gift_session_repo" data-source-line="1773" data-uid="lnk47" id="link_check_regenerate_gift_session_repo"><path d="M1129.73,958.8 C1129.73,991.41 1129.73,1021.52 1129.73,1054.16" fill="none" id="check_regenerate-to-gift_session_repo" style="stroke:#666666;stroke-width:1;"/><polygon fill="#666666" points="1129.73,1062.16,1132.73,1054.16,1126.73,1054.16,1129.73,1062.16" style="stroke:#666666;stroke-width:1;"/><text fill="#666666" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="93.4043" x="1148.4107" y="1001.2016">Reads/updates</text><text fill="#666666" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="64.0195" x="1163.103" y="1015.3344">loopCount</text><text fill="#666666" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="59.2441" x="1130.73" y="1029.4672">[TypeORM</text><text fill="#666666" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="3.7969" x="1189.9741" y="1029.4672">&#160;</text><text fill="#666666" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="65.7246" x="1193.771" y="1029.4672">Repository]</text></g><!--link emit_ready to rabbitmq_out_ready--><g class="link" data-entity-1="emit_ready" data-entity-2="rabbitmq_out_ready" data-source-line="1773" data-uid="lnk48" id="link_emit_ready_rabbitmq_out_ready"><path d="M2542.16,562.15 C2623.55,574.03 2722.3,600.29 2792.73,657.76 C2850.2,704.67 2878.3289,781.0881 2892.0589,831.7881" fill="none" id="emit_ready-to-rabbitmq_out_ready" style="stroke:#666666;stroke-width:1;"/><polygon fill="#666666" points="2894.15,839.51,2894.9546,831.004,2889.1632,832.5723,2894.15,839.51" style="stroke:#666666;stroke-width:1;"/><text fill="#666666" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="59.4785" x="2880.116" y="707.8316">Publishes</text><text fill="#666666" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="3.9551" x="2939.5945" y="707.8316">&#160;</text><text fill="#666666" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="13.3242" x="2943.5496" y="707.8316">(if</text><text fill="#666666" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="3.9551" x="2956.8738" y="707.8316">&#160;</text><text fill="#666666" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="46.2539" x="2960.8289" y="707.8316">enough</text><text fill="#666666" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="59.3848" x="2913.907" y="721.9644">products)</text><text fill="#666666" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="38.4727" x="2872.49" y="736.0972">[AMQP</text><text fill="#666666" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="3.7969" x="2910.9627" y="736.0972">&#160;</text><text fill="#666666" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="99.9492" x="2914.7595" y="736.0972">ClientProxy.emit]</text></g><!--link emit_ready to rabbitmq_out_regenerate--><g class="link" data-entity-1="emit_ready" data-entity-2="rabbitmq_out_regenerate" data-source-line="1773" data-uid="lnk49" id="link_emit_ready_rabbitmq_out_regenerate"><path d="M2542.01,561.41 C2703.5,573.6 2950.38,601.05 3023.73,657.76 C3078.62,700.21 3102.4469,771.5534 3113.7569,823.4634" fill="none" id="emit_ready-to-rabbitmq_out_regenerate" style="stroke:#666666;stroke-width:1;"/><polygon fill="#666666" points="3115.46,831.28,3116.6882,822.8247,3110.8257,824.102,3115.46,831.28" style="stroke:#666666;stroke-width:1;"/><text fill="#666666" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="59.4785" x="3132.1005" y="707.8316">Publishes</text><text fill="#666666" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="3.9551" x="3191.579" y="707.8316">&#160;</text><text fill="#666666" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="13.3242" x="3195.5341" y="707.8316">(if</text><text fill="#666666" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="79.166" x="3104.2567" y="721.9644">regeneration</text><text fill="#666666" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="3.9551" x="3183.4227" y="721.9644">&#160;</text><text fill="#666666" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="49.3242" x="3187.3778" y="721.9644">needed)</text><text fill="#666666" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="38.4727" x="3099.37" y="736.0972">[AMQP</text><text fill="#666666" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="3.7969" x="3137.8427" y="736.0972">&#160;</text><text fill="#666666" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="99.9492" x="3141.6395" y="736.0972">ClientProxy.emit]</text></g><!--link mark_timeout to gift_session_repo--><g class="link" data-entity-1="mark_timeout" data-entity-2="gift_session_repo" data-source-line="1773" data-uid="lnk50" id="link_mark_timeout_gift_session_repo"><path d="M1415.45,942.54 C1361.47,979.38 1298.1874,1022.5698 1241.0374,1061.5798" fill="none" id="mark_timeout-to-gift_session_repo" style="stroke:#666666;stroke-width:1;"/><polygon fill="#666666" points="1234.43,1066.09,1242.7288,1064.0576,1239.3461,1059.102,1234.43,1066.09" style="stroke:#666666;stroke-width:1;"/><text fill="#666666" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="50.4727" x="1357.0527" y="1008.2016">Updates</text><text fill="#666666" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="3.9551" x="1407.5254" y="1008.2016">&#160;</text><text fill="#666666" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="38.2324" x="1411.4805" y="1008.2016">status</text><text fill="#666666" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="59.2441" x="1339" y="1022.3344">[TypeORM</text><text fill="#666666" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="3.7969" x="1398.2441" y="1022.3344">&#160;</text><text fill="#666666" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="65.7246" x="1402.041" y="1022.3344">Repository]</text></g><g class="legend" data-source-line="1569"><rect fill="none" height="16.4883" style="stroke:none;stroke-width:1;" width="167.2891" x="3051.2997" y="1439.46"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="52.2539" x="3051.2997" y="1452.9952">Legend</text><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="3108.1679" y="1452.9952">&#160;</text><rect fill="#85BBF0" height="16.4883" style="stroke:none;stroke-width:1;" width="167.2891" x="3051.2997" y="1455.9483"/><text fill="#78A8D8" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="8.4287" x="3055.7294" y="1469.4834">&#9647;</text><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="3064.1581" y="1469.4834">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="76.665" x="3073.0175" y="1469.4834">component</text><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="3154.1122" y="1469.4834">&#160;</text><rect fill="#CCCCCC" height="16.4883" style="stroke:none;stroke-width:1;" width="167.2891" x="3051.2997" y="1472.4366"/><text fill="#BFBFBF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="8.4287" x="3055.7294" y="1485.9717">&#9647;</text><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="3064.1581" y="1485.9717">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="136.7119" x="3073.0175" y="1485.9717">external component</text><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="3214.1591" y="1485.9717">&#160;</text><rect fill="none" height="16.4883" style="stroke:none;stroke-width:1;" width="167.2891" x="3051.2997" y="1488.9248"/><text fill="#444444" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="8.4287" x="3055.7294" y="1502.46">&#9647;</text><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="3064.1581" y="1502.46">&#160;</text><text fill="#444444" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="132.4941" x="3073.0175" y="1502.46">container boundary</text><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="3209.9413" y="1502.46">&#160;</text><line style="stroke:none;stroke-width:1;" x1="3051.2997" x2="3218.5888" y1="1439.46" y2="1439.46"/><line style="stroke:none;stroke-width:1;" x1="3051.2997" x2="3218.5888" y1="1455.9483" y2="1455.9483"/><line style="stroke:none;stroke-width:1;" x1="3051.2997" x2="3218.5888" y1="1472.4366" y2="1472.4366"/><line style="stroke:none;stroke-width:1;" x1="3051.2997" x2="3218.5888" y1="1488.9248" y2="1488.9248"/><line style="stroke:none;stroke-width:1;" x1="3051.2997" x2="3218.5888" y1="1505.4131" y2="1505.4131"/><line style="stroke:none;stroke-width:1;" x1="3051.2997" x2="3051.2997" y1="1439.46" y2="1505.4131"/><line style="stroke:none;stroke-width:1;" x1="3218.5888" x2="3218.5888" y1="1439.46" y2="1505.4131"/></g><!--SRC=[fLXRSnet57xthpZrIs46GvicqvbC7sfZaj0n1WDE-xOZTcMiU5bHIMkRTlhVUuwalI-N94zcTVdqwLm_-GUHX74QSNWqPglV3mQAlVJNmZocgrHp5Sh4yCJqGxaPR6EMc7GJNsWJnM8r6BwzcD7G_UHci67QS8L3mL1kjZAXFLjSUtOsH0Gc4gw2Avac4LExZkAA9KyYMVVWV9xzXea8bSGZdqN8eNFBjVbZqJtlmhzd03benn9wDS4ZIwAOAqJuA1xCq8sE4s44YyK_FFhaviznmUWPDq9f05VhTCCrj6-rwtiGyPYlcS5bHa8nNTg3h3Q8UjwjCDmg6QLXcU7CZNpW9dmyaLbrYsSa5NveeomfpRKMCe5GSMRmHm_ymQ2DL6pDUu2uW8xRnfmM06uCoTAMRzMeXC433qayxC32VLVusHjNADkb6ia1H_AgH8s_2cqqFD0KtM1SDvL0gmRUemZLQkJ3fnTRDAnn4tYqFamJK7pDCV2iUTu3Yo8D2Nz1TneMMvDQrrgMDXYHEySnRPX9xTJbS3d-FAgHHfp0creZWyieyixIItcInHRe7wIROO18SekzOEA1bgd25B0cWmqtB6A6DIo7FjlWhw1mi3M77_P4XldaCJFwVJeB61uv0ZIGeaanZZTCFHNEPSLIU7da2KJ8hCQIRz2_61_HBi_qooGQuIWvU4uJHqmLMbF99Dv1ccZwYg0m_eE8aPc6rGucuzlnvF8cM0odyn5qUFBy7ZFuWQMnWL-xFS3C2P6zUAX41SO3ZtWzBEtQ85_7YHiD8VUPubkc-3oV6qUSwHifjqUo93z-BMLn1VWDbjDPS3LQB8FXzFvsQNCsHhWXMHsd9vT_1UFhqUKYk9bEPvJabe265Wesfcjt8QS5HcouJ2d59lYvT5y-HFHXuXFhT96mq8XdddbVa_i9DG94WXNJz2k1qUVHxJ9OZYUZwVqoc2ngPDRSP4Mcd48VUKOcowGIWRkKgrsPaVk9nRknoowbD3PAOF2MOXNlnE8uDtkDbeshCY4RTb_3fRB1qrWngjsbFE-y-mcsNBc9hY_FI0jvbhT_YELBZM2wZQW-KymcQo9uRmVyZhaRFkp7Z6dRJh-y1-wS4cLNZrmI4Y3cifP9Qm_nRJpm7HoFRDwAokKO5cu5VTrhSgIKwvYZFpVO3m23XFvUlEc_ktY8cNwyY8NXNNWM39YuqD4JLMQBNV3C0v0q2mrZPU2MyHFVlKWLwIPXQXTvD69MIQybV53DSKGBBDKx8hhSRVbqFe7gw71-Vmrowuk9wtGb22n3hkrH-M7sh-ijlQBAkZxKApUbNb40UhQf-KxOhOTjDPDQxf2v-Vkluf6WyqLYkp9iXURTtwowUoIHP_YTj78kOcDbZX4cvgJNTAZ4DjD2DWPTnlIAkEqsuk1wrI7A5454JMgpLdnnTqEdN_k9CZ_aeb4my0Hl7RCTPbVtx3-IkHul6BrICgnMmcp-3aHIqZTpEpgvitKLxOhiuKh99vUX1yGe_9tob9hh_bEyYO-UqY8iZw5ZXI-Q-D4hsAx-5RYb9diOV5_3ouyv-n7SW5VUwFNOXSsZsEgpEO_R_T9yKcGot1QioTqCVhV0CsPGRYHu564rjjNKxEYLXwbn8Bx2NgLKXnfCSjyrdmudCMbiQ-Zvd_kGwNG_s63L2bJJkc_wS4agEk-Z9u7iqQg_zA4YEwtAF0sneYlVze4KfNOgD2kiLI0WRqM2JcPnryLArYIpQC6kelBQCyXgGaiGrQtRraYyjGT4KkyfR-voBRlBzSXLcpA4trUDjaCSigxk5nzaKtNudWxZWRy2w1i0siy-oJJViAKzHjkiUfzRCtzOszWzU9bomEuHmLcvsAThS_rPv4KxKXjfAigLrDyVZgsOUmB1mLeTK2u99vcX8Rfp0pJ5D7GgBy1kYotgS4qvwj-IvMUtb-XUbvB2p5hCTFM5XwQ5TaEAvxGFAElMgbP7gjasYpEdlWU5yZxLm2sls9phyUVi8UPDvBqnbnUVNDAUpBzLVypILImqFQiw-9RcYKpNHUnryouvZ0LrIILVTtt2F0vVibBrZ9P_5nmzf_heFbH5t7jWhqtE5f-cVmOteu-Zs-jEzty0]--></g></svg>