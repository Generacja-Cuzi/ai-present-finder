asyncapi: 3.0.0
info:
  title: OLX Microservice API
  version: 1.0.0
  description: |
    This microservice provides endpoints for searching OLX listings.
    It handles product searches and returns listing data from OLX platform.

servers:
  production:
    host: localhost:3020
    protocol: http
    description: OLX Microservice Production Server

channels:
  http/olx:
    address: '/olx'
    messages:
      searchListings:
        $ref: '#/components/messages/searchListings'
      listingResults:
        $ref: '#/components/messages/listingResults'

operations:
  searchOlxListings:
    action: receive
    channel:
      $ref: '#/channels/http~1olx'
    summary: Search OLX listings
    description: Searches for products on OLX platform based on query parameters
    messages:
      - $ref: '#/channels/http~1olx/messages/searchListings'

components:
  messages:
    searchListings:
      name: SearchListings
      title: Search OLX listings
      summary: Request to search OLX listings
      contentType: application/json
      payload:
        $ref: '#/components/schemas/SearchRequest'

    listingResults:
      name: ListingResults
      title: OLX listing results
      summary: Results from OLX search
      contentType: application/json
      payload:
        $ref: '#/components/schemas/ListingResults'

  schemas:
    SearchRequest:
      type: object
      properties:
        query:
          type: string
          description: Search query
          example: "smartphone"
        limit:
          type: integer
          description: Maximum number of results
          default: 40
          minimum: 1
          maximum: 100
        offset:
          type: integer
          description: Number of results to skip
          default: 0
          minimum: 0
      required:
        - query

    ListingResults:
      type: array
      items:
        $ref: '#/components/schemas/Listing'

    Listing:
      type: object
      properties:
        title:
          type: string
          description: Product title
        url:
          type: string
          description: Product URL
        price:
          type: string
          description: Product price
        image:
          type: string
          description: Product image URL
        description:
          type: string
          description: Product description
        location:
          type: string
          description: Product location