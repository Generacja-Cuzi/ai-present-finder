<?xml version="1.0" encoding="us-ascii" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="5142px" preserveAspectRatio="none" style="width:3281px;height:5142px;background:#FFFFFF;" version="1.1" viewBox="0 0 3281 5142" width="3281px" zoomAndPan="magnify"><defs/><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="491" x="1391" y="28.5352">AI Present Finder - Main Flow (Complete with Commands &amp; Events)</text><rect fill="#ADD8E6" height="5093.123" style="stroke:#181818;stroke-width:0.5;" width="259" x="1983.5" y="43.4883"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="132" x="2047" y="56.0566">Fetch Microservices</text><rect fill="#FFFFFF" height="111.5869" style="stroke:#181818;stroke-width:1.0;" width="10" x="564.5" y="193.5977"/><rect fill="#FFFFFF" height="249.4844" style="stroke:#181818;stroke-width:1.0;" width="10" x="564.5" y="419.082"/><rect fill="#FFFFFF" height="4273.3145" style="stroke:#181818;stroke-width:1.0;" width="10" x="564.5" y="774.8086"/><rect fill="#FFFFFF" height="209.1738" style="stroke:#181818;stroke-width:1.0;" width="10" x="569.5" y="4819.9492"/><rect fill="#FFFFFF" height="29.3105" style="stroke:#181818;stroke-width:1.0;" width="10" x="862.5" y="345.1504"/><rect fill="#FFFFFF" height="29.3105" style="stroke:#181818;stroke-width:1.0;" width="10" x="862.5" y="490.7031"/><rect fill="#FFFFFF" height="29.3105" style="stroke:#181818;stroke-width:1.0;" width="10" x="970" y="549.3242"/><rect fill="#FFFFFF" height="29.3105" style="stroke:#181818;stroke-width:1.0;" width="10" x="970" y="888.7402"/><rect fill="#FFFFFF" height="29.3105" style="stroke:#181818;stroke-width:1.0;" width="10" x="970" y="1178.1563"/><rect fill="#FFFFFF" height="29.3105" style="stroke:#181818;stroke-width:1.0;" width="10" x="970" y="1455.9512"/><rect fill="#FFFFFF" height="29.3105" style="stroke:#181818;stroke-width:1.0;" width="10" x="970" y="1673.125"/><rect fill="#FFFFFF" height="29.3105" style="stroke:#181818;stroke-width:1.0;" width="10" x="970" y="1920.9199"/><rect fill="#FFFFFF" height="29.3105" style="stroke:#181818;stroke-width:1.0;" width="10" x="970" y="2155.4043"/><rect fill="#FFFFFF" height="29.3105" style="stroke:#181818;stroke-width:1.0;" width="10" x="970" y="2698.9492"/><rect fill="#FFFFFF" height="29.3105" style="stroke:#181818;stroke-width:1.0;" width="10" x="970" y="3077.9863"/><rect fill="#FFFFFF" height="29.3105" style="stroke:#181818;stroke-width:1.0;" width="10" x="970" y="3648.6621"/><rect fill="#FFFFFF" height="29.3105" style="stroke:#181818;stroke-width:1.0;" width="10" x="970" y="3764.9043"/><rect fill="#FFFFFF" height="29.3105" style="stroke:#181818;stroke-width:1.0;" width="10" x="970" y="3881.1465"/><rect fill="#FFFFFF" height="29.3105" style="stroke:#181818;stroke-width:1.0;" width="10" x="970" y="4041.6543"/><rect fill="#FFFFFF" height="29.3105" style="stroke:#181818;stroke-width:1.0;" width="10" x="970" y="4202.1621"/><rect fill="#FFFFFF" height="29.3105" style="stroke:#181818;stroke-width:1.0;" width="10" x="970" y="4362.6699"/><rect fill="#FFFFFF" height="29.3105" style="stroke:#181818;stroke-width:1.0;" width="10" x="970" y="4626.7754"/><rect fill="#FFFFFF" height="29.3105" style="stroke:#181818;stroke-width:1.0;" width="10" x="970" y="4743.0176"/><rect fill="#FFFFFF" height="29.3105" style="stroke:#181818;stroke-width:1.0;" width="10" x="970" y="4909.8809"/><rect fill="#FFFFFF" height="1440.8613" style="stroke:#181818;stroke-width:1.0;" width="10" x="1179" y="1091.2246"/><rect fill="#FFFFFF" height="1625.0352" style="stroke:#181818;stroke-width:1.0;" width="10" x="1428" y="986.9824"/><rect fill="#FFFFFF" height="1374.0605" style="stroke:#181818;stroke-width:1.0;" width="10" x="1665" y="2068.4727"/><rect fill="#FFFFFF" height="1299.6836" style="stroke:#181818;stroke-width:1.0;" width="10" x="2003" y="3107.2969"/><rect fill="#FFFFFF" height="1156.2207" style="stroke:#181818;stroke-width:1.0;" width="10" x="2065.5" y="3250.7598"/><rect fill="#FFFFFF" height="1096.6445" style="stroke:#181818;stroke-width:1.0;" width="10" x="2130" y="3310.3359"/><rect fill="#FFFFFF" height="1037.0684" style="stroke:#181818;stroke-width:1.0;" width="10" x="2198" y="3369.9121"/><rect fill="#FFFFFF" height="1828.8945" style="stroke:#181818;stroke-width:1.0;" width="10" x="2668" y="2991.0547"/><rect fill="#FFFFFF" height="348.7266" style="stroke:#181818;stroke-width:1.0;" width="10" x="2673" y="3561.7305"/><rect fill="#FFFFFF" height="100.9316" style="stroke:#181818;stroke-width:1.0;" width="10" x="2673" y="3970.0332"/><rect fill="#FFFFFF" height="100.9316" style="stroke:#181818;stroke-width:1.0;" width="10" x="2673" y="4130.541"/><rect fill="#FFFFFF" height="100.9316" style="stroke:#181818;stroke-width:1.0;" width="10" x="2673" y="4291.0488"/><rect fill="none" height="282.416" style="stroke:#000000;stroke-width:1.5;" width="1112.5" x="522.5" y="933.0508"/><rect fill="none" height="685.4531" style="stroke:#000000;stroke-width:1.5;" width="1161" x="264" y="1272.7773"/><rect fill="none" height="552.8555" style="stroke:#000000;stroke-width:1.5;" width="1904" x="104" y="1972.2305"/><rect fill="none" height="613.6523" style="stroke:#000000;stroke-width:1.5;" width="2005" x="923" y="2821.8809"/><rect fill="none" height="306.2363" style="stroke:#000000;stroke-width:1.5;" width="798" x="1595" y="3122.2969"/><rect fill="none" height="907.1367" style="stroke:#000000;stroke-width:1.5;" width="2125" x="923" y="3492.8438"/><rect fill="none" height="544.9004" style="stroke:#000000;stroke-width:1.5;" width="3255" x="9" y="4495.2227"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="292" x2="292" y1="118.9766" y2="5057.123"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="569.5" x2="569.5" y1="118.9766" y2="5057.123"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="867" x2="867" y1="118.9766" y2="5057.123"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="975" x2="975" y1="118.9766" y2="5057.123"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1184" x2="1184" y1="118.9766" y2="5057.123"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1432.5" x2="1432.5" y1="118.9766" y2="5057.123"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1670" x2="1670" y1="118.9766" y2="5057.123"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="2007.5" x2="2007.5" y1="118.9766" y2="5057.123"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="2070.5" x2="2070.5" y1="118.9766" y2="5057.123"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="2134.5" x2="2134.5" y1="118.9766" y2="5057.123"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="2202.5" x2="2202.5" y1="118.9766" y2="5057.123"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="2673" x2="2673" y1="118.9766" y2="5057.123"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="31" x="274" y="116.0234">User</text><ellipse cx="292.5" cy="50.9883" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M292.5,58.9883 L292.5,85.9883 M279.5,66.9883 L305.5,66.9883 M292.5,85.9883 L279.5,100.9883 M292.5,85.9883 L305.5,100.9883 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="31" x="274" y="5069.6582">User</text><ellipse cx="292.5" cy="5081.1113" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M292.5,5089.1113 L292.5,5116.1113 M279.5,5097.1113 L305.5,5097.1113 M292.5,5116.1113 L279.5,5131.1113 M292.5,5116.1113 L305.5,5131.1113 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="74" x="532.5" y="87.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="60" x="539.5" y="108.0234">REST API</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="74" x="532.5" y="5056.123"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="60" x="539.5" y="5076.6582">REST API</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="111" x="812" y="87.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="97" x="819" y="108.0234">Google OAuth</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="111" x="812" y="5056.123"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="97" x="819" y="5076.6582">Google OAuth</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="78" x="933" y="116.0234">PostgreSQL</text><path d="M957,66.4883 C957,56.4883 975,56.4883 975,56.4883 C975,56.4883 993,56.4883 993,66.4883 L993,92.4883 C993,102.4883 975,102.4883 975,102.4883 C975,102.4883 957,102.4883 957,92.4883 L957,66.4883 " fill="#E2E2F0" style="stroke:#181818;stroke-width:1.5;"/><path d="M957,66.4883 C957,76.4883 975,76.4883 975,76.4883 C975,76.4883 993,76.4883 993,66.4883 " fill="none" style="stroke:#181818;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="78" x="933" y="5069.6582">PostgreSQL</text><path d="M957,5082.6113 C957,5072.6113 975,5072.6113 975,5072.6113 C975,5072.6113 993,5072.6113 993,5082.6113 L993,5108.6113 C993,5118.6113 975,5118.6113 975,5118.6113 C975,5118.6113 957,5118.6113 957,5108.6113 L957,5082.6113 " fill="#E2E2F0" style="stroke:#181818;stroke-width:1.5;"/><path d="M957,5082.6113 C957,5092.6113 975,5092.6113 975,5092.6113 C975,5092.6113 993,5092.6113 993,5082.6113 " fill="none" style="stroke:#181818;stroke-width:1.5;"/><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="98" x="1135" y="87.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="84" x="1142" y="108.0234">Chat Service</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="98" x="1135" y="5056.123"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="84" x="1142" y="5076.6582">Chat Service</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="121" x="1372.5" y="87.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="107" x="1379.5" y="108.0234">Stalking Service</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="121" x="1372.5" y="5056.123"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="107" x="1379.5" y="5076.6582">Stalking Service</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="130" x="1605" y="87.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="116" x="1612" y="108.0234">Gift Ideas Service</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="130" x="1605" y="5056.123"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="116" x="1612" y="5076.6582">Gift Ideas Service</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="41" x="1987.5" y="87.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="27" x="1994.5" y="108.0234">OLX</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="41" x="1987.5" y="5056.123"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="27" x="1994.5" y="5076.6582">OLX</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="64" x="2038.5" y="87.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="50" x="2045.5" y="108.0234">Allegro</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="64" x="2038.5" y="5056.123"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="50" x="2045.5" y="5076.6582">Allegro</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="45" x="2112.5" y="87.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="31" x="2119.5" y="108.0234">eBay</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="45" x="2112.5" y="5056.123"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="31" x="2119.5" y="5076.6582">eBay</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="71" x="2167.5" y="87.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="57" x="2174.5" y="108.0234">Amazon</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="71" x="2167.5" y="5056.123"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="57" x="2174.5" y="5076.6582">Amazon</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="136" x="2605" y="87.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="122" x="2612" y="108.0234">Reranking Service</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="136" x="2605" y="5056.123"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="122" x="2612" y="5076.6582">Reranking Service</text><rect fill="#FFFFFF" height="111.5869" style="stroke:#181818;stroke-width:1.0;" width="10" x="564.5" y="193.5977"/><rect fill="#FFFFFF" height="249.4844" style="stroke:#181818;stroke-width:1.0;" width="10" x="564.5" y="419.082"/><rect fill="#FFFFFF" height="4273.3145" style="stroke:#181818;stroke-width:1.0;" width="10" x="564.5" y="774.8086"/><rect fill="#FFFFFF" height="209.1738" style="stroke:#181818;stroke-width:1.0;" width="10" x="569.5" y="4819.9492"/><rect fill="#FFFFFF" height="29.3105" style="stroke:#181818;stroke-width:1.0;" width="10" x="862.5" y="345.1504"/><rect fill="#FFFFFF" height="29.3105" style="stroke:#181818;stroke-width:1.0;" width="10" x="862.5" y="490.7031"/><rect fill="#FFFFFF" height="29.3105" style="stroke:#181818;stroke-width:1.0;" width="10" x="970" y="549.3242"/><rect fill="#FFFFFF" height="29.3105" style="stroke:#181818;stroke-width:1.0;" width="10" x="970" y="888.7402"/><rect fill="#FFFFFF" height="29.3105" style="stroke:#181818;stroke-width:1.0;" width="10" x="970" y="1178.1563"/><rect fill="#FFFFFF" height="29.3105" style="stroke:#181818;stroke-width:1.0;" width="10" x="970" y="1455.9512"/><rect fill="#FFFFFF" height="29.3105" style="stroke:#181818;stroke-width:1.0;" width="10" x="970" y="1673.125"/><rect fill="#FFFFFF" height="29.3105" style="stroke:#181818;stroke-width:1.0;" width="10" x="970" y="1920.9199"/><rect fill="#FFFFFF" height="29.3105" style="stroke:#181818;stroke-width:1.0;" width="10" x="970" y="2155.4043"/><rect fill="#FFFFFF" height="29.3105" style="stroke:#181818;stroke-width:1.0;" width="10" x="970" y="2698.9492"/><rect fill="#FFFFFF" height="29.3105" style="stroke:#181818;stroke-width:1.0;" width="10" x="970" y="3077.9863"/><rect fill="#FFFFFF" height="29.3105" style="stroke:#181818;stroke-width:1.0;" width="10" x="970" y="3648.6621"/><rect fill="#FFFFFF" height="29.3105" style="stroke:#181818;stroke-width:1.0;" width="10" x="970" y="3764.9043"/><rect fill="#FFFFFF" height="29.3105" style="stroke:#181818;stroke-width:1.0;" width="10" x="970" y="3881.1465"/><rect fill="#FFFFFF" height="29.3105" style="stroke:#181818;stroke-width:1.0;" width="10" x="970" y="4041.6543"/><rect fill="#FFFFFF" height="29.3105" style="stroke:#181818;stroke-width:1.0;" width="10" x="970" y="4202.1621"/><rect fill="#FFFFFF" height="29.3105" style="stroke:#181818;stroke-width:1.0;" width="10" x="970" y="4362.6699"/><rect fill="#FFFFFF" height="29.3105" style="stroke:#181818;stroke-width:1.0;" width="10" x="970" y="4626.7754"/><rect fill="#FFFFFF" height="29.3105" style="stroke:#181818;stroke-width:1.0;" width="10" x="970" y="4743.0176"/><rect fill="#FFFFFF" height="29.3105" style="stroke:#181818;stroke-width:1.0;" width="10" x="970" y="4909.8809"/><rect fill="#FFFFFF" height="1440.8613" style="stroke:#181818;stroke-width:1.0;" width="10" x="1179" y="1091.2246"/><rect fill="#FFFFFF" height="1625.0352" style="stroke:#181818;stroke-width:1.0;" width="10" x="1428" y="986.9824"/><rect fill="#FFFFFF" height="1374.0605" style="stroke:#181818;stroke-width:1.0;" width="10" x="1665" y="2068.4727"/><rect fill="#FFFFFF" height="1299.6836" style="stroke:#181818;stroke-width:1.0;" width="10" x="2003" y="3107.2969"/><rect fill="#FFFFFF" height="1156.2207" style="stroke:#181818;stroke-width:1.0;" width="10" x="2065.5" y="3250.7598"/><rect fill="#FFFFFF" height="1096.6445" style="stroke:#181818;stroke-width:1.0;" width="10" x="2130" y="3310.3359"/><rect fill="#FFFFFF" height="1037.0684" style="stroke:#181818;stroke-width:1.0;" width="10" x="2198" y="3369.9121"/><rect fill="#FFFFFF" height="1828.8945" style="stroke:#181818;stroke-width:1.0;" width="10" x="2668" y="2991.0547"/><rect fill="#FFFFFF" height="348.7266" style="stroke:#181818;stroke-width:1.0;" width="10" x="2673" y="3561.7305"/><rect fill="#FFFFFF" height="100.9316" style="stroke:#181818;stroke-width:1.0;" width="10" x="2673" y="3970.0332"/><rect fill="#FFFFFF" height="100.9316" style="stroke:#181818;stroke-width:1.0;" width="10" x="2673" y="4130.541"/><rect fill="#FFFFFF" height="100.9316" style="stroke:#181818;stroke-width:1.0;" width="10" x="2673" y="4291.0488"/><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="3274" x="0" y="149.6318"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="3274" y1="149.6318" y2="149.6318"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="3274" y1="152.6318" y2="152.6318"/><rect fill="#EEEEEE" height="23.3105" style="stroke:#000000;stroke-width:2.0;" width="189" x="1542.5" y="138.9766"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="171" x="1548.5" y="155.5449">Autoryzacja u&#380;ytkownika</text><polygon fill="#181818" points="552.5,189.5977,562.5,193.5977,552.5,197.5977,556.5,193.5977" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="292.5" x2="558.5" y1="193.5977" y2="193.5977"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="137" x="299.5" y="188.8555">GET /auth/google/url</text><line style="stroke:#181818;stroke-width:1.0;" x1="574.5" x2="616.5" y1="222.9082" y2="222.9082"/><line style="stroke:#181818;stroke-width:1.0;" x1="616.5" x2="616.5" y1="222.9082" y2="235.9082"/><line style="stroke:#181818;stroke-width:1.0;" x1="575.5" x2="616.5" y1="235.9082" y2="235.9082"/><polygon fill="#181818" points="585.5,231.9082,575.5,235.9082,585.5,239.9082,581.5,235.9082" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="215" x="581.5" y="218.166">GenerateGoogleOAuthUrlQuery</text><polygon fill="#181818" points="855.5,261.2188,865.5,265.2188,855.5,269.2188,859.5,265.2188" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="574.5" x2="861.5" y1="265.2188" y2="265.2188"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="93" x="581.5" y="260.4766">Get OAuth URL</text><polygon fill="#181818" points="303.5,301.1846,293.5,305.1846,303.5,309.1846,299.5,305.1846" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="297.5" x2="568.5" y1="305.1846" y2="305.1846"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="248" x="309.5" y="300.4424">{url: "https://accounts.google.com/..."}</text><path d="M100,278.2188 L100,318.2188 L287,318.2188 L287,288.2188 L277,278.2188 L100,278.2188 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M277,278.2188 L277,288.2188 L287,288.2188 L277,278.2188 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="166" x="106" y="295.7871">U&#380;ytkownik przekierowuje</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="108" x="106" y="311.0977">do Google OAuth</text><polygon fill="#181818" points="850.5,341.1504,860.5,345.1504,850.5,349.1504,854.5,345.1504" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="292.5" x2="856.5" y1="345.1504" y2="345.1504"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="136" x="299.5" y="340.4082">Autoryzacja w Google</text><polygon fill="#181818" points="303.5,370.4609,293.5,374.4609,303.5,378.4609,299.5,374.4609" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="297.5" x2="866.5" y1="374.4609" y2="374.4609"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="212" x="309.5" y="369.7188">Redirect z kodem autoryzacyjnym</text><polygon fill="#181818" points="552.5,415.082,562.5,419.082,552.5,423.082,556.5,419.082" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="292.5" x2="558.5" y1="419.082" y2="419.082"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="180" x="299.5" y="399.0293">POST /auth/google/callback</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="38" x="299.5" y="414.3398">{code}</text><line style="stroke:#181818;stroke-width:1.0;" x1="574.5" x2="616.5" y1="448.3926" y2="448.3926"/><line style="stroke:#181818;stroke-width:1.0;" x1="616.5" x2="616.5" y1="448.3926" y2="461.3926"/><line style="stroke:#181818;stroke-width:1.0;" x1="575.5" x2="616.5" y1="461.3926" y2="461.3926"/><polygon fill="#181818" points="585.5,457.3926,575.5,461.3926,585.5,465.3926,581.5,461.3926" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="213" x="581.5" y="443.6504">ValidateGoogleTokenCommand</text><polygon fill="#181818" points="850.5,486.7031,860.5,490.7031,850.5,494.7031,854.5,490.7031" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="574.5" x2="856.5" y1="490.7031" y2="490.7031"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="151" x="581.5" y="485.9609">Wymiana kodu na token</text><polygon fill="#181818" points="585.5,516.0137,575.5,520.0137,585.5,524.0137,581.5,520.0137" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="579.5" x2="866.5" y1="520.0137" y2="520.0137"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="264" x="591.5" y="515.2715">{accessToken, refreshToken, email, name}</text><polygon fill="#181818" points="958,545.3242,968,549.3242,958,553.3242,962,549.3242" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="574.5" x2="964" y1="549.3242" y2="549.3242"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="257" x="581.5" y="544.582">Upsert user (email, name, googleTokens)</text><polygon fill="#181818" points="585.5,574.6348,575.5,578.6348,585.5,582.6348,581.5,578.6348" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="579.5" x2="974" y1="578.6348" y2="578.6348"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="68" x="591.5" y="573.8926">User entity</text><line style="stroke:#181818;stroke-width:1.0;" x1="574.5" x2="616.5" y1="607.9453" y2="607.9453"/><line style="stroke:#181818;stroke-width:1.0;" x1="616.5" x2="616.5" y1="607.9453" y2="620.9453"/><line style="stroke:#181818;stroke-width:1.0;" x1="575.5" x2="616.5" y1="620.9453" y2="620.9453"/><polygon fill="#181818" points="585.5,616.9453,575.5,620.9453,585.5,624.9453,581.5,620.9453" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="122" x="581.5" y="603.2031">Generate JWT token</text><polygon fill="#181818" points="303.5,664.5664,293.5,668.5664,303.5,672.5664,299.5,668.5664" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="297.5" x2="568.5" y1="668.5664" y2="668.5664"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="231" x="309.5" y="648.5137">Set-Cookie: access_token (httpOnly)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="147" x="309.5" y="663.8242">{user: {id, email, name}}</text><path d="M41,633.9453 L41,673.9453 L287,673.9453 L287,643.9453 L277,633.9453 L41,633.9453 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M277,633.9453 L277,643.9453 L287,643.9453 L277,633.9453 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="201" x="47" y="651.5137">JWT zapisany w httpOnly cookie</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="225" x="47" y="666.8242">Dost&#281;p do chronionych endpoint&#243;w</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="3274" x="0" y="700.2217"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="3274" y1="700.2217" y2="700.2217"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="3274" y1="703.2217" y2="703.2217"/><rect fill="#EEEEEE" height="23.3105" style="stroke:#000000;stroke-width:2.0;" width="260" x="1507" y="689.5664"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="242" x="1513" y="706.1348">Start sesji (u&#380;ytkownik zalogowany)</text><polygon fill="#181818" points="552.5,770.8086,562.5,774.8086,552.5,778.8086,556.5,774.8086" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="292.5" x2="558.5" y1="774.8086" y2="774.8086"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="199" x="299.5" y="739.4453">POST /restapi/stalking-request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="191" x="299.5" y="754.7559">{chatId, social URLs, occasion}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="83" x="299.5" y="770.0664">+ JWT cookie</text><line style="stroke:#181818;stroke-width:1.0;" x1="574.5" x2="616.5" y1="804.1191" y2="804.1191"/><line style="stroke:#181818;stroke-width:1.0;" x1="616.5" x2="616.5" y1="804.1191" y2="817.1191"/><line style="stroke:#181818;stroke-width:1.0;" x1="575.5" x2="616.5" y1="817.1191" y2="817.1191"/><polygon fill="#181818" points="585.5,813.1191,575.5,817.1191,585.5,821.1191,581.5,817.1191" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="96" x="581.5" y="799.377">JwtAuthGuard</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="130" x="681.5" y="799.377">- weryfikacja tokena</text><line style="stroke:#181818;stroke-width:1.0;" x1="574.5" x2="616.5" y1="846.4297" y2="846.4297"/><line style="stroke:#181818;stroke-width:1.0;" x1="616.5" x2="616.5" y1="846.4297" y2="859.4297"/><line style="stroke:#181818;stroke-width:1.0;" x1="575.5" x2="616.5" y1="859.4297" y2="859.4297"/><polygon fill="#181818" points="585.5,855.4297,575.5,859.4297,585.5,863.4297,581.5,859.4297" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="173" x="581.5" y="841.6875">StartProcessingCommand</text><polygon fill="#181818" points="958,884.7402,968,888.7402,958,892.7402,962,888.7402" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="574.5" x2="964" y1="888.7402" y2="888.7402"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123" x="581.5" y="883.998">Create chat session</text><polygon fill="#181818" points="585.5,914.0508,575.5,918.0508,585.5,922.0508,581.5,918.0508" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="579.5" x2="974" y1="918.0508" y2="918.0508"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="69" x="591.5" y="913.3086">Chat entity</text><path d="M522.5,933.0508 L590.5,933.0508 L590.5,940.3613 L580.5,950.3613 L522.5,950.3613 L522.5,933.0508 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="282.416" style="stroke:#000000;stroke-width:1.5;" width="1112.5" x="522.5" y="933.0508"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23" x="537.5" y="946.6191">par</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="154" x="605.5" y="945.6855">[Przetwarzanie R&#243;wnoleg&#322;e]</text><polygon fill="#181818" points="1416,982.9824,1426,986.9824,1416,990.9824,1420,986.9824" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="574.5" x2="1422" y1="986.9824" y2="986.9824"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="219" x="581.5" y="966.9297">StalkingAnalyzeRequestedEvent</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="86" x="581.5" y="982.2402">{chatId, URLs}</text><line style="stroke:#181818;stroke-width:1.0;" x1="1438" x2="1480" y1="1031.6035" y2="1031.6035"/><line style="stroke:#181818;stroke-width:1.0;" x1="1480" x2="1480" y1="1031.6035" y2="1044.6035"/><line style="stroke:#181818;stroke-width:1.0;" x1="1439" x2="1480" y1="1044.6035" y2="1044.6035"/><polygon fill="#181818" points="1449,1040.6035,1439,1044.6035,1449,1048.6035,1445,1044.6035" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="178" x="1445" y="1011.5508">StalkingAnalyzeCommand</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="177" x="1445" y="1026.8613">(analiza profili social media)</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="522.5" x2="1635" y1="1053.6035" y2="1053.6035"/><polygon fill="#181818" points="1167,1087.2246,1177,1091.2246,1167,1095.2246,1171,1091.2246" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="574.5" x2="1173" y1="1091.2246" y2="1091.2246"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="163" x="581.5" y="1071.1719">ChatStartInterviewEvent</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="111" x="581.5" y="1086.4824">{chatId, occasion}</text><line style="stroke:#181818;stroke-width:1.0;" x1="1189" x2="1231" y1="1135.8457" y2="1135.8457"/><line style="stroke:#181818;stroke-width:1.0;" x1="1231" x2="1231" y1="1135.8457" y2="1148.8457"/><line style="stroke:#181818;stroke-width:1.0;" x1="1190" x2="1231" y1="1148.8457" y2="1148.8457"/><polygon fill="#181818" points="1200,1144.8457,1190,1148.8457,1200,1152.8457,1196,1148.8457" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="150" x="1196" y="1115.793">SetOccasionCommand</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="111" x="1196" y="1131.1035">{chatId, occasion}</text><polygon fill="#181818" points="991,1174.1563,981,1178.1563,991,1182.1563,987,1178.1563" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="985" x2="1178" y1="1178.1563" y2="1178.1563"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="167" x="997" y="1173.4141">Create chat session record</text><polygon fill="#181818" points="1167,1203.4668,1177,1207.4668,1167,1211.4668,1171,1207.4668" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="975" x2="1173" y1="1207.4668" y2="1207.4668"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="81" x="982" y="1202.7246">Chat session</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="3274" x="0" y="1243.1221"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="3274" y1="1243.1221" y2="1243.1221"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="3274" y1="1246.1221" y2="1246.1221"/><rect fill="#EEEEEE" height="23.3105" style="stroke:#000000;stroke-width:2.0;" width="114" x="1580" y="1232.4668"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="96" x="1586" y="1249.0352">Interview loop</text><path d="M264,1272.7773 L338,1272.7773 L338,1280.0879 L328,1290.0879 L264,1290.0879 L264,1272.7773 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="685.4531" style="stroke:#000000;stroke-width:1.5;" width="1161" x="264" y="1272.7773"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29" x="279" y="1286.3457">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="401" x="353" y="1285.4121">[Dop&#243;ki AI nie zdecyduje zako&#324;czy&#263; lub niew&#322;a&#347;ciwe zachowanie usera]</text><line style="stroke:#181818;stroke-width:1.0;" x1="1189" x2="1231" y1="1326.709" y2="1326.709"/><line style="stroke:#181818;stroke-width:1.0;" x1="1231" x2="1231" y1="1326.709" y2="1339.709"/><line style="stroke:#181818;stroke-width:1.0;" x1="1190" x2="1231" y1="1339.709" y2="1339.709"/><polygon fill="#181818" points="1200,1335.709,1190,1339.709,1200,1343.709,1196,1339.709" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="192" x="1196" y="1306.6563">GenerateQuestionCommand</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="217" x="1196" y="1321.9668">(AI decyduje o nast&#281;pnym pytaniu)</text><polygon fill="#181818" points="585.5,1380.3301,575.5,1384.3301,585.5,1388.3301,581.5,1384.3301" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="579.5" x2="1178" y1="1384.3301" y2="1384.3301"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="172" x="591.5" y="1364.2773">ChatQuestionAskedEvent</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="110" x="591.5" y="1379.5879">{chatId, question}</text><line style="stroke:#181818;stroke-width:1.0;" x1="574.5" x2="616.5" y1="1413.6406" y2="1413.6406"/><line style="stroke:#181818;stroke-width:1.0;" x1="616.5" x2="616.5" y1="1413.6406" y2="1426.6406"/><line style="stroke:#181818;stroke-width:1.0;" x1="575.5" x2="616.5" y1="1426.6406" y2="1426.6406"/><polygon fill="#181818" points="585.5,1422.6406,575.5,1426.6406,585.5,1430.6406,581.5,1426.6406" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="162" x="581.5" y="1408.8984">NotifyUserSseCommand</text><polygon fill="#181818" points="958,1451.9512,968,1455.9512,958,1459.9512,962,1455.9512" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="574.5" x2="964" y1="1455.9512" y2="1455.9512"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="164" x="581.5" y="1451.209">Save message to database</text><polygon fill="#181818" points="585.5,1481.2617,575.5,1485.2617,585.5,1489.2617,581.5,1485.2617" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="579.5" x2="974" y1="1485.2617" y2="1485.2617"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="94" x="591.5" y="1480.5195">Message entity</text><polygon fill="#181818" points="303.5,1510.5723,293.5,1514.5723,303.5,1518.5723,299.5,1514.5723" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="297.5" x2="563.5" y1="1514.5723" y2="1514.5723"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="140" x="309.5" y="1509.8301">SSE: chatbot-message</text><polygon fill="#181818" points="552.5,1555.1934,562.5,1559.1934,552.5,1563.1934,556.5,1559.1934" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="292.5" x2="558.5" y1="1559.1934" y2="1559.1934"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="186" x="299.5" y="1539.1406">POST /restapi/send-message</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="117" x="299.5" y="1554.4512">{chatId, messages}</text><line style="stroke:#181818;stroke-width:1.0;" x1="574.5" x2="616.5" y1="1588.5039" y2="1588.5039"/><line style="stroke:#181818;stroke-width:1.0;" x1="616.5" x2="616.5" y1="1588.5039" y2="1601.5039"/><line style="stroke:#181818;stroke-width:1.0;" x1="575.5" x2="616.5" y1="1601.5039" y2="1601.5039"/><polygon fill="#181818" points="585.5,1597.5039,575.5,1601.5039,585.5,1605.5039,581.5,1601.5039" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="96" x="581.5" y="1583.7617">JwtAuthGuard</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="130" x="681.5" y="1583.7617">- weryfikacja tokena</text><line style="stroke:#181818;stroke-width:1.0;" x1="574.5" x2="616.5" y1="1630.8145" y2="1630.8145"/><line style="stroke:#181818;stroke-width:1.0;" x1="616.5" x2="616.5" y1="1630.8145" y2="1643.8145"/><line style="stroke:#181818;stroke-width:1.0;" x1="575.5" x2="616.5" y1="1643.8145" y2="1643.8145"/><polygon fill="#181818" points="585.5,1639.8145,575.5,1643.8145,585.5,1647.8145,581.5,1643.8145" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="192" x="581.5" y="1626.0723">SendUserMessageCommand</text><polygon fill="#181818" points="958,1669.125,968,1673.125,958,1677.125,962,1673.125" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="574.5" x2="964" y1="1673.125" y2="1673.125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="195" x="581.5" y="1668.3828">Save user message to database</text><polygon fill="#181818" points="585.5,1698.4355,575.5,1702.4355,585.5,1706.4355,581.5,1702.4355" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="579.5" x2="974" y1="1702.4355" y2="1702.4355"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="94" x="591.5" y="1697.6934">Message entity</text><line style="stroke:#181818;stroke-width:1.0;" x1="574.5" x2="616.5" y1="1731.7461" y2="1731.7461"/><line style="stroke:#181818;stroke-width:1.0;" x1="616.5" x2="616.5" y1="1731.7461" y2="1744.7461"/><line style="stroke:#181818;stroke-width:1.0;" x1="575.5" x2="616.5" y1="1744.7461" y2="1744.7461"/><polygon fill="#181818" points="585.5,1740.7461,575.5,1744.7461,585.5,1748.7461,581.5,1744.7461" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="162" x="581.5" y="1727.0039">NotifyUserSseCommand</text><polygon fill="#181818" points="303.5,1785.3672,293.5,1789.3672,303.5,1793.3672,299.5,1789.3672" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="297.5" x2="563.5" y1="1789.3672" y2="1789.3672"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="140" x="309.5" y="1769.3145">SSE: chatbot-message</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="201" x="309.5" y="1784.625">(echo wiadomo&#347;ci u&#380;ytkownika)</text><polygon fill="#181818" points="1167,1829.9883,1177,1833.9883,1167,1837.9883,1171,1833.9883" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="574.5" x2="1173" y1="1833.9883" y2="1833.9883"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="168" x="581.5" y="1813.9355">ChatUserAnsweredEvent</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="117" x="581.5" y="1829.2461">{chatId, messages}</text><line style="stroke:#181818;stroke-width:1.0;" x1="1189" x2="1231" y1="1878.6094" y2="1878.6094"/><line style="stroke:#181818;stroke-width:1.0;" x1="1231" x2="1231" y1="1878.6094" y2="1891.6094"/><line style="stroke:#181818;stroke-width:1.0;" x1="1190" x2="1231" y1="1891.6094" y2="1891.6094"/><polygon fill="#181818" points="1200,1887.6094,1190,1891.6094,1200,1895.6094,1196,1891.6094" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="126" x="1196" y="1858.5566">GetOccasionQuery</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="47" x="1196" y="1873.8672">{chatId}</text><polygon fill="#181818" points="991,1916.9199,981,1920.9199,991,1924.9199,987,1920.9199" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="985" x2="1178" y1="1920.9199" y2="1920.9199"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="180" x="997" y="1916.1777">Fetch occasion from session</text><polygon fill="#181818" points="1167,1946.2305,1177,1950.2305,1167,1954.2305,1171,1950.2305" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="975" x2="1173" y1="1950.2305" y2="1950.2305"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="89" x="982" y="1945.4883">Occasion data</text><path d="M104,1972.2305 L166,1972.2305 L166,1979.541 L156,1989.541 L104,1989.541 L104,1972.2305 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="552.8555" style="stroke:#000000;stroke-width:1.5;" width="1904" x="104" y="1972.2305"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17" x="119" y="1985.7988">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="181" x="181" y="1984.8652">[Wywiad zako&#324;czony pomy&#347;lnie]</text><line style="stroke:#181818;stroke-width:1.0;" x1="1189" x2="1231" y1="2010.8516" y2="2010.8516"/><line style="stroke:#181818;stroke-width:1.0;" x1="1231" x2="1231" y1="2010.8516" y2="2023.8516"/><line style="stroke:#181818;stroke-width:1.0;" x1="1190" x2="1231" y1="2023.8516" y2="2023.8516"/><polygon fill="#181818" points="1200,2019.8516,1190,2023.8516,1200,2027.8516,1196,2023.8516" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="97" x="1196" y="2006.1094">closeInterview</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="47" x="1297" y="2006.1094">toolcall</text><polygon fill="#181818" points="1653,2064.4727,1663,2068.4727,1653,2072.4727,1657,2068.4727" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1189" x2="1659" y1="2068.4727" y2="2068.4727"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="205" x="1196" y="2048.4199">ChatInterviewCompletedEvent</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="96" x="1196" y="2063.7305">{chatId, profile}</text><line style="stroke:#181818;stroke-width:1.0;" x1="1675" x2="1717" y1="2113.0938" y2="2113.0938"/><line style="stroke:#181818;stroke-width:1.0;" x1="1717" x2="1717" y1="2113.0938" y2="2126.0938"/><line style="stroke:#181818;stroke-width:1.0;" x1="1676" x2="1717" y1="2126.0938" y2="2126.0938"/><polygon fill="#181818" points="1686,2122.0938,1676,2126.0938,1686,2130.0938,1682,2126.0938" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="222" x="1682" y="2093.041">UpdateInterviewStatusCommand</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="314" x="1682" y="2108.3516">(zapisz profil usera, sprawd&#378; czy stalking gotowy)</text><polygon fill="#181818" points="991,2151.4043,981,2155.4043,991,2159.4043,987,2155.4043" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="985" x2="1664" y1="2155.4043" y2="2155.4043"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="179" x="997" y="2150.6621">Update chat interview status</text><polygon fill="#181818" points="1653,2180.7148,1663,2184.7148,1653,2188.7148,1657,2184.7148" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="975" x2="1659" y1="2184.7148" y2="2184.7148"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="83" x="982" y="2179.9727">Updated chat</text><polygon fill="#181818" points="585.5,2225.3359,575.5,2229.3359,585.5,2233.3359,581.5,2229.3359" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="579.5" x2="1178" y1="2229.3359" y2="2229.3359"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="213" x="591.5" y="2209.2832">ChatCompletedNotifyUserEvent</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="47" x="591.5" y="2224.5938">{chatId}</text><line style="stroke:#181818;stroke-width:1.0;" x1="574.5" x2="616.5" y1="2258.6465" y2="2258.6465"/><line style="stroke:#181818;stroke-width:1.0;" x1="616.5" x2="616.5" y1="2258.6465" y2="2271.6465"/><line style="stroke:#181818;stroke-width:1.0;" x1="575.5" x2="616.5" y1="2271.6465" y2="2271.6465"/><polygon fill="#181818" points="585.5,2267.6465,575.5,2271.6465,585.5,2275.6465,581.5,2271.6465" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="162" x="581.5" y="2253.9043">NotifyUserSseCommand</text><polygon fill="#181818" points="303.5,2307.6123,293.5,2311.6123,303.5,2315.6123,299.5,2311.6123" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="297.5" x2="563.5" y1="2311.6123" y2="2311.6123"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="195" x="309.5" y="2306.8701">SSE: chat-interview-completed</text><path d="M136,2284.6465 L136,2324.6465 L287,2324.6465 L287,2294.6465 L277,2284.6465 L136,2284.6465 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M277,2284.6465 L277,2294.6465 L287,2294.6465 L277,2284.6465 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="130" x="142" y="2302.2148">Wywiad zako&#324;czony,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="102" x="142" y="2317.5254">ekran &#322;adowania</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="104" x2="2008" y1="2331.2676" y2="2331.2676"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="192" x="109" y="2341.9023">[Wykryto niew&#322;a&#347;ciwe zachowanie]</text><line style="stroke:#181818;stroke-width:1.0;" x1="1189" x2="1231" y1="2366.5332" y2="2366.5332"/><line style="stroke:#181818;stroke-width:1.0;" x1="1231" x2="1231" y1="2366.5332" y2="2379.5332"/><line style="stroke:#181818;stroke-width:1.0;" x1="1190" x2="1231" y1="2379.5332" y2="2379.5332"/><polygon fill="#181818" points="1200,2375.5332,1190,2379.5332,1200,2383.5332,1196,2379.5332" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="174" x="1196" y="2361.791">flagInappropriateRequest</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="47" x="1374" y="2361.791">toolcall</text><polygon fill="#181818" points="585.5,2420.1543,575.5,2424.1543,585.5,2428.1543,581.5,2424.1543" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="579.5" x2="1178" y1="2424.1543" y2="2424.1543"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="217" x="591.5" y="2404.1016">ChatInappropriateRequestEvent</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="97" x="591.5" y="2419.4121">{chatId, reason}</text><line style="stroke:#181818;stroke-width:1.0;" x1="574.5" x2="616.5" y1="2453.4648" y2="2453.4648"/><line style="stroke:#181818;stroke-width:1.0;" x1="616.5" x2="616.5" y1="2453.4648" y2="2466.4648"/><line style="stroke:#181818;stroke-width:1.0;" x1="575.5" x2="616.5" y1="2466.4648" y2="2466.4648"/><polygon fill="#181818" points="585.5,2462.4648,575.5,2466.4648,585.5,2470.4648,581.5,2466.4648" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="162" x="581.5" y="2448.7227">NotifyUserSseCommand</text><polygon fill="#181818" points="303.5,2502.4307,293.5,2506.4307,303.5,2510.4307,299.5,2506.4307" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="297.5" x2="563.5" y1="2506.4307" y2="2506.4307"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="203" x="309.5" y="2501.6885">SSE: chat-inappropriate-request</text><path d="M114,2479.4648 L114,2519.4648 L287,2519.4648 L287,2489.4648 L277,2479.4648 L114,2479.4648 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M277,2479.4648 L277,2489.4648 L287,2489.4648 L277,2479.4648 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="130" x="120" y="2497.0332">Wywiad zako&#324;czony,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="152" x="120" y="2512.3438">nagana dla u&#380;ytkownika</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="3274" x="0" y="2552.7412"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="3274" y1="2552.7412" y2="2552.7412"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="3274" y1="2555.7412" y2="2555.7412"/><rect fill="#EEEEEE" height="23.3105" style="stroke:#000000;stroke-width:2.0;" width="170" x="1552" y="2542.0859"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="152" x="1558" y="2558.6543">Zako&#324;czenie Stalkingu</text><polygon fill="#181818" points="1653,2608.0176,1663,2612.0176,1653,2616.0176,1657,2612.0176" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1433" x2="1659" y1="2612.0176" y2="2612.0176"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="165" x="1440" y="2591.9648">StalkingCompletedEvent</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="203" x="1440" y="2607.2754">{keywords, chatId, completedAt}</text><line style="stroke:#181818;stroke-width:1.0;" x1="1675" x2="1717" y1="2656.6387" y2="2656.6387"/><line style="stroke:#181818;stroke-width:1.0;" x1="1717" x2="1717" y1="2656.6387" y2="2669.6387"/><line style="stroke:#181818;stroke-width:1.0;" x1="1676" x2="1717" y1="2669.6387" y2="2669.6387"/><polygon fill="#181818" points="1686,2665.6387,1676,2669.6387,1686,2673.6387,1682,2669.6387" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="213" x="1682" y="2636.5859">UpdateStalkingStatusCommand</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="297" x="1682" y="2651.8965">(zapisz keywords, sprawd&#378; czy wywiad gotowy)</text><polygon fill="#181818" points="991,2694.9492,981,2698.9492,991,2702.9492,987,2698.9492" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="985" x2="1664" y1="2698.9492" y2="2698.9492"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="173" x="997" y="2694.207">Update chat stalking status</text><polygon fill="#181818" points="1653,2724.2598,1663,2728.2598,1653,2732.2598,1657,2728.2598" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="975" x2="1659" y1="2728.2598" y2="2728.2598"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="83" x="982" y="2723.5176">Updated chat</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="3274" x="0" y="2756.915"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="3274" y1="2756.915" y2="2756.915"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="3274" y1="2759.915" y2="2759.915"/><rect fill="#EEEEEE" height="23.3105" style="stroke:#000000;stroke-width:2.0;" width="270" x="1502" y="2746.2598"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="252" x="1508" y="2762.8281">Koordynacja Generowania Prezent&#243;w</text><path d="M1576,2784.5703 L1576,2809.5703 L1763,2809.5703 L1763,2794.5703 L1753,2784.5703 L1576,2784.5703 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1753,2784.5703 L1753,2794.5703 L1763,2794.5703 L1753,2784.5703 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="166" x="1582" y="2802.1387">Gdy oba eventy otrzymane</text><path d="M923,2821.8809 L985,2821.8809 L985,2829.1914 L975,2839.1914 L923,2839.1914 L923,2821.8809 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="613.6523" style="stroke:#000000;stroke-width:1.5;" width="2005" x="923" y="2821.8809"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17" x="938" y="2835.4492">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="248" x="1000" y="2834.5156">[Zar&#243;wno stalking jak i wywiad zako&#324;czone]</text><line style="stroke:#181818;stroke-width:1.0;" x1="1675" x2="1717" y1="2875.8125" y2="2875.8125"/><line style="stroke:#181818;stroke-width:1.0;" x1="1717" x2="1717" y1="2875.8125" y2="2888.8125"/><line style="stroke:#181818;stroke-width:1.0;" x1="1676" x2="1717" y1="2888.8125" y2="2888.8125"/><polygon fill="#181818" points="1686,2884.8125,1676,2888.8125,1686,2892.8125,1682,2888.8125" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="191" x="1682" y="2855.7598">GenerateGiftIdeasCommand</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="190" x="1682" y="2871.0703">{userProfile, keywords, chatId}</text><path d="M1885,2847.6914 L1885,2887.6914 L2238,2887.6914 L2238,2857.6914 L2228,2847.6914 L1885,2847.6914 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M2228,2847.6914 L2228,2857.6914 L2238,2857.6914 L2228,2847.6914 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="226" x="1891" y="2865.2598">AI generuje zapytania wyszukiwania</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="332" x="1891" y="2880.5703">dla wielu serwis&#243;w (z filtrowaniem disabled services)</text><line style="stroke:#181818;stroke-width:1.0;" x1="1675" x2="1717" y1="2933.4336" y2="2933.4336"/><line style="stroke:#181818;stroke-width:1.0;" x1="1717" x2="1717" y1="2933.4336" y2="2946.4336"/><line style="stroke:#181818;stroke-width:1.0;" x1="1676" x2="1717" y1="2946.4336" y2="2946.4336"/><polygon fill="#181818" points="1686,2942.4336,1676,2946.4336,1686,2950.4336,1682,2946.4336" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="147" x="1682" y="2913.3809">Generate eventId (ULID)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="157" x="1682" y="2928.6914">and calculate totalEvents</text><polygon fill="#181818" points="2656,2987.0547,2666,2991.0547,2656,2995.0547,2660,2991.0547" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1675" x2="2662" y1="2991.0547" y2="2991.0547"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="181" x="1682" y="2971.002">GiftContextInitializedEvent</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="322" x="1682" y="2986.3125">{userProfile, keywords, chatId, eventId, totalEvents}</text><line style="stroke:#181818;stroke-width:1.0;" x1="2678" x2="2720" y1="3035.6758" y2="3035.6758"/><line style="stroke:#181818;stroke-width:1.0;" x1="2720" x2="2720" y1="3035.6758" y2="3048.6758"/><line style="stroke:#181818;stroke-width:1.0;" x1="2679" x2="2720" y1="3048.6758" y2="3048.6758"/><polygon fill="#181818" points="2689,3044.6758,2679,3048.6758,2689,3052.6758,2685,3048.6758" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="203" x="2685" y="3015.623">InitializeGiftContextCommand</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="231" x="2685" y="3030.9336">(create/update session with context)</text><polygon fill="#181818" points="991,3073.9863,981,3077.9863,991,3081.9863,987,3077.9863" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="985" x2="2667" y1="3077.9863" y2="3077.9863"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="198" x="997" y="3073.2441">Create GiftSession with context</text><polygon fill="#181818" points="2656,3103.2969,2666,3107.2969,2656,3111.2969,2660,3107.2969" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="975" x2="2662" y1="3107.2969" y2="3107.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="98" x="982" y="3102.5547">Session created</text><path d="M1595,3122.2969 L1663,3122.2969 L1663,3129.6074 L1653,3139.6074 L1595,3139.6074 L1595,3122.2969 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="306.2363" style="stroke:#000000;stroke-width:1.5;" width="798" x="1595" y="3122.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23" x="1610" y="3135.8652">par</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="162" x="1678" y="3134.9316">[R&#243;wnoleg&#322;e &#379;&#261;dania FETCH]</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1595" x2="2393" y1="3140.6074" y2="3140.6074"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="30" x="1600" y="3151.2422">[OLX]</text><polygon fill="#181818" points="1991,3187.1836,2001,3191.1836,1991,3195.1836,1995,3191.1836" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1675" x2="1997" y1="3191.1836" y2="3191.1836"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="97" x="1682" y="3171.1309">FetchOlxEvent</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="222" x="1682" y="3186.4414">{query, chatId, eventId, totalEvents}</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1595" x2="2393" y1="3200.1836" y2="3200.1836"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="49" x="1600" y="3210.8184">[Allegro]</text><polygon fill="#181818" points="2053.5,3246.7598,2063.5,3250.7598,2053.5,3254.7598,2057.5,3250.7598" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1675" x2="2059.5" y1="3250.7598" y2="3250.7598"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="123" x="1682" y="3230.707">FetchAllegroEvent</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="222" x="1682" y="3246.0176">{query, chatId, eventId, totalEvents}</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1595" x2="2393" y1="3259.7598" y2="3259.7598"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="33" x="1600" y="3270.3945">[eBay]</text><polygon fill="#181818" points="2118,3306.3359,2128,3310.3359,2118,3314.3359,2122,3310.3359" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1675" x2="2124" y1="3310.3359" y2="3310.3359"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="107" x="1682" y="3290.2832">FetchEbayEvent</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="222" x="1682" y="3305.5938">{query, chatId, eventId, totalEvents}</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1595" x2="2393" y1="3319.3359" y2="3319.3359"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="53" x="1600" y="3329.9707">[Amazon]</text><polygon fill="#181818" points="2186,3365.9121,2196,3369.9121,2186,3373.9121,2190,3369.9121" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1675" x2="2192" y1="3369.9121" y2="3369.9121"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="130" x="1682" y="3349.8594">FetchAmazonEvent</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="222" x="1682" y="3365.1699">{query, chatId, eventId, totalEvents}</text><path d="M2213,3382.9121 L2213,3422.9121 L2383,3422.9121 L2383,3392.9121 L2373,3382.9121 L2213,3382.9121 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M2373,3382.9121 L2373,3392.9121 L2383,3392.9121 L2373,3382.9121 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="149" x="2219" y="3400.4805">Wiele zapyta&#324; na serwis</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="148" x="2219" y="3415.791">na podstawie decyzji AI</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="3274" x="0" y="3463.1885"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="3274" y1="3463.1885" y2="3463.1885"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="3274" y1="3466.1885" y2="3466.1885"/><rect fill="#EEEEEE" height="23.3105" style="stroke:#000000;stroke-width:2.0;" width="266" x="1504" y="3452.5332"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="248" x="1510" y="3469.1016">Zbieranie Produkt&#243;w i Rerankowanie</text><path d="M923,3492.8438 L991,3492.8438 L991,3500.1543 L981,3510.1543 L923,3510.1543 L923,3492.8438 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="907.1367" style="stroke:#000000;stroke-width:1.5;" width="2125" x="923" y="3492.8438"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23" x="938" y="3506.4121">par</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="213" x="1006" y="3505.4785">[Odpowiedzi od wszystkich serwis&#243;w]</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="923" x2="3048" y1="3511.1543" y2="3511.1543"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="30" x="928" y="3521.7891">[OLX]</text><polygon fill="#181818" points="2661,3557.7305,2671,3561.7305,2661,3565.7305,2665,3561.7305" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="2013" x2="2667" y1="3561.7305" y2="3561.7305"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="143" x="2020" y="3541.6777">ProductFetchedEvent</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="407" x="2020" y="3556.9883">{products[], chatId, provider: "olx", success, eventId, totalEvents}</text><line style="stroke:#181818;stroke-width:1.0;" x1="2683" x2="2725" y1="3606.3516" y2="3606.3516"/><line style="stroke:#181818;stroke-width:1.0;" x1="2725" x2="2725" y1="3606.3516" y2="3619.3516"/><line style="stroke:#181818;stroke-width:1.0;" x1="2684" x2="2725" y1="3619.3516" y2="3619.3516"/><polygon fill="#181818" points="2694,3615.3516,2684,3619.3516,2694,3623.3516,2690,3619.3516" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="163" x="2690" y="3586.2988">CreateSessionCommand</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="144" x="2690" y="3601.6094">(ensure session exists)</text><polygon fill="#181818" points="991,3644.6621,981,3648.6621,991,3652.6621,987,3648.6621" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="985" x2="2672" y1="3648.6621" y2="3648.6621"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="116" x="997" y="3643.9199">Upsert GiftSession</text><polygon fill="#181818" points="2661,3673.9727,2671,3677.9727,2661,3681.9727,2665,3677.9727" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="975" x2="2667" y1="3677.9727" y2="3677.9727"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="48" x="982" y="3673.2305">Session</text><line style="stroke:#181818;stroke-width:1.0;" x1="2683" x2="2725" y1="3722.5938" y2="3722.5938"/><line style="stroke:#181818;stroke-width:1.0;" x1="2725" x2="2725" y1="3722.5938" y2="3735.5938"/><line style="stroke:#181818;stroke-width:1.0;" x1="2684" x2="2725" y1="3735.5938" y2="3735.5938"/><polygon fill="#181818" points="2694,3731.5938,2684,3735.5938,2694,3739.5938,2690,3735.5938" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="223" x="2690" y="3702.541">AddProductsToSessionCommand</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="193" x="2690" y="3717.8516">(store products with metadata)</text><polygon fill="#181818" points="991,3760.9043,981,3764.9043,991,3768.9043,987,3764.9043" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="985" x2="2672" y1="3764.9043" y2="3764.9043"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="223" x="997" y="3760.1621">Save Products &amp; GiftSessionProduct</text><polygon fill="#181818" points="2661,3790.2148,2671,3794.2148,2661,3798.2148,2665,3794.2148" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="975" x2="2667" y1="3794.2148" y2="3794.2148"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="95" x="982" y="3789.4727">Products saved</text><line style="stroke:#181818;stroke-width:1.0;" x1="2683" x2="2725" y1="3838.8359" y2="3838.8359"/><line style="stroke:#181818;stroke-width:1.0;" x1="2725" x2="2725" y1="3838.8359" y2="3851.8359"/><line style="stroke:#181818;stroke-width:1.0;" x1="2684" x2="2725" y1="3851.8359" y2="3851.8359"/><polygon fill="#181818" points="2694,3847.8359,2684,3851.8359,2694,3855.8359,2690,3851.8359" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="265" x="2690" y="3818.7832">IncrementSessionCompletionCommand</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="182" x="2690" y="3834.0938">(increment completedEvents)</text><polygon fill="#181818" points="991,3877.1465,981,3881.1465,991,3885.1465,987,3881.1465" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="985" x2="2672" y1="3881.1465" y2="3881.1465"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="207" x="997" y="3876.4043">Update completedEvents counter</text><polygon fill="#181818" points="2656,3906.457,2666,3910.457,2656,3914.457,2660,3910.457" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="975" x2="2662" y1="3910.457" y2="3910.457"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="132" x="982" y="3905.7148">{completed: boolean}</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="923" x2="3048" y1="3919.457" y2="3919.457"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="49" x="928" y="3930.0918">[Allegro]</text><polygon fill="#181818" points="2661,3966.0332,2671,3970.0332,2661,3974.0332,2665,3970.0332" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="2075.5" x2="2667" y1="3970.0332" y2="3970.0332"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="143" x="2082.5" y="3949.9805">ProductFetchedEvent</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="430" x="2082.5" y="3965.291">{products[], chatId, provider: "allegro", success, eventId, totalEvents}</text><line style="stroke:#181818;stroke-width:1.0;" x1="2683" x2="2725" y1="3999.3438" y2="3999.3438"/><line style="stroke:#181818;stroke-width:1.0;" x1="2725" x2="2725" y1="3999.3438" y2="4012.3438"/><line style="stroke:#181818;stroke-width:1.0;" x1="2684" x2="2725" y1="4012.3438" y2="4012.3438"/><polygon fill="#181818" points="2694,4008.3438,2684,4012.3438,2694,4016.3438,2690,4012.3438" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="346" x="2690" y="3994.6016">CreateSession &#8594; AddProducts &#8594; IncrementCompletion</text><polygon fill="#181818" points="991,4037.6543,981,4041.6543,991,4045.6543,987,4041.6543" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="985" x2="2672" y1="4041.6543" y2="4041.6543"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="88" x="997" y="4036.9121">DB operations</text><polygon fill="#181818" points="2656,4066.9648,2666,4070.9648,2656,4074.9648,2660,4070.9648" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="975" x2="2662" y1="4070.9648" y2="4070.9648"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="132" x="982" y="4066.2227">{completed: boolean}</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="923" x2="3048" y1="4079.9648" y2="4079.9648"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="33" x="928" y="4090.5996">[eBay]</text><polygon fill="#181818" points="2661,4126.541,2671,4130.541,2661,4134.541,2665,4130.541" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="2140" x2="2667" y1="4130.541" y2="4130.541"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="143" x="2147" y="4110.4883">ProductFetchedEvent</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="416" x="2147" y="4125.7988">{products[], chatId, provider: "ebay", success, eventId, totalEvents}</text><line style="stroke:#181818;stroke-width:1.0;" x1="2683" x2="2725" y1="4159.8516" y2="4159.8516"/><line style="stroke:#181818;stroke-width:1.0;" x1="2725" x2="2725" y1="4159.8516" y2="4172.8516"/><line style="stroke:#181818;stroke-width:1.0;" x1="2684" x2="2725" y1="4172.8516" y2="4172.8516"/><polygon fill="#181818" points="2694,4168.8516,2684,4172.8516,2694,4176.8516,2690,4172.8516" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="346" x="2690" y="4155.1094">CreateSession &#8594; AddProducts &#8594; IncrementCompletion</text><polygon fill="#181818" points="991,4198.1621,981,4202.1621,991,4206.1621,987,4202.1621" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="985" x2="2672" y1="4202.1621" y2="4202.1621"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="88" x="997" y="4197.4199">DB operations</text><polygon fill="#181818" points="2656,4227.4727,2666,4231.4727,2656,4235.4727,2660,4231.4727" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="975" x2="2662" y1="4231.4727" y2="4231.4727"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="132" x="982" y="4226.7305">{completed: boolean}</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="923" x2="3048" y1="4240.4727" y2="4240.4727"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="53" x="928" y="4251.1074">[Amazon]</text><polygon fill="#181818" points="2661,4287.0488,2671,4291.0488,2661,4295.0488,2665,4291.0488" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="2208" x2="2667" y1="4291.0488" y2="4291.0488"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="143" x="2215" y="4270.9961">ProductFetchedEvent</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="436" x="2215" y="4286.3066">{products[], chatId, provider: "amazon", success, eventId, totalEvents}</text><line style="stroke:#181818;stroke-width:1.0;" x1="2683" x2="2725" y1="4320.3594" y2="4320.3594"/><line style="stroke:#181818;stroke-width:1.0;" x1="2725" x2="2725" y1="4320.3594" y2="4333.3594"/><line style="stroke:#181818;stroke-width:1.0;" x1="2684" x2="2725" y1="4333.3594" y2="4333.3594"/><polygon fill="#181818" points="2694,4329.3594,2684,4333.3594,2694,4337.3594,2690,4333.3594" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="346" x="2690" y="4315.6172">CreateSession &#8594; AddProducts &#8594; IncrementCompletion</text><polygon fill="#181818" points="991,4358.6699,981,4362.6699,991,4366.6699,987,4362.6699" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="985" x2="2672" y1="4362.6699" y2="4362.6699"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="88" x="997" y="4357.9277">DB operations</text><polygon fill="#181818" points="2656,4387.9805,2666,4391.9805,2656,4395.9805,2660,4391.9805" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="975" x2="2662" y1="4391.9805" y2="4391.9805"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="132" x="982" y="4387.2383">{completed: boolean}</text><path d="M2385,4411.9805 L2385,4482.9805 L2961,4482.9805 L2961,4421.9805 L2951,4411.9805 L2385,4411.9805 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M2951,4411.9805 L2951,4421.9805 L2961,4421.9805 L2951,4411.9805 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="397" x="2391" y="4429.5488">Reranking Service &#347;ledzi completedEvents dla ka&#380;dego eventId.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="555" x="2391" y="4444.8594">Gdy completedEvents &gt;= totalEvents, automatycznie wywo&#322;uje EmitGiftReadyCommand.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="521" x="2391" y="4460.1699">Dodatkowy scheduler (@Cron EVERY_30_SECONDS) oznacza sesje jako TIMED_OUT</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="487" x="2391" y="4475.4805">je&#347;li nie otrzyma&#322;y wszystkich event&#243;w w EVENT_TIMEOUT_MS (default 120s).</text><path d="M9,4495.2227 L71,4495.2227 L71,4502.5332 L61,4512.5332 L9,4512.5332 L9,4495.2227 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="544.9004" style="stroke:#000000;stroke-width:1.5;" width="3255" x="9" y="4495.2227"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17" x="24" y="4508.791">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="359" x="86" y="4507.8574">[Wszystkie produkty zebrane (completedEvents &gt;= totalEvents)]</text><path d="M2508,4517.5332 L2508,4542.5332 L2838,4542.5332 L2838,4527.5332 L2828,4517.5332 L2508,4517.5332 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M2828,4517.5332 L2828,4527.5332 L2838,4527.5332 L2828,4517.5332 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="309" x="2514" y="4535.1016">ProductFetchedHandler wykrywa completed=true</text><line style="stroke:#181818;stroke-width:1.0;" x1="2678" x2="2720" y1="4584.4648" y2="4584.4648"/><line style="stroke:#181818;stroke-width:1.0;" x1="2720" x2="2720" y1="4584.4648" y2="4597.4648"/><line style="stroke:#181818;stroke-width:1.0;" x1="2679" x2="2720" y1="4597.4648" y2="4597.4648"/><polygon fill="#181818" points="2689,4593.4648,2679,4597.4648,2689,4601.4648,2685,4597.4648" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="165" x="2685" y="4564.4121">EmitGiftReadyCommand</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="54" x="2685" y="4579.7227">{eventId}</text><polygon fill="#181818" points="991,4622.7754,981,4626.7754,991,4630.7754,987,4626.7754" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="985" x2="2667" y1="4626.7754" y2="4626.7754"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="295" x="997" y="4622.0332">Query GiftSession, GiftSessionProduct, Product</text><polygon fill="#181818" points="2656,4652.0859,2666,4656.0859,2656,4660.0859,2660,4656.0859" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="975" x2="2662" y1="4656.0859" y2="4656.0859"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="158" x="982" y="4651.3438">Session with all products</text><line style="stroke:#181818;stroke-width:1.0;" x1="2678" x2="2720" y1="4700.707" y2="4700.707"/><line style="stroke:#181818;stroke-width:1.0;" x1="2720" x2="2720" y1="4700.707" y2="4713.707"/><line style="stroke:#181818;stroke-width:1.0;" x1="2679" x2="2720" y1="4713.707" y2="4713.707"/><polygon fill="#181818" points="2689,4709.707,2679,4713.707,2689,4717.707,2685,4713.707" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="90" x="2685" y="4680.6543">rankProducts</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="93" x="2779" y="4680.6543">(AI via OpenAI)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="223" x="2685" y="4695.9648">(score and reason for each product)</text><path d="M2920,4672.5859 L2920,4712.5859 L3244,4712.5859 L3244,4682.5859 L3234,4672.5859 L2920,4672.5859 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M3234,4672.5859 L3234,4682.5859 L3244,4682.5859 L3234,4672.5859 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="206" x="2926" y="4690.1543">AI-SDK generateObject z OpenAI</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="303" x="2926" y="4705.4648">okre&#347;la rating i reasoning dla ka&#380;dego produktu</text><polygon fill="#181818" points="991,4739.0176,981,4743.0176,991,4747.0176,987,4743.0176" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="985" x2="2667" y1="4743.0176" y2="4743.0176"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="254" x="997" y="4738.2754">Update Products with rating &amp; reasoning</text><polygon fill="#181818" points="2656,4768.3281,2666,4772.3281,2656,4776.3281,2660,4772.3281" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="975" x2="2662" y1="4772.3281" y2="4772.3281"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="110" x="982" y="4767.5859">Products updated</text><polygon fill="#181818" points="590.5,4815.9492,580.5,4819.9492,590.5,4823.9492,586.5,4819.9492" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="584.5" x2="2672" y1="4819.9492" y2="4819.9492"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="104" x="596.5" y="4799.8965">GiftReadyEvent</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="161" x="596.5" y="4815.207">{chatId, rankedProducts[]}</text><path d="M2683,4785.3281 L2683,4825.3281 L2906,4825.3281 L2906,4795.3281 L2896,4785.3281 L2683,4785.3281 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M2896,4785.3281 L2896,4795.3281 L2906,4795.3281 L2896,4785.3281 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="139" x="2689" y="4802.8965">RERANK emituje event</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="202" x="2689" y="4818.207">z ju&#380; zrankowanymi produktami</text><line style="stroke:#181818;stroke-width:1.0;" x1="579.5" x2="621.5" y1="4867.5703" y2="4867.5703"/><line style="stroke:#181818;stroke-width:1.0;" x1="621.5" x2="621.5" y1="4867.5703" y2="4880.5703"/><line style="stroke:#181818;stroke-width:1.0;" x1="580.5" x2="621.5" y1="4880.5703" y2="4880.5703"/><polygon fill="#181818" points="590.5,4876.5703,580.5,4880.5703,590.5,4884.5703,586.5,4880.5703" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="153" x="586.5" y="4847.5176">SaveListingsCommand</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="110" x="586.5" y="4862.8281">{chatId, listings[]}</text><polygon fill="#181818" points="958,4905.8809,968,4909.8809,958,4913.8809,962,4909.8809" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="579.5" x2="964" y1="4909.8809" y2="4909.8809"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="214" x="586.5" y="4905.1387">Save listings to REST API database</text><polygon fill="#181818" points="590.5,4935.1914,580.5,4939.1914,590.5,4943.1914,586.5,4939.1914" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="584.5" x2="974" y1="4939.1914" y2="4939.1914"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="143" x="596.5" y="4934.4492">Saved listings with IDs</text><line style="stroke:#181818;stroke-width:1.0;" x1="579.5" x2="621.5" y1="4968.502" y2="4968.502"/><line style="stroke:#181818;stroke-width:1.0;" x1="621.5" x2="621.5" y1="4968.502" y2="4981.502"/><line style="stroke:#181818;stroke-width:1.0;" x1="580.5" x2="621.5" y1="4981.502" y2="4981.502"/><polygon fill="#181818" points="590.5,4977.502,580.5,4981.502,590.5,4985.502,586.5,4981.502" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="162" x="586.5" y="4963.7598">NotifyUserSseCommand</text><polygon fill="#181818" points="303.5,5025.123,293.5,5029.123,303.5,5033.123,299.5,5029.123" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="297.5" x2="563.5" y1="5029.123" y2="5029.123"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="93" x="309.5" y="5009.0703">SSE: gift-ready</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="171" x="309.5" y="5024.3809">{listings with database IDs}</text><path d="M19,4994.502 L19,5034.502 L287,5034.502 L287,5004.502 L277,4994.502 L19,4994.502 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M277,4994.502 L277,5004.502 L287,5004.502 L277,4994.502 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="210" x="25" y="5012.0703">Produkty gotowe do wy&#347;wietlenia</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="247" x="25" y="5027.3809">u&#380;ytkownik mo&#380;e doda&#263; do ulubionych</text><!--SRC=[vLhDSjl84RxpARgKAfUew6UpkQbAMw4aMkPQCcLHMcUzsb8DWI4r8eYXWO5WqAMBQvEzvvRoO-mjyMtD5ycJf7i60mm8K5PYxMaFBeh4JF_trp-m4YhWqEd1QSHZ7YfuAaAVHx059qo4y3IGAQmVoEaiu8f3AjGruBSf2_qOda3t5g_4xLQBUKf6S17ZJHR3HMl68YKyCMD8SUsiEpY7pcblZPxHb-hZ8od7A4E_awXhVUIetpywxhPyfjYGnHpMJcMinX4Vl3pMpm_tgmGEhfc20OzkXSVrWODddIKU0yM2YGZ7bME3yyxnyoLPn4X1p-Vqr3bvr7jwtXhAjx3sb2ll6aw45ydO78ZNu0_7OdojzeE4jm0gzFh7VzK4ddRF3vvTuRVb0vqWuED8EeSwnyVTexF-ya6-ppBdL7U_ytsDrfJDPUYIEkcyxhzeyT0757x9AJnYOSqaPzsppeldhTRU7g0xP9JDcNV385bypDH4fg6OCDZRQrt0rZVQaxjmr3s77OQksnbhF-uaKK3X86uP1epsjlP_SM5ZuuY7o5nnutZjzuieU9dmADlOA4wRA406N9dOW8kpu_mfFhxOXNV8QXVMhfMQnRixEyppP8BXk6q4sVRaT6TxUtljheN-h0WKIlmhu2Er2nUbPZ2BvdmYU2JJv8PVXhu4DpHRHcihbckUD3zOwfs7iFcmyfvnNqJSKp27YVJv59YbaTs4sTGLCx_l6lgqFrYojCU2OCYyoMNupaDwTvyn-tSi47vXzdCvuM6UoWrMVvLD1GiP2Pe0VYewVfz-XiixT0AFOqry4o8-GbIvph_nAHF19XARyhi6NQq4X_lebHacbuA4y6JTkRS9ur9un9s21aB2uRuZXqOYn2QXCfSL7gjQnOOYVFlgFDVHZR01Lri7Kc9Gx8BHx4eVWdKAkduOP6qqFec9gWk_gkEzSKVyvcmcOXPc63-M77YQssLuY93twPypm23qhYCP2Xbc23oOoZCfGlNhBwbEKiGrj5FCuni1wqwM8kr0ZcMArDjB2MlY2FsYaFrEd0FZLiJV9FWRnHB2QGzrYQKdM41P5s-2z3mMen1tb-4VjV16qC-4tBUfejGvIbY4GOP59SKS7o68KDPeIxBQ7QtIQIJ9sYXOFKGfG0uYJan9LDAU95iT3Be-D0O3GI9MlZbNAOlcB1Ie1vesb0ZAY_U4vfQfhXMvUDfWdP05sPoV6RDnNvV2ZGt7VcIuEoHHC3Jr1ipdVKGBdI_3TKp2GCmPWfCSYK1OhqmHIrYxnOFObP8A7z4ZZRKTUw4YTETfNRp2eww8kdA2_d3fOHxqy-EER8saxDKLNa9Cy6JakppH3m2vmmp30zUj05MVOGheq2zKWq3A6GMv_ZoKirz_cGXgQSYTSvzxcOzuZXanaOkVl7dswMS8aY4zJHVlsUA39r9wwbrJkk0LIcVMO0IB5I_9uLLBh2EtWf74zDV9YvWEiqmXqQHTq7CYdTIqn3hnf2c6tkIFxnmds-ilf1AZZ91k49SXunma5mpOBSTWYMCsvfXnO9kgLGumn4_o2tdIBBkWP44OES1oGV8EfThAEU69rOY33hJd74tpN-8cJHy28_LR0sH4ricLkTT2kjByTcPwiCjMs1CZZ6DyOl_DV3cL5BELdgoz0WE8KoUCqLnDmUMQl1xiHSRdZLbnSJdBJKjiCG16aPmwoNjFcbi6sjhDUSu2XQq8gLtaBnP2cCbfjlWGOBOsYEu5s9eNw83negGCg5Topb93RurK7BLZJeEf3Fho2bRgeG3qXqloOaPDLa4KOLWbiOiLkkpFSv86RR3OpYAM-ej_0G8KsAACtOwIQTPsk9Zko2zWLHGe66j6gonkf3CtVNsr8LojTLo0AenInkwoUUw-DDAt2YssFCiEZphjKZq6DYz3Fi4H1X33VOtSJ5T3F3g9CapXLVZU436ZW8rx8PkXIsQHG7FaLRqvTbphDDsgHm-MmVZ_nF0bCpdSRCVs04E5R4ozl1zK9pcJOauGwEfFjVLrVfrJFRJDIK8rjkXTRBZRfmt9C-5PYhKUkqThYCAx7LNfZardr9n9bi7AH2hPL98eDPQmARGgWOfSo_EdeOjio9sbDX9DzboY35ceIvBk54nCqbu5pKWDEvbFUqhUOh4nH8_y3EIG0IUZuPygccUe7pV8zvf5kXijXRnX4n1MjTB9l067YYbRZ9JUQBYT6w7EgS6qJLZsqvqDgOZM6hlKIes9cEcYJ4U3GsyMpvE9q5hYi8onbGeU90ZzKIfYqdTz3iX06KlWkElZj3CCq8HsSqB0LfEy6CcqJNe-h5ySzmvnpaBP0LFHIm9wgYJQnEoV719cVw7LHxKF9EBAMqnIeGHrqMvmtck1JSjyq-LJGVzyKmBv7rNc9KT733TqFTqPxoGc46rlhDThdZdThf1skccYE6YuiBfLCLBPEuQrNuT_iqwg342m-FUdl_dQtNgZX4Sqnff5biFGtM-LtYX-9PleDg4Vl2rTy8OQYy-RN7FCzsGDvFDzMS4YF_a_iwbfKoxYj0IqW6jWJukuWdTtoB8lPvplzepUUgVNfBRUxPLQwtEFeBHP6TAJ4W90ZfQuli9Kjs2m-8aMH2RjgTPWT-OZO24Qw9beVaF36Ec3rOR-kQiVQg5qmHaAsaVY5Sn9Fvbel1HWbfJvN8RmIV7PzsSIQVjp0TA7D9vdiPe8x40Bu6avCLg4O3L1DHTFQTEvg30plyS__5ZQ3d-x5JwjUDPay7ODoqoYLq5V2X8cd_EqTC61Xt4IbQZ0tufOnNKyo9Ta3Xuy408Q1vMwV1tVpyqKdyi6CMCbKKfhCOD5KwuOTVDrQVMOPUd14rVi_DVFILzSZf6K_q0bUY7YtHGTKof07SYIAiAUAZiK-sgZRdNJErJFWLuzy-XpEhmhxkt245jBpdHRkAn9PN6eGsW912i8zIYXpV8N4OyKtfNWXl_y_H_WX9F-NdYcT4dDs6WzEQDk01_6lwrjStWl4VXHhCgn8FnkJLhKBhTsF4wmcZTTlqV3LWjesNVLVhJjI-s1RY_gnqtXToQKqcBBhmfXyI7G1NWP1MaAcB35Hv-FfNN9DhNdVbOx-ysUwwjD_J9iobJcpQdOuuWZ5-zfukXEXQ9YSSQPd-MWJJGF9G8nzWOPn1GxIK3lYlvo4A4Bkzzrpxw_-lDNLuFkGV_5uQ0DSewJsPpfDoMSfYW9vxsJxk5L_u9sE3SSDH9wOPoFO8ltcTjRQ5se9qc9-8lpAxgDTwzE1h3kyn5BS5pxqzTVnUrj_RgLh9Xlht8YUQMSu9GtvqCqA8Vr-qtIjcEOuusY2kOPymoDGOgdjFH8MMdaFHKb_C6jI9EDTHxcFhohHRjU2hf5VBEXec_20qjxPPx1IbHq5G-iyXIVDc4tDe3MyRSui_HdFEpqsjIhUDIhq0HfTZ4maX4WuMlBgLsRURS6Xy_Dt8ki-yCRy-BMaBmCvIIYc6502O-P8NB2z7Sb2tAl9wiQYTDA_vHJUr9IUt1NP6R9p_L5-Hjuw-k6NHMQaXVezyEFoyk0d1Z7YA7ir05o6SxX9bbyXBbjrxEfi9gpgMX4iafi3iwR5lZOvnrZxujMY9jUEmNvCoDaRQTl7zC-t_uNb0Skzkc-NnBGhkaTne-vuH-Z2xOYyW5gLELK_CSNP7ctR3jjAMVXTsfHHI-wEBqmJhF51voGLC3rQiPzBJoLYuzqncUVVgQZIP0CpQjbNLd-2m00]--></g></svg>